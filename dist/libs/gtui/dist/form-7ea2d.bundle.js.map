{"version":3,"sources":["webpack:///./src/form/core/base/api.js","webpack:///./src/form/core/base/form-data.js","webpack:///./src/form/core/base/form-engine.js","webpack:///./src/form/core/base/form-webgis.js","webpack:///./src/form/core/base/workflow.js","webpack:///./src/form/core/config.js","webpack:///./src/form/core/controllers/file-controller.js","webpack:///./src/form/core/controllers/form-controller.js","webpack:///./src/form/core/controllers/handover-controller.js","webpack:///./src/form/core/directives/tab-components.js","webpack:///./src/form/core/filters/workflow-filter.js","webpack:///./src/form/core/services/file-service.js","webpack:///./src/form/core/services/form-core-service.js","webpack:///./src/form/core/services/handover-service.js","webpack:///./src/form/form.js","webpack:///./src/form/office/controllers/agency-ctrl.js","webpack:///./src/form/office/controllers/complete-ctrl.js","webpack:///./src/form/office/controllers/draft-ctrl.js","webpack:///./src/form/office/controllers/protocol-ctrl.js","webpack:///./src/form/office/services/agency-services.js","webpack:///./src/form/office/services/draft-services.js"],"names":["GM","Form","CommonOper","showSuccessMsg","msg","Infomation","show","type","placement","showFailureMsg","getUUID","i","chars","split","uuid","Math","random","join","showDialog","url","title","size","callback","w","h","option","iframe","indexOf","Date","backdrop","arrSize","parseInt","e","$","zui","ModalTrigger","hidden","mapFieldArray","array","field","result","length","_typeof","push","syncAjaxGet","successCallback","errorCallback","param","this","_syncAjax","syncAjaxPost","opt","async","success","res","error","data","ajax","getCnFormatMoney","n","fraction","digit","unit","head","abs","s","floor","pow","replace","p","j","setObjectAttrVal","obj","exp","index","val","arr","cloneObject","copy","setTime","getTime","Array","len","Object","attr","hasOwnProperty","Error","showMapDialog","window","frames","pMap","dialog","autoOpen","resizeable","draggable","effect","duration","hide","modal","width","height","zIndex","position","my","at","of","pLocation","parent","location","strPathName","pathname","toLowerCase","substr","FilePath","getDirName","href","origin","__webpack_require__","FormData","init","formid","_initScopeVar","_bindEvents","formScope","gridQueryParams","queryType","undefined","queryValue","parameters","formDataSourceNames","_initOptions","_datas","globe","saveKeys","_this","getData","urlParams","did","_getDraftData","_getData","save","failureCallback","_saveData","saveAndHandOver","saveDraft","_saveDraft","duuid","getSingleDataGrid","ds","_getSingleDataGrid","dataGridSelect","item","_dataGridSelect","grid","appScope","closeThisDialog","saveDialog","_saveDialog","closeFormDialog","dgA","_dataGridOperA","dgB","_dataGridOperB","getRedisString","key","_getRedisString","removeRedisString","_removeRedisString","redisString","_redisString","initDataGridOptions","_initDataGridOptions","initDataGridHeaders","fieldString","operString","_getGridOption","scope","dgds","sDataItems","sTemplateItems","FORM_REST_URL","workflow","getDataGridDataSourceNames","ele","event","srcElement","linkText","text","templates","element","_showDataGridDlg","service","method","tip","Alert","showCancelButton","_invokeDataGridREST","u","arrDataItems","entity","showFormDialog","RESTURL","dg","dataItems","toUpperCase","restful","post","get","then","message","paras","para","searchType","searchValue","angular","ywh","up","formids","dataSourceName","urlParameters","JSON","stringify","servers","getSingleDataGridServer","_bindDataGrid","hd","templateItems","gridOptionName","gridOptions","tableGrid","gmTable","heads","arrTemps","name","click","gridParas","displayName","enableColumnMenu","cellTooltip","strCellTemplate","getCellTemplate","cellTemplate","columnDefs","updateSize","pstyle","isDataComplex","globalTreeData","dgData","page","records","headList","process","getDraftInfo","response","parse","id","userId","top","userInfo","loginName","appId","AppInfo","processDefId","processName","processKey","ctrl","bizName","saveDraftBaseInfo","_getSavingData","saveDraftInfo","r","keepOldData","params","formIds","getDataServer","console","log","treeKey","isEmptyObject","totalItems","isStrNullOrEmpty","sc_spxx","SHRYXM","realName","SHJSSJ","pCurDate","strFormatDate","getFormatData","dialogParameter","keys","saveDataServer","autoHandOver","savingFormIds","handOver","validationObject","ngDialog","filter","timeout","serviceAppKey","dataLoaded","formValid","saveLayerName","getHandOverVarServer","updateBizFlowInfoServer","FormEngine","_functions","beforeGetData","afterGetData","pageLoaded","settings","layoutUrl","forms","tabs","prints","buttons","topUrl","showBottom","loadWebGIS","draftInfo","hasInitCalcs","v","f","d","g","t","LayoutOper","getURLParams","_getFormServiceUrl","form","_loadPage","_doAfterLoadPage","getAppServerUrl","appKey","substring","lastIndexOf","each","tabId","newTabId","tabDiv","next","find","_watchCalcExp","ii","CONFIG_JSON","app","value","ex","FORM_SERVER","invokePlugin","validScope","_clickEvent","treeConfig","activeNode","treeEvent","node","_treeConfig","print","code","_print","taskInfo","bizKey","_showFormDialog","Dialog","close","formLoaded","_formLoaded","isCbChecked","a","b","_isCheckBoxChecked","cbCheck","_cbCheck","$watch","sUserNgModel","vCur","eval","dt","vYear","getFullYear","vMonth","getMonth","vDate","getDate","vSysDate","arrCalcOpers","sCalcExp","isCn","sModel","sDigits","arrEleBinds","curEleBind","sNewCalcExp","containsObj","curVal","curSign","sLastExp","isString","uu","vLastOper","isNaN","parseFloat","toFixed","formCommonOper","vCalResult","ee","bChecked","target","prop","isArrayContainsEle","removeItemFromArray","arrDataGridDataSources","arrVals","dialogPara","initedDlgFormIds","formInfos","getFormInfoById","dir","open","template","appid","results","printResultUrl","treeFormKey","pNode","sxh","subtype","names","_doClick","validateForm","allForms","splice","_pushFormId","addUniqueEle","_pushSavingFormId","_getPages","pages","_retrievePages","kk","children","getParamsValue","_getLayoutUrl","STATIC_RESOURCES_PATH","sIndexJsonUrl","Workflow","taskKey","style","webgis","formWebgis","graphStat","savePlots","payload","asDraft","saveData","strParams","graph","saveGraphStatics","polygon","savePolygon","layerName","status","strObjectName","GIS","ExternalApi","saveJXPolygons","getJhObjectIDName","statistics","vObjectId","feature","objectid","polygonNum","area","strGeom","saveGraphParam","draftBizKey","isClaimed","caseTitle","startTime","forbid","boxName","box","startProcessAndHandOver","startProcess","notTurnToFirst","ctrlCaseTitle","draftKey","ctrlExtraBizDatas","extraBizData","y","_startProcess","currentTaskId","saveBizFlowInfo","str","claimOrUnclaim","alertMessage","myUrl","erroeMessage","claimTask","unclaimTask","showWfGraph","blankTitle","htmlContent","getHighLightTask","_isTaskClaimed","_initBizFlowDetails","pendingPageLz","currentPage","_getLzData","lzGridOptions","showLzDialog","className","viewMap","strDyh","zrzyjbxx","ZRZYDJDYH","strUrl","addURLParam","ONEMAP_PATH","FullModal","closeDialog","getTaskTrackPage","dbData","forEach","completeTime","total","encodeURIComponent","workflowCore","FORM_SERVER_URLS","ACTIVITI_SERVER","saveDataAsDraft","getDraftData","getDrafts","getRegionTree","getBizInfo","getHandOverTarget","getProcessInstanceByBizKey","module","controller","$scope","$location","$fileService","$captureService","$validation","formBase","getUrlParamters","absUrl","strYwh","strStepName","blbz","fileTreeConfig","activeFolder","pActiveNode","uploadFile","unbind","change","formData","append","files","filename","ajaxRequest","file","cache","processData","contentType","pData","$apply","fileTree","formatTreeData","editFolder","copyFocusItem","deleteFolder","removeFolder","$log","deleteFile","removeFile","fileId","TreeOper","removeNode","editFile","viewFile","getFileType","imgUrl","saveFile","addFolder","saveFolder","dislogScope","folderForm","focusItem","captureImg","showCapture","$http","$gmRestful","token","pRestful","FrameManager","prepareData","setUrl","view","subUrl","formIdList","loadPage","getInfoUrl","processDef","processDefinitionId","document","write","closeDlg","$timeout","$formCoreService","$rootScope","$filter","$gmTable","$on","angularEvent","src","pParams","targetScope","readonly","$handOverService","directive","restrict","link","transclution","$sce","trustAsHtml","factory","getDraftAttaches","subType","getAttachesFromRedis","queryTree","seqNo","zlx","folderData","strId","strFileId","fileData","treeNodes","bCliam","arrayNodes","getAllNodes","_isFileEnable","nodeType","jj","_isFileNecessary","initTree","treeScope","sSubType","sSeqNo","processid","pTreeNode","BaseCapture","nWindowHeight","nHeight","nWidth","DotNetCapture","tableData","options","camera","resolution","_innitLayout","_initEvent","_modifyLayout","device_camera","CameraStop","Init","strCameras","getDeviceNames","arrayCameras","CameraConn","selectCamera","String","arrayResolutions","_getResolutions","selectResolution","remove","chooseCamera","nIndex","nSelectIndex","Number","chooseResolution","nResolutionIndex","updateCamera","updateDevice","shoot","strBase64","MakeCapture","uploadStatus","reshoot","viewImg","pItem","imgBase64","deleteItem","pUploadItem","pResult","uploadBase64","on","destory","bind","strResolutions","getVideoResolutions","capture","getVertion","validation","dlg","nextNodes","handOverConfig","checkNode","_getHandOverChecks","handOverVar","_getHandOverTarget","isOnlyLastNode","userArray","subArray","childrens","groups","users","chooseRole","checkItem","_checkItem","modelHandOver","_doHandOver","unselectUser","_unselect","selectedUsers","flag","_selectUser","user","bFlag","_uncheckTreeUser","_uncheckUserOnTree","cur","nodeName","check","variables","arrayIds","targets","_handOver","_saveBizFlowInfo","sMsg","strBoxName","handOverParam","goPendingPage","_getBizInfo","var","$agencyService","queryData","queryPendingData","agencyForm","userData","pendingPage","erron","orderField","current","tagData","tags","checkTag","xmjd","config","submitterName","refer","delet","goProcess","processUrl","getHtmlPath","goPending","activeNaviFromPath","queryCompleteData","completeForm","operate","icon","targetTaskKey","receiverName","$draftService","queryDraftData","draftForm","cgData","regions","areas","treearea","attvalue","xmysubh","xmmc","xzqmc","zgm","ztz","xmlx","$protocolService","permissions","queryDraft","draftData","draftProcess","goToDraft","queryExtraBizFields","queryStartData","start","getQuery","query","processDate","timeStamp","date","getProcessCatalogs","wf","edit","editProcessCatalog","delete","deleteProcessCatalog"],"mappings":"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","file":"form-7ea2d.bundle.js","sourcesContent":["//定义表单通用API\r\n//表单对象命名空间\r\nGM.Form = {};\r\n\r\n/**\r\n * @description 流程表单通用接口类\r\n * @class GM.Form.CommonOper\r\n */\r\nGM.Form.CommonOper = {\r\n    /**\r\n     * 展示成功信息\r\n     * @param {String} msg 成功信息\r\n     */\r\n    showSuccessMsg: function (msg) {\r\n        GM.Infomation.show(msg, {\r\n            type: 'success',\r\n            placement: 'center'\r\n        });\r\n    },\r\n    /**\r\n     * 展示失败信息\r\n     * @param {String} msg 失败信息\r\n     */\r\n    showFailureMsg: function (msg) {\r\n        GM.Infomation.show(msg, {\r\n            type: 'danger',\r\n            placement: 'center'\r\n        });\r\n    },\r\n    getUUID: function () {\r\n        var chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split('');\r\n        var uuid = [], i;\r\n        var radix = 16 || chars.length;\r\n\r\n        if (32) {\r\n            // Compact form\r\n            for (i = 0; i < 32; i++) {\r\n                uuid[i] = chars[0 | Math.random() * radix];\r\n            }\r\n        } else {\r\n            // rfc4122, version 4 form\r\n            var r;\r\n\r\n            // rfc4122 requires these characters\r\n            uuid[8] = uuid[13] = uuid[18] = uuid[23] = '-';\r\n            uuid[14] = '4';\r\n\r\n            // Fill in random data. At i==19 set the high bits of clock sequence\r\n            // as\r\n            // per rfc4122, sec. 4.1.5\r\n            for (i = 0; i < 36; i++) {\r\n                if (!uuid[i]) {\r\n                    r = 0 | Math.random() * radix;\r\n                    uuid[i] = chars[(i == 19) ? (r & 0x3) | 0x8 : r];\r\n                }\r\n            }\r\n        }\r\n\r\n        return uuid.join('');\r\n    },\r\n    /**\r\n     * 展示一个对话框\r\n     * @param url 对话框内容URL\r\n     * @param size 对话框尺寸类型：lg、sm、fullscreen、''默认大小\r\n     * @param reload 关闭对话框时的回调函数\r\n     */\r\n    showDialog: function (url, title, size, callback) {\r\n        var w, h;\r\n\r\n        var option = {\r\n            iframe: url + ((url.indexOf('?') > -1 ? '&' : '?') + 'version=' + new Date()),\r\n            title: title,\r\n            backdrop: 'static'\r\n        };\r\n\r\n        if (size && size.indexOf(',') > -1) {\r\n            var arrSize = size.split(',');\r\n\r\n            try {\r\n                w = parseInt(arrSize[0]) + 'px';\r\n            } catch (e) {\r\n                w = '1000px';\r\n            }\r\n\r\n            try {\r\n                h = parseInt(arrSize[1]) + 'px';\r\n            } catch (e) {\r\n                h = '800px';\r\n            }\r\n\r\n            option['width'] = w;\r\n            option['height'] = h;\r\n        } else {\r\n            option['size'] = size;\r\n        }\r\n\r\n        var myModalTrigger = new $.zui.ModalTrigger(option);\r\n\r\n        myModalTrigger.show({\r\n            hidden: function () {\r\n                if (callback) {\r\n                    callback();\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /**\r\n     * 取数组元素中对应属性的值组成新的数组\r\n     * @param array\r\n     * @param field\r\n     * @returns {Array}\r\n     */\r\n    mapFieldArray: function (array, field) {\r\n        var result = [];\r\n\r\n        for (var i = 0; i < array.length; i++) {\r\n            if (typeof (array[i]) === 'object' && array[i][field]) {\r\n                result.push(array[i][field]);\r\n            }\r\n        }\r\n\r\n        return result;\r\n    },\r\n    /**\r\n     * 同步执行GET\r\n     *\r\n     * @param {String} url                  url地址\r\n     * @param {Function} successCallback    成功时的回调函数\r\n     * @param {Function} errorCallback      失败时的回调函数\r\n     * @param {Object} param                传入数据\r\n     */\r\n    syncAjaxGet: function (url, successCallback, errorCallback, param) {\r\n        this._syncAjax('GET', url, successCallback, errorCallback, param);\r\n    },\r\n    /**\r\n     * 同步执行POST\r\n     *\r\n     * @param {String} url                  url地址\r\n     * @param {Function} successCallback    成功时的回调函数\r\n     * @param {Function} errorCallback      失败时的回调函数\r\n     * @param {Object} param                传入数据\r\n     */\r\n    syncAjaxPost: function (url, successCallback, errorCallback, param) {\r\n        this._syncAjax('POST', url, successCallback, errorCallback, param);\r\n    },\r\n    _syncAjax: function (type, url, successCallback, errorCallback, param) {\r\n        var opt = {\r\n            url: url,\r\n            async: false,\r\n            type: type,\r\n            success: function (res) {\r\n                successCallback(res);\r\n            },\r\n            error: function (res) {\r\n                errorCallback(res);\r\n            }\r\n        };\r\n\r\n        if (param) {\r\n            opt.data = param;\r\n        }\r\n\r\n        $.ajax(opt);\r\n    },\r\n    /**\r\n     * 获取金额大写\r\n     * @param {Number} n\r\n     */\r\n    getCnFormatMoney: function (n) {\r\n        var fraction = ['角', '分'];\r\n        var digit = [\r\n            '零', '壹', '贰', '叁', '肆',\r\n            '伍', '陆', '柒', '捌', '玖'\r\n        ];\r\n        var unit = [\r\n            ['元', '万', '亿'],\r\n            ['', '拾', '佰', '仟']\r\n        ];\r\n        var head = n < 0 ? '欠' : '';\r\n        n = Math.abs(n);\r\n        var s = '';\r\n        for (var i = 0; i < fraction.length; i++) {\r\n            s += (digit[Math.floor(n * 10 * Math.pow(10, i)) % 10] + fraction[i]).replace(/零./, '');\r\n        }\r\n        s = s || '整';\r\n        n = Math.floor(n);\r\n        for (var i = 0; i < unit[0].length && n > 0; i++) {\r\n            var p = '';\r\n            for (var j = 0; j < unit[1].length && n > 0; j++) {\r\n                p = digit[n % 10] + unit[1][j] + p;\r\n                n = Math.floor(n / 10);\r\n            }\r\n            s = p.replace(/(零.)*零$/, '').replace(/^$/, '零') + unit[0][i] + s;\r\n        }\r\n        return head + s.replace(/(零.)*零元/, '元')\r\n            .replace(/(零.)+/g, '零')\r\n            .replace(/^整$/, '零元整');\r\n    },\r\n    setObjectAttrVal: function (obj, exp, index, val) {\r\n        var arr = exp.split('.');\r\n\r\n        if (index == arr.length - 1) {\r\n            obj[arr[index]] = val;\r\n            return;\r\n        }\r\n\r\n        obj = obj[arr[index]];\r\n        index++;\r\n\r\n        this.setObjectAttrVal(obj, exp, index, val);\r\n    },\r\n    cloneObject: function (obj) {\r\n        // Handle the 3 simple types, and null or undefined\r\n        if (null == obj || 'object' !== typeof obj) return obj;\r\n\r\n        // Handle Date\r\n        if (obj instanceof Date) {\r\n            var copy = new Date();\r\n            copy.setTime(obj.getTime());\r\n            return copy;\r\n        }\r\n\r\n        // Handle Array\r\n        if (obj instanceof Array) {\r\n            var copy = [];\r\n            for (var i = 0, len = obj.length; i < len; ++i) {\r\n                copy[i] = GM.Form.CommonOper.cloneObject(obj[i]);\r\n            }\r\n            return copy;\r\n        }\r\n\r\n        // Handle Object\r\n        if (obj instanceof Object) {\r\n            var copy = {};\r\n            for (var attr in obj) {\r\n                if (obj.hasOwnProperty(attr)) copy[attr] = GM.Form.CommonOper.cloneObject(obj[attr]);\r\n            }\r\n            return copy;\r\n        }\r\n\r\n        throw new Error(\"Unable to copy obj! Its type isn't supported.\");\r\n    },\r\n    /**\r\n     * @description 展示地图对话框\r\n     */\r\n    showMapDialog: function () {\r\n        if (window.frames['processMap'].pMap == null) {\r\n            //第一次加载\r\n            $('#mapViewDialog').dialog({\r\n                title: '地图查看',\r\n                autoOpen: false,\r\n                resizeable: true,\r\n                draggable: true,\r\n                show: {\r\n                    effect: 'fadeIn',\r\n                    duration: 500\r\n                },\r\n                hide: {\r\n                    effect: 'fadeOut',\r\n                    duration: 500\r\n                },\r\n                modal: false,\r\n                width: 1200,\r\n                height: 500,\r\n                zIndex: 100,\r\n                position: {\r\n                    my: 'right bottom',\r\n                    at: 'right bottom',\r\n                    of: window\r\n                }\r\n            });\r\n            var pLocation = parent.location;\r\n            var strPathName = pLocation.pathname;\r\n            if (strPathName.toLowerCase().substr(strPathName.length - 4, 4) === 'html') {\r\n                strPathName = GM.FilePath.getDirName(strPathName);\r\n            } else if (strPathName.toLowerCase().substr(strPathName.length - 1, 1) === '\\/') {\r\n                strPathName = strPathName.substr(0, strPathName.length - 1);\r\n            }\r\n            window.frames['processMap'].location.href = pLocation.origin + strPathName + '/map.html';\r\n        }\r\n        $('#mapViewDialog').dialog('open');\r\n    }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/base/api.js","import 'formCommonApi';\r\n\r\n/**\r\n * 流程表单数据通用操作类\r\n * @class GM.Form.FormData\r\n */\r\nGM.Form.FormData = {\r\n    /**\r\n     * 初始化\r\n     */\r\n    init: function(formid) {\r\n        this._initScopeVar();\r\n        this._bindEvents(formid);\r\n\r\n        GM.Form.formScope.gridQueryParams = {\r\n            queryType: undefined,\r\n            queryValue: undefined\r\n        };\r\n\r\n        //加载表单时，初始化表单上所有的数据列表对象\r\n        if (GM.Form.parameters.formDataSourceNames && GM.Form.parameters.formDataSourceNames.length > 0) {\r\n            this._initOptions(GM.Form.formScope, GM.Form.parameters.formDataSourceNames);\r\n        }\r\n    },\r\n    _datas: {\r\n        globe: {}, //全局数据对象\r\n        saveKeys: {} //有表单出现多次时，保存的判断依据\r\n    },\r\n    _initScopeVar: function() {\r\n        GM.Form.formScope.result = {}; //当前表单数据对象\r\n    },\r\n    _bindEvents: function(formid) {\r\n        var _this = this;\r\n\r\n        //获取数据\r\n        GM.Form.formScope.getData = function() {\r\n            if (!GM.Form.parameters.urlParams.did) {\r\n                _this._getData(formid);\r\n            } else if (GM.Form.parameters.urlParams.did) {\r\n                _this._getDraftData(GM.Form.parameters.urlParams.did);\r\n            }\r\n        };\r\n\r\n        //保存数据\r\n        GM.Form.formScope.save = function(successCallback, failureCallback) {\r\n            _this._saveData(false, successCallback, failureCallback);\r\n        };\r\n\r\n        //保存数据并移交\r\n        GM.Form.formScope.saveAndHandOver = function() {\r\n            _this._saveData(true);\r\n        };\r\n\r\n        GM.Form.formScope.saveDraft = function() {\r\n            _this._saveDraft(GM.Form.parameters.urlParams.duuid || GM.Form.parameters.urlParams.did);\r\n        };\r\n\r\n        GM.Form.formScope.getSingleDataGrid = function(formid, ds) {\r\n            _this._getSingleDataGrid(GM.Form.formScope, formid, ds);\r\n        };\r\n\r\n        GM.Form.formScope.dataGridSelect = function(item) {\r\n            _this._dataGridSelect(GM.Form.formScope, item);\r\n            item.grid.appScope.closeThisDialog();\r\n        };\r\n\r\n        GM.Form.formScope.saveDialog = function() {\r\n            _this._saveDialog();\r\n            GM.Form.formScope.closeFormDialog();\r\n        };\r\n\r\n        GM.Form.formScope.dgA = function(item) {\r\n            _this._dataGridOperA(GM.Form.formScope, item);\r\n        };\r\n\r\n        GM.Form.formScope.dgB = function(item) {\r\n            _this._dataGridOperB(GM.Form.formScope, item);\r\n        };\r\n\r\n        GM.Form.formScope.getRedisString = function(key) {\r\n            return _this._getRedisString(key);\r\n        };\r\n\r\n        GM.Form.formScope.removeRedisString = function(key) {\r\n            _this._removeRedisString(key);\r\n        };\r\n\r\n        GM.Form.formScope.redisString = function(key, data) {\r\n            _this._redisString(key, data);\r\n        };\r\n\r\n        GM.Form.formScope.initDataGridOptions = function(formid) {\r\n            _this._initDataGridOptions(GM.Form.formScope, formid);\r\n        };\r\n\r\n        GM.Form.formScope.initDataGridHeaders = function(ds, fieldString, operString) {\r\n            _this._getGridOption(GM.Form.formScope, ds, null, null, fieldString, operString);\r\n        };\r\n    },\r\n    /**\r\n     * 初始化表单上所有数据列表控件数据源\r\n     *\r\n     * @param {Object} scope    当前作用域\r\n     * @param {Array} dgds      所有数据列表的数据源别名列表\r\n     */\r\n    _initOptions: function(scope, dgds) {\r\n        if (!dgds || dgds.length === 0) {\r\n            return;\r\n        }\r\n\r\n        for (var i = 0; i < dgds.length; i++) {\r\n            if (dgds[i]) {\r\n                var grid = $(\"div[ui-grid='\" + dgds[i] + \"Option']\");\r\n                var sDataItems, sTemplateItems;\r\n\r\n                if (grid.length > 0) {\r\n                    sDataItems = grid.attr('data-items');\r\n                    sTemplateItems = grid.attr('template-items');\r\n                }\r\n\r\n                this._getGridOption(scope, dgds[i], null, null, sDataItems, sTemplateItems);\r\n            }\r\n        }\r\n    },\r\n    /**\r\n     * 根据formid初始化相关的所有数据列表对象\r\n     *\r\n     * @param {Object} scope 当前作用域\r\n     * @param {String} formid 表单ID\r\n     */\r\n    _initDataGridOptions: function(scope, formid) {\r\n        var _this = this;\r\n        var url = window.FORM_REST_URL.workflow.getDataGridDataSourceNames + '?formids=' + formid;\r\n        GM.Form.CommonOper.syncAjaxGet(url, function(res) {\r\n            if (res.success === true && res.data) {\r\n                _this._initOptions(scope, res.data);\r\n            }\r\n        }, function(res) {});\r\n    },\r\n    /**\r\n     * 获取Redis缓存的数据\r\n     *\r\n     * @param {String} key 键\r\n     */\r\n    _getRedisString: function(key) {\r\n        var result;\r\n        GM.Form.CommonOper.syncAjaxGet(window.FORM_REST_URL.workflow.getRedisString + '?key=' + key, function(res) {\r\n            if (res.success === true && !!res.data) {\r\n                result = res.data;\r\n            }\r\n        }, function(res) {});\r\n\r\n        return result;\r\n    },\r\n    /**\r\n     * 删除Redis缓存的数据\r\n     *\r\n     * @param {String} key 键\r\n     */\r\n    _removeRedisString: function(key) {\r\n        GM.Form.CommonOper.syncAjaxGet(window.FORM_REST_URL.workflow.removeRedisString + '?key=' + key, function(res) {}, function(res) {});\r\n    },\r\n    /**\r\n     * 缓存数据到Redis\r\n     *\r\n     * @param {String} key 键\r\n     * @param {String} data 数据\r\n     */\r\n    _redisString: function(key, data) {\r\n        GM.Form.CommonOper.syncAjaxPost(window.FORM_REST_URL.workflow.getRedisString + '?key=' + key, function(res) {}, function(res) {}, {\r\n            key: key,\r\n            data: data\r\n        });\r\n    },\r\n    /**\r\n     * 数据列表通用操作之一：弹出对话框\r\n     *\r\n     * @param {Object} scope    当前作用域\r\n     * @param {Object} item     当前行对象\r\n     */\r\n    _dataGridOperA: function(scope, item) {\r\n        var ele = event.srcElement;\r\n\r\n        if (!ele) {\r\n            return;\r\n        }\r\n\r\n        var linkText = $(ele).text();\r\n        var templates = item.grid.element.attr('template-items').split(',');\r\n        var formid;\r\n\r\n        for (var i = 0; i < templates.length; i++) {\r\n            var arr = templates[i].split(':');\r\n\r\n            if (arr.length < 3) {\r\n                continue;\r\n            }\r\n\r\n            if (arr[1] == linkText) {\r\n                formid = arr[2];\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (formid) {\r\n            this._showDataGridDlg(scope, item, formid);\r\n        }\r\n    },\r\n    /**\r\n     * 数据列表通用操作之二：调用REST服务\r\n     *\r\n     * @param {Object} scope    当前作用域\r\n     * @param {Object} item     当前行对象\r\n     */\r\n    _dataGridOperB: function(scope, item) {\r\n        var ele = event.srcElement;\r\n\r\n        if (!ele) {\r\n            return;\r\n        }\r\n\r\n        var linkText = $(ele).text();\r\n        var templates = item.grid.element.attr('template-items').split(',');\r\n        var service, method, tip, msg;\r\n\r\n        for (var i = 0; i < templates.length; i++) {\r\n            var arr = templates[i].split(':');\r\n\r\n            if (arr.length < 3) {\r\n                continue;\r\n            }\r\n\r\n            if (arr[1] == linkText) {\r\n                service = arr[2];\r\n\r\n                if (arr[3]) {\r\n                    method = arr[3];\r\n                }\r\n\r\n                if (arr[4]) {\r\n                    tip = arr[4].replace(/RDS_COLON/g, ':');\r\n                }\r\n\r\n                if (arr[5]) {\r\n                    msg = arr[5];\r\n                }\r\n\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (service) {\r\n            var _this = this;\r\n\r\n            if (tip) {\r\n                GM.Alert.show('提示', tip, {\r\n                    showCancelButton: true\r\n                }, function() {\r\n                    _this._invokeDataGridREST(scope, item, service, method, msg);\r\n                });\r\n            } else {\r\n                _this._invokeDataGridREST(scope, item, service, method, msg);\r\n            }\r\n        }\r\n    },\r\n    /**\r\n     * 数据列表通用操作之一：弹出对话框\r\n     *\r\n     * @param {Object} scope    当前作用域\r\n     * @param {Object} item     当前行对象\r\n     * @param {String} formid   弹出对话框的formid\r\n     */\r\n    _showDataGridDlg: function(scope, item, formid) {\r\n        var ds = item.grid.element.attr('data-items');\r\n\r\n        //向弹出的对话框作用域传入相关参数\r\n        if (ds) {\r\n            var arr = ds.split(',');\r\n\r\n            for (var u = 0; u < arr.length; u++) {\r\n                if (arr[u]) {\r\n                    var arrDataItems = arr[u].split(':');\r\n\r\n                    if (arrDataItems.length === 3) {\r\n                        GM.Form.parameters.urlParams[arrDataItems[2]] = item.entity[arrDataItems[0]];\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        GM.Form.formScope.showFormDialog(null, formid);\r\n        _this._getData(formid, true);\r\n    },\r\n    /**\r\n     * 数据列表通用操作之二：调用REST服务\r\n     *\r\n     * @param {Object} scope    当前作用域\r\n     * @param {Object} item     当前行对象\r\n     * @param {String} service  调用的service\r\n     * @param {String} method   GET 或者 POST等\r\n     * @param {String} msg      调用成功后的提示信息\r\n     */\r\n    _invokeDataGridREST: function(scope, item, service, method, msg) {\r\n        if (!RESTURL.dg || !RESTURL.dg[service]) {\r\n            GM.Form.CommonOper.showFailureMsg('未配置[' + service + ']服务。');\r\n            return;\r\n        }\r\n\r\n        var _this = this;\r\n\r\n        var formid = item.grid.element.attr('formid');\r\n        var dataItems = item.grid.element.attr('data-items');\r\n        var ds = item.grid.element.attr('ui-grid');\r\n\r\n        if (ds) {\r\n            ds = ds.replace('Option', '');\r\n        }\r\n\r\n        var param = {};\r\n\r\n        //向弹出的对话框作用域传入相关参数\r\n        if (dataItems) {\r\n            var arr = dataItems.split(',');\r\n\r\n            for (var u = 0; u < arr.length; u++) {\r\n                if (arr[u]) {\r\n                    var arrDataItems = arr[u].split(':');\r\n\r\n                    if (arrDataItems.length === 3) {\r\n                        param[arrDataItems[2]] = item.entity[arrDataItems[0]];\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        var invoke;\r\n\r\n        if (method && method.toUpperCase() == 'POST') {\r\n            invoke = GM.Form.restful.post(RESTURL.dg[service], param);\r\n        } else {\r\n            invoke = GM.Form.restful.get(RESTURL.dg[service], param);\r\n        }\r\n\r\n        invoke.then(function(res) {\r\n            if (res.success === true && !!formid && !!ds) {\r\n                _this._getSingleDataGrid(scope, formid, ds);\r\n            } else if (res.success === false) {\r\n                GM.Form.CommonOper.showFailureMsg(res.message);\r\n            }\r\n        }, function(res) {\r\n            GM.Form.CommonOper.showFailureMsg(res.message);\r\n        });\r\n    },\r\n    /**\r\n     * 将选定的项目相关的信息展示在页面上\r\n     *\r\n     * @param {Object} scope\r\n     * @param {Object} item\r\n     */\r\n    _dataGridSelect: function(scope, item) {\r\n        var ds = item.grid.element.attr('ui-grid');\r\n\r\n        if (ds) {\r\n            ds = ds.replace('Option', '');\r\n            var paras = scope[ds + 'KeyParas'];\r\n\r\n            if (paras && paras.length > 0) {\r\n                for (var u = 0; u < paras.length; u++) {\r\n                    GM.Form.parameters.urlParams[paras[u].para] = item.entity[paras[u].key];\r\n                }\r\n            }\r\n\r\n            if (scope.gridQueryParams && !!scope.gridQueryParams.queryType && !!scope.gridQueryParams.queryValue) {\r\n                GM.Form.parameters.urlParams.searchType = scope.gridQueryParams.queryType;\r\n                GM.Form.parameters.urlParams.searchValue = scope.gridQueryParams.queryValue;\r\n            }\r\n        }\r\n\r\n        this._getData(false, true);\r\n        scope.closeFormDialog();\r\n    },\r\n    /**\r\n     * 刷新单个数据列表\r\n     *\r\n     * @param {Object} scope    当前作用域\r\n     * @param {String} formid   数据列表所在表单formid\r\n     * @param {String} ds       数据列表的数据源别名\r\n     */\r\n    _getSingleDataGrid: function(scope, formid, ds) {\r\n        var _this = this;\r\n        var para = angular.copy(GM.Form.parameters.urlParams);\r\n\r\n        if (!para.ywh) {\r\n            para.ywh = para.did || para.duuid;\r\n        }\r\n\r\n        if (scope.gridQueryParams.queryValue) {\r\n            para.queryType = scope.gridQueryParams.queryType;\r\n            para.queryValue = scope.gridQueryParams.queryValue;\r\n            scope.gridQueryParams = {\r\n                queryType: '',\r\n                queryValue: ''\r\n            };\r\n        }\r\n\r\n        var up = {\r\n            'up': para\r\n        };\r\n\r\n        var param = {\r\n            formids: formid,\r\n            dataSourceName: ds,\r\n            urlParameters: JSON.stringify(up)\r\n        };\r\n        GM.Form.restful.get(GM.Form.parameters.servers.getSingleDataGridServer, param).then(function(res) {\r\n            if (res.success === true && res.data) {\r\n                _this._bindDataGrid(scope, ds, res.data);\r\n            }\r\n        }, function(res) {});\r\n    },\r\n    /**\r\n     * 获取数据列表的相关配置\r\n     *\r\n     * @param {Object} scope            作用域\r\n     * @param {String} ds               数据列表的数据源别名\r\n     * @param {Array} data              数据\r\n     * @param {Array} hd                表头列表\r\n     * @param {String} dataItems        包含标题和字段对应关系的字符串（与hd不能同时为空）\r\n     * @param {String} templateItems    操作列表\r\n     */\r\n    _getGridOption: function(scope, ds, data, hd, dataItems, templateItems) {\r\n        var gridOptionName = ds + 'Option';\r\n        scope[gridOptionName] = {};\r\n\r\n        var gridOptions = {};\r\n        var tableGrid = new GM.Form.gmTable();\r\n        var templates = [],\r\n            heads = [];\r\n\r\n        if (templateItems) {\r\n            var arrTemps = templateItems.split(',');\r\n            for (var i = 0; i < arrTemps.length; i++) {\r\n                if (arrTemps[i] != '') {\r\n                    var arr = arrTemps[i].split(':');\r\n                    templates.push({\r\n                        name: arr[1],\r\n                        click: arr[0]\r\n                    });\r\n                }\r\n            }\r\n        }\r\n\r\n        if (dataItems) {\r\n            var arrTemps = dataItems.split(',');\r\n            var gridParas = [];\r\n\r\n            for (var i = 0; i < arrTemps.length; i++) {\r\n                if (arrTemps[i] != '') {\r\n                    var arr = arrTemps[i].split(':');\r\n                    heads.push({\r\n                        name: arr[0],\r\n                        displayName: arr[1],\r\n                        enableColumnMenu: false,\r\n                        cellTooltip: true\r\n                    });\r\n\r\n                    if (arr.length === 3) {\r\n                        gridParas.push({\r\n                            key: arr[0],\r\n                            para: arr[2]\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (gridParas.length > 0) {\r\n                scope[ds + 'KeyParas'] = gridParas;\r\n            }\r\n        } else if (hd && hd.length > 0) {\r\n            for (var i = 0; i < hd.length; i++) {\r\n                heads.push({\r\n                    name: hd[i],\r\n                    displayName: hd[i],\r\n                    enableColumnMenu: false,\r\n                    cellTooltip: true\r\n                });\r\n            }\r\n        }\r\n\r\n        if (templates.length > 0) {\r\n            var strCellTemplate = tableGrid.getCellTemplate(templates);\r\n\r\n            heads.push({\r\n                name: 'operate',\r\n                displayName: '操作',\r\n                enableColumnMenu: false,\r\n                cellTemplate: strCellTemplate\r\n            });\r\n        }\r\n\r\n        gridOptions.data = data;\r\n        gridOptions.columnDefs = heads;\r\n        scope[gridOptionName] = gridOptions;\r\n        tableGrid.updateSize();\r\n    },\r\n    _bindDataGrid: function(scope, ds, data) {\r\n        var _this = this;\r\n\r\n        for (var key in data) {\r\n            if (!!ds && key != ds && key != 'page__' + ds) {\r\n                continue;\r\n            }\r\n\r\n            if (key.indexOf('dg__') === 0) {\r\n                if (!(data[key] instanceof Array)) {\r\n                    var dgData = data[key];\r\n                    var sDataItems = $(\"div[ui-grid='\" + key + \"Option']\").attr('data-items');\r\n                    var sTemplateItems = $(\"div[ui-grid='\" + key + \"Option']\").attr('template-items');\r\n\r\n                    _this._getGridOption(scope, key, dgData.data.page.records, dgData.headList, sDataItems, sTemplateItems);\r\n                } else if ((scope.pstyle == 'landtree' || scope.isDataComplex === true) && scope.globalTreeData[key]) {\r\n                    scope.globalTreeData[key] = data[key];\r\n                    //updateDataGridsBind($scope.focusNode);\r\n                }\r\n            }\r\n\r\n            if (key && key.indexOf('page__') === 0) {\r\n                scope[key] = data[key];\r\n            }\r\n        }\r\n    },\r\n    _getDraftData: function(key) {\r\n        GM.Form.restful.get(RESTURL.process.getDraftInfo + '?id=' + key).then(function(response) {\r\n            if (response.success === true && response.data != null) {\r\n                GM.Form.formScope.result = JSON.parse(response.data);\r\n            }\r\n        }, function(response) {});\r\n    },\r\n    _saveDraft: function(key) {\r\n        var param = {\r\n            id: key,\r\n            userId: top.GM.userInfo.loginName,\r\n            appId: top.GM.AppInfo.id,\r\n            processDefId: GM.Form.parameters.urlParams.processDefId,\r\n            processName: GM.Form.parameters.urlParams.processName,\r\n            processKey: GM.Form.parameters.urlParams.processKey\r\n        };\r\n\r\n        var ctrl = angular.element(\"[data-role='bizname']\");\r\n\r\n        if (ctrl && ctrl > 0) {\r\n            param.bizName = ctrl.val();\r\n        }\r\n\r\n        GM.Form.restful.get(RESTURL.process.saveDraftBaseInfo, param).then(function(res) {\r\n            if (res.success === true) {\r\n                param = {\r\n                    id: key,\r\n                    data: _this._getSavingData()\r\n                };\r\n                GM.Form.restful.post(RESTURL.process.saveDraftInfo, param).then(function(r) {\r\n                    if (r.success === true) {\r\n                        GM.Form.CommonOper.showSuccessMsg('保存成功！');\r\n                    } else {\r\n                        GM.Form.CommonOper.showFailureMsg(r.message);\r\n                    }\r\n                }, function(r) {\r\n                    GM.Form.CommonOper.showFailureMsg(r.message);\r\n                });\r\n            }\r\n        }, function(res) {\r\n            GM.Form.CommonOper.showFailureMsg(res.message);\r\n        });\r\n    },\r\n    /**\r\n     * 初始化页面数据\r\n     *\r\n     * @param {String} formid\r\n     * @param {Boolean} keepOldData 是否保留原始数据\r\n     */\r\n    _getData: function(formid, keepOldData) {\r\n        var _this = this;\r\n\r\n        var params = {\r\n            formids: (formid || GM.Form.parameters.formIds.join(',')),\r\n            urlParameters: JSON.stringify(GM.Form.parameters.urlParams)\r\n        };\r\n\r\n        GM.Form.restful.get(GM.Form.parameters.servers.getDataServer, params).then(function(res) {\r\n            if (res.success === false) {\r\n                GM.Form.CommonOper.showFailureMsg('页面加载数据失败：' + res.message);\r\n                return;\r\n            }\r\n\r\n            _this._datas.globe = res.data;\r\n            console.log(_this._datas.globe);\r\n            console.log(GM.Form.formScope.result);\r\n            if (!_this._datas.globe.treeKey) {\r\n                if (!keepOldData) {\r\n                    GM.Form.formScope.result = _this._datas.globe;\r\n                } else {\r\n                    for (var key in GM.Form.formScope.result) {\r\n                        if (key.indexOf('dg__') < 0) {\r\n                            if (_this._datas.globe[key] && !$.isEmptyObject(_this._datas.globe[key]) &&\r\n                                $.isEmptyObject(GM.Form.formScope.result[key])) {\r\n                                GM.Form.formScope.result[key] = _this._datas.globe[key];\r\n                            }\r\n                        } else if (key.indexOf('dg__') === 0) {\r\n                            if (_this._datas.globe[key].data.page.records.length > 0 &&\r\n                                GM.Form.formScope.result[key].data.page.records.length === 0) {\r\n                                GM.Form.formScope.result[key] = _this._datas.globe[key];\r\n                            }\r\n                        } else if (key.indexOf('page__') === 0) {\r\n                            if (_this._datas.globe[key].totalItems > 0 &&\r\n                                GM.Form.formScope.result[key].totalItems === 0) {\r\n                                GM.Form.formScope.result[key] = _this._datas.globe[key];\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                for (var key in _this._datas.globe) {\r\n                    if (key == 'treeKey' || _this._datas.globe.treeKey[key]) {\r\n                        continue;\r\n                    }\r\n\r\n                    GM.Form.formScope.result[key] = _this._datas.globe[key];\r\n                }\r\n            }\r\n            //初始化数据表格与其分页对象\r\n            _this._bindDataGrid(GM.Form.formScope, null, _this._datas.globe);\r\n\r\n            //默认设置审核人与审核时间值\r\n            if (GM.CommonOper.isStrNullOrEmpty(GM.Form.formScope.result.sc_spxx.SHRYXM)) {\r\n                GM.Form.formScope.result.sc_spxx.SHRYXM = GM.userInfo.realName;\r\n            }\r\n            if (GM.CommonOper.isStrNullOrEmpty(GM.Form.formScope.result.sc_spxx.SHJSSJ)) {\r\n                var pCurDate = new Date();\r\n                var strFormatDate = GM.CommonOper.getFormatData(pCurDate.getTime());\r\n                GM.Form.formScope.result.sc_spxx.SHJSSJ = strFormatDate;\r\n            }\r\n        }, function(res) {\r\n            GM.Form.CommonOper.showFailureMsg('页面加载数据失败：' + res.message);\r\n        });\r\n    },\r\n    _getSavingData: function() {\r\n        var data;\r\n\r\n        if (this._datas.globe.treeKey) {\r\n            //this.updateGlobalData();\r\n            data = angular.copy(this._datas.globe);\r\n        } else {\r\n            data = angular.copy(GM.Form.formScope.result);\r\n        }\r\n\r\n        data = JSON.stringify(data);\r\n        return data;\r\n    },\r\n    _saveDialog: function() {\r\n        if (!GM.Form.formScope.dialogParameter.formid) {\r\n            return;\r\n        }\r\n\r\n        var _this = this;\r\n        var paras = {};\r\n        angular.copy(GM.Form.parameters.urlParams, paras);\r\n\r\n        if (GM.Form.formScope.dialogParameter.params) {\r\n            for (var key in GM.Form.formScope.dialogParameter.params) {\r\n                paras[key] = GM.Form.formScope.dialogParameter.params[key];\r\n            }\r\n        }\r\n\r\n        var param = {\r\n            formids: GM.Form.formScope.dialogParameter.formid,\r\n            urlParameters: JSON.stringify(paras),\r\n            keys: JSON.stringify(_this._datas.saveKeys),\r\n            data: _this._getSavingData()\r\n        };\r\n\r\n        GM.Form.CommonOper.syncAjaxPost(GM.Form.parameters.servers.saveDataServer, function(res) {\r\n            if (res.success === true) {\r\n                GM.Form.CommonOper.showSuccessMsg('保存成功');\r\n            } else {\r\n                GM.Form.CommonOper.showFailureMsg(res.message);\r\n            }\r\n        }, function(res) {\r\n            GM.Form.CommonOper.showFailureMsg(res.message);\r\n        }, param);\r\n    },\r\n    /**\r\n     * 保存数据\r\n     *\r\n     * @param {Boolean} autoHandOver        保存成功之后是否自动移交\r\n     * @param {Function} successCallback    保存成功之后回调\r\n     * @param {Function} failureCallback    保存失败之后回调\r\n     */\r\n    _saveData: function(autoHandOver, successCallback, failureCallback) {\r\n        var _this = this;\r\n\r\n        var param = {\r\n            urlParameters: JSON.stringify(GM.Form.parameters.urlParams),\r\n            keys: JSON.stringify(_this._datas.saveKeys),\r\n            data: _this._getSavingData()\r\n        };\r\n\r\n        if (GM.Form.parameters.savingFormIds && GM.Form.parameters.savingFormIds.length > 0) {\r\n            param.formids = GM.Form.parameters.savingFormIds.join(',');\r\n        } else {\r\n            param.formids = GM.Form.parameters.formIds.join(',');\r\n        }\r\n\r\n        GM.Form.CommonOper.syncAjaxPost(GM.Form.parameters.servers.saveDataServer, function(res) {\r\n            if (res.success === true) {\r\n                if (successCallback) {\r\n                    successCallback();\r\n                    return;\r\n                }\r\n\r\n                if (autoHandOver === true) {\r\n                    GM.Form.formScope.handOver();\r\n                } else {\r\n                    GM.Form.CommonOper.showSuccessMsg('保存成功');\r\n                }\r\n            } else {\r\n                if (failureCallback) {\r\n                    failureCallback();\r\n                }\r\n\r\n                GM.Form.CommonOper.showFailureMsg(res.message);\r\n            }\r\n        }, function(res) {\r\n            if (failureCallback) {\r\n                failureCallback();\r\n            }\r\n\r\n            GM.Form.CommonOper.showFailureMsg(res.message);\r\n        }, param);\r\n    }\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/base/form-data.js","import 'formCommonApi';\r\nimport 'formWorkflow';\r\nimport 'formData';\r\nimport 'formWebgis';\r\n\r\nGM.Form.formScope = undefined; //angular当前SCOPE\r\nGM.Form.restful = undefined; //RESTful服务调用对象\r\nGM.Form.validationObject = undefined; //页面\r\nGM.Form.ngDialog = undefined; //对话框组件\r\nGM.Form.gmTable = undefined; //数据列表控件\r\nGM.Form.filter = undefined; //过滤器对象\r\nGM.Form.timeout = undefined; //定时器对象\r\n//表单参数\r\nGM.Form.parameters = {\r\n    appId: undefined, //APP ID\r\n    serviceAppKey: undefined, //APP标识，由前文传入，非当前登录信息所述\r\n    urlParams: undefined, //页面参数\r\n    userInfo: {\r\n        realName: top.GM.userInfo == null ? '' : top.GM.userInfo.realName,\r\n        loginName: top.GM.userInfo == null ? '' : top.GM.userInfo.loginName\r\n    }, //用户登录信息\r\n    dataLoaded: false, //数据是否已加载\r\n    formValid: true, //数据验证是否通过\r\n    formIds: [], //表单ID列表\r\n    savingFormIds: [], //待保存表单ID\r\n    saveLayerName: undefined, //不为空，则在保存之前保存图形坐标数据\r\n    servers: {\r\n        getDataServer: undefined, //获取数据服务接口地址\r\n        saveDataServer: undefined, //保存数据服务接口地址\r\n        getHandOverVarServer: undefined, //移交判断服务接口地址\r\n        updateBizFlowInfoServer: undefined, //在业务库中保存流程流转信息的拷贝\r\n        getSingleDataGridServer: undefined //获取单个数据列表数据源\r\n    },\r\n    formDataSourceNames: [] //当前表单及所涉及（如弹出框）的所有表单涉及到的所有数据源别名\r\n};\r\n\r\n/**\r\n * 流程表单引擎类\r\n * @class GM.Form.FormEngine\r\n */\r\nGM.Form.FormEngine = {\r\n    _functions: {\r\n        beforeGetData: [], //提取数据之前\r\n        afterGetData: [], //获取数据之后\r\n        pageLoaded: [] //页面加载之后\r\n    }, //各阶段额外执行的操作\r\n    _initScopeVar: function () {\r\n        var _this = this;\r\n\r\n        GM.Form.formScope.settings = {\r\n            layoutUrl: undefined, //表单组织形式\r\n            forms: [], //表单\r\n            tabs: [], //表单配置\r\n            prints: [], //打印列表\r\n            buttons: [], //底部按钮列表\r\n            topUrl: undefined, //头部功能区Url\r\n            showBottom: false, //底部功能区是否展示\r\n            loadWebGIS: false //是否加载地块管理等webgis功能\r\n        }; //表单整体框架设置\r\n\r\n        GM.Form.formScope.draftInfo = {\r\n            key: undefined\r\n        }; //草稿信息\r\n\r\n        GM.Form.formScope.dataLoaded = false;\r\n        GM.Form.formScope.hasInitCalcs = false;\r\n    },\r\n    /**\r\n     * 入口。初始化全局变量，scope上下文等\r\n     * @param {Object} scope    表单作用域\r\n     * @param {Object} r        调用RESTful服务对象\r\n     * @param {Object} v        控件验证对象\r\n     * @param {Object} d        对话框组件\r\n     * @param {Object} g        数据列表组件\r\n     */\r\n    init: function (scope, r, v, f, d, g, t) {\r\n        var _this = this;\r\n        GM.Form.parameters.urlParams = GM.LayoutOper.getURLParams(window.location.href);\r\n        GM.Form.parameters.appId = GM.Form.parameters.urlParams.appId;\r\n        GM.Form.parameters.serviceAppKey = GM.Form.parameters.urlParams.serviceAppKey;\r\n\r\n        if (GM.Form.parameters.urlParams.serviceAppKey) {\r\n            for (var key in GM.Form.parameters.servers) {\r\n                GM.Form.parameters.servers[key] = _this._getFormServiceUrl(GM.Form.parameters.urlParams.serviceAppKey) + FORM_REST_URL.form[key];\r\n            }\r\n        }\r\n\r\n        GM.Form.formScope = scope;\r\n        GM.Form.restful = r;\r\n        GM.Form.validationObject = v;\r\n        GM.Form.filter = f;\r\n        GM.Form.ngDialog = d;\r\n        GM.Form.gmTable = g;\r\n        GM.Form.timeout = t;\r\n\r\n        this._initScopeVar();\r\n\r\n        if (!GM.Form.formScope) {\r\n            this.showFailureMsg('无法初始化上下文！');\r\n            return;\r\n        }\r\n\r\n        if (!top.GM.userInfo) {\r\n            this.showFailureMsg('无法获取登录用户信息！');\r\n            return;\r\n        }\r\n\r\n        this._loadPage();\r\n        this._bindEvents();\r\n        this._doAfterLoadPage(GM.Form.formScope);\r\n    },\r\n    getAppServerUrl: function (appKey) {\r\n        var url = this._getFormServiceUrl(appKey || GM.Form.parameters.urlParams.serviceAppKey);\r\n\r\n        if (url) {\r\n            if (url.substring(url.length - 1, url.length) == '/') {\r\n                url = url.substring(0, url.length - 1);\r\n            }\r\n\r\n            return url.substring(0, url.lastIndexOf('/'));\r\n        }\r\n\r\n        return undefined;\r\n    },\r\n    /**\r\n     * 在0.5秒后将重命名所有切换页，防止重名导致错误\r\n     */\r\n    _doAfterLoadPage: function (scope) {\r\n        var _this = this;\r\n\r\n        GM.Form.timeout(function () {\r\n            $('.nav li a[data-target]').each(function () {\r\n                var tabId = $(this).attr('data-target').replace('#', '');\r\n                var newTabId = GM.Form.CommonOper.getUUID();\r\n                var tabDiv = $(this).parent('li').parent('ul').parent('div').next('.div-content').find(\"div[id='\" + tabId + \"']\");\r\n\r\n                if (tabDiv.length > 0) {\r\n                    tabDiv.attr('id', newTabId);\r\n                    $(this).attr('data-target', '#' + newTabId);\r\n                }\r\n            });\r\n\r\n            if (scope.hasInitCalcs === false && angular.element('[calc-exp]').length > 0) {\r\n                _this._watchCalcExp(scope);\r\n                scope.hasInitCalcs = true;\r\n            }\r\n        }, 500);\r\n    },\r\n    _getFormServiceUrl: function (appKey) {\r\n        var result = null;\r\n\r\n        //然后取前端配置\r\n        if (result == null) {\r\n            try {\r\n                for (var ii = 0; ii < CONFIG_JSON.length; ii++) {\r\n                    if (appKey === CONFIG_JSON[ii].app) {\r\n                        result = CONFIG_JSON[ii].value + 'form/';\r\n                        break;\r\n                    }\r\n                }\r\n            } catch (ex) {\r\n                //调试环境取调试配置\r\n                result = FORM_SERVER;\r\n                console.log(ex);\r\n            }\r\n        }\r\n\r\n        return result;\r\n    },\r\n    /**\r\n     * 绑定ng事件\r\n     */\r\n    _bindEvents: function () {\r\n        var _this = this;\r\n\r\n        GM.Form.formScope.invokePlugin = function (validScope, name) {\r\n            _this._clickEvent(validScope, name);\r\n        };\r\n\r\n        GM.Form.formScope.treeConfig = {\r\n            'activeNode': 'treeEvent'\r\n        };\r\n\r\n        GM.Form.formScope.treeEvent = function (node) {\r\n            _this._treeConfig(GM.Form.formScope, node);\r\n        };\r\n\r\n        //打印\r\n        GM.Form.formScope.print = function (code, para) {\r\n            _this._print(para || GM.Form.formScope.taskInfo.bizKey, code, top.GM.AppInfo.id);\r\n        };\r\n\r\n        //弹出对话框\r\n        GM.Form.formScope.showFormDialog = function (url, formid, name, buttons) {\r\n            _this._showFormDialog(GM.Form.formScope, url, formid, name, buttons);\r\n        };\r\n\r\n        GM.Form.formScope.closeFormDialog = function () {\r\n            Dialog.close();\r\n        };\r\n\r\n        GM.Form.formScope.formLoaded = function () {\r\n            _this._formLoaded(GM.Form.formScope);\r\n        };\r\n\r\n        GM.Form.formScope.isCbChecked = function (a, b) {\r\n            return _this._isCheckBoxChecked(GM.Form.formScope, a, b);\r\n        };\r\n\r\n        GM.Form.formScope.cbCheck = function (e, a, b) {\r\n            _this._cbCheck(GM.Form.formScope, e, a, b);\r\n        };\r\n\r\n        //自动计算\r\n        GM.Form.formScope.$watch('dataLoaded', function () {\r\n            if (GM.Form.formScope.dataLoaded === true && GM.Form.formScope.hasInitCalcs === false && angular.element('[calc-exp]').length > 0) {\r\n                _this._watchCalcExp(GM.Form.formScope);\r\n                GM.Form.formScope.hasInitCalcs = true;\r\n            }\r\n        });\r\n    },\r\n    _watchCalcExp: function (scope) {\r\n        var _this = this;\r\n        //当前用户名\r\n        angular.element(\":text[calc-exp='user'][ng-model],textarea[calc-exp='user'][ng-model]\").each(function () {\r\n            var sUserNgModel = $(this).attr('ng-model');\r\n\r\n            scope.$watch(sUserNgModel, function () {\r\n                var vCur;\r\n\r\n                try {\r\n                    vCur = eval('GM.Form.formScope.' + sUserNgModel);\r\n                } catch (e) {\r\n\r\n                }\r\n\r\n                if (!vCur || vCur == '') {\r\n                    GM.Form.CommonOper.setObjectAttrVal(scope, sUserNgModel, 0, top.GM.userInfo.realName);\r\n                }\r\n            });\r\n        });\r\n\r\n        //当前用户登录名\r\n        angular.element(\":text[calc-exp='userid'][ng-model],textarea[calc-exp='userid'][ng-model]\").each(function () {\r\n            var sUserNgModel = $(this).attr('ng-model');\r\n\r\n            scope.$watch(sUserNgModel, function () {\r\n                var vCur;\r\n\r\n                try {\r\n                    vCur = eval('GM.Form.formScope.' + sUserNgModel);\r\n                } catch (e) {\r\n\r\n                }\r\n\r\n                if (!vCur || vCur == '') {\r\n                    GM.Form.CommonOper.setObjectAttrVal(scope, sUserNgModel, 0, top.GM.userInfo.loginName);\r\n                }\r\n            });\r\n        });\r\n\r\n        //当日日期\r\n        angular.element(\":text[calc-exp='sysdate'][ng-model],textarea[calc-exp='sysdate'][ng-model]\").each(function () {\r\n            var sUserNgModel = $(this).attr('ng-model');\r\n\r\n            scope.$watch(sUserNgModel, function () {\r\n                var vCur;\r\n\r\n                try {\r\n                    vCur = eval('GM.Form.formScope.' + sUserNgModel);\r\n                } catch (e) {\r\n\r\n                }\r\n\r\n                if (!vCur || vCur == '') {\r\n                    var dt = new Date();\r\n                    var vYear = dt.getFullYear();\r\n                    var vMonth = (dt.getMonth() < 9 ? '0' : '') + (dt.getMonth() + 1);\r\n                    var vDate = (dt.getDate() < 10 ? '0' : '') + dt.getDate();\r\n                    var vSysDate = vYear + '-' + vMonth + '-' + vDate;\r\n\r\n                    GM.Form.CommonOper.setObjectAttrVal(scope, sUserNgModel, 0, vSysDate);\r\n                }\r\n            });\r\n        });\r\n\r\n        if (angular.element(\"[calc-exp][calc-exp!='user'][calc-exp!='userid'][calc-exp!='sysdate']\").length > 0) {\r\n            var arrCalcOpers = ['+', '-', '*', '/', '^', '%', '(', ')'];\r\n            angular.element(\"[calc-exp][calc-exp!='user'][calc-exp!='userid'][calc-exp!='sysdate']\").each(function () {\r\n                var sCalcExp = $(this).attr('calc-exp');\r\n                var isCn = sCalcExp.indexOf('cn(') === 0;\r\n\r\n                if (isCn) {\r\n                    sCalcExp = sCalcExp.substring(3, sCalcExp.length - 1);\r\n                }\r\n\r\n                var sModel = $(this).attr('ng-model');\r\n                var sDigits = $(this).attr('digits');\r\n                var arrEleBinds = [];\r\n                var curEleBind = '';\r\n                var sNewCalcExp = '';\r\n\r\n                for (var i = 0; i < sCalcExp.length; i++) {\r\n                    if (arrCalcOpers.containsObj(sCalcExp[i]) || i === sCalcExp.length - 1) {\r\n                        if (curEleBind != '') {\r\n                            if (i === sCalcExp.length - 1) {\r\n                                curEleBind += sCalcExp[i];\r\n                            }\r\n\r\n                            arrEleBinds.push(curEleBind);\r\n                            curEleBind = '';\r\n                        }\r\n\r\n                        sNewCalcExp += sCalcExp[i];\r\n\r\n                        if (i < sCalcExp.length - 1 && !arrCalcOpers.containsObj(sCalcExp[i + 1]) &&\r\n                            (sCalcExp[i + 1] < '0' || sCalcExp[i + 1] > '9')) {\r\n                            sNewCalcExp += 'GM.Form.formScope.';\r\n                        }\r\n                    } else {\r\n                        if (i === 0 && (sCalcExp[i] < '0' || sCalcExp[i] > '9')) {\r\n                            sNewCalcExp = 'GM.Form.formScope.';\r\n                        }\r\n\r\n                        curEleBind += sCalcExp[i];\r\n                        sNewCalcExp += sCalcExp[i];\r\n                    }\r\n                }\r\n\r\n                for (var i = 0; i < arrEleBinds.length; i++) {\r\n                    scope.$watch(arrEleBinds[i], function () {\r\n                        var curVal;\r\n                        var curSign = '';\r\n                        var sLastExp = '';\r\n                        var isString = false;\r\n\r\n                        for (var uu = 0; uu < sNewCalcExp.length; uu++) {\r\n                            if (arrCalcOpers.containsObj(sNewCalcExp[uu]) || uu === sNewCalcExp.length - 1) {\r\n                                if (uu === sNewCalcExp.length - 1) {\r\n                                    curSign += sNewCalcExp[uu];\r\n                                }\r\n\r\n                                if (curSign != '') {\r\n                                    try {\r\n                                        curVal = eval(curSign);\r\n                                    } catch (e) {\r\n                                        curVal = undefined;\r\n                                    }\r\n\r\n                                    var vLastOper = uu === sNewCalcExp.length - 1 ? '' : sNewCalcExp[uu];\r\n\r\n                                    if (curVal) {\r\n                                        if (!isNaN(curVal)) {\r\n                                            sLastExp += parseFloat(curVal).toFixed(6) + vLastOper;\r\n                                        } else {\r\n                                            sLastExp += curVal;\r\n\r\n                                            if (isString === false) { isString = true; }\r\n                                        }\r\n                                    } else {\r\n                                        sLastExp += '0' + vLastOper;\r\n                                    }\r\n\r\n                                    curSign = '';\r\n                                } else {\r\n                                    sLastExp += sNewCalcExp[uu];\r\n                                }\r\n                            } else {\r\n                                curSign += sNewCalcExp[uu];\r\n                            }\r\n                        }\r\n\r\n                        try {\r\n                            if (isString === true) {\r\n                                GM.Form.CommonOper.setObjectAttrVal(scope, sModel, 0, sLastExp);\r\n                            } else {\r\n                                if (sDigits && sDigits != '') {\r\n                                    sLastExp = '(' + sLastExp + ').toFixed(' + sDigits + ').trimNumber()';\r\n                                }\r\n\r\n                                if (isCn) {\r\n                                    eval('GM.Form.formScope.' + sModel + \"='\" + formCommonOper.getCnFormatMoney(eval(sLastExp)) + \"'\");\r\n                                } else {\r\n                                    try {\r\n                                        var vCalResult = eval(sLastExp);\r\n\r\n                                        if (vCalResult == 'NaN') {\r\n                                            vCalResult = '';\r\n                                        }\r\n\r\n                                        GM.Form.CommonOper.setObjectAttrVal(scope, sModel, 0, vCalResult);\r\n                                    } catch (e) {}\r\n                                }\r\n                            }\r\n                        } catch (ee) {}\r\n                    });\r\n                }\r\n            });\r\n        }\r\n    },\r\n    _cbCheck: function (scope, e, a, b) {\r\n        if (!b || b == '') {\r\n            return;\r\n        }\r\n\r\n        var bChecked = angular.element(e.target).prop('checked');\r\n\r\n        var arr = a.split('.');\r\n        var obj = scope;\r\n\r\n        for (var i = 0; i < arr.length; i++) {\r\n            if (bChecked && !obj[arr[i]]) {\r\n                obj[arr[i]] = (i < arr.length - 1) ? {} : b;\r\n            } else {\r\n                if (i == arr.length - 1) {\r\n                    var result = obj[arr[i]].split(',');\r\n\r\n                    if (bChecked && !GM.CommonOper.isArrayContainsEle(result, b)) {\r\n                        result.push(b);\r\n                    } else if (!bChecked && GM.CommonOper.isArrayContainsEle(result, b)) {\r\n                        GM.CommonOper.removeItemFromArray(result, b);\r\n                    }\r\n\r\n                    obj[arr[i]] = result.join(',');\r\n                }\r\n            }\r\n\r\n            obj = obj[arr[i]];\r\n        }\r\n    },\r\n    /**\r\n     * 表单在页面渲染之后执行的操作\r\n     *\r\n     * @param {Object} scope\r\n     */\r\n    _formLoaded: function (scope) {\r\n        //初始化表单上各个数据列表的表头\r\n        var arrDataGridDataSources = [];\r\n        angular.element('[ui-grid]').each(function () {\r\n            arrDataGridDataSources.push(angular.element(this).attr('ui-grid').replace('Option', ''));\r\n        });\r\n\r\n        GM.Form.FormData._initOptions(scope, arrDataGridDataSources);\r\n    },\r\n    /**\r\n     * 判断checkbox列表中的单个checkbox是否被选中\r\n     *\r\n     * @param {String} a\r\n     * @param {String} b\r\n     */\r\n    _isCheckBoxChecked: function (scope, a, b) {\r\n        if (!a || a == '' || !b || b == '') {\r\n            return false;\r\n        }\r\n\r\n        var arr = a.split('.');\r\n        var obj = scope;\r\n\r\n        for (var i = 0; i < arr.length; i++) {\r\n            if (!obj[arr[i]]) {\r\n                return false;\r\n            }\r\n\r\n            obj = obj[arr[i]];\r\n        }\r\n\r\n        if (!obj || obj == '') {\r\n            return false;\r\n        }\r\n\r\n        var arrVals = obj.split(',');\r\n        return GM.CommonOper.isArrayContainsEle(arrVals, b);\r\n    },\r\n    /**\r\n     * 在表单框架内弹出对话框\r\n     * @param {String} scope    父scope\r\n     * @param {String} url      对话框内表单的URL\r\n     * @param {String} formid   对话框内表单的ID\r\n     */\r\n    _showFormDialog: function (scope, url, formid, name, buttons) {\r\n        var dialogPara = {\r\n            formid: formid,\r\n            buttons: buttons\r\n        };\r\n\r\n        scope.dialogParameter = dialogPara;\r\n\r\n        if (!scope.initedDlgFormIds) {\r\n            scope.initedDlgFormIds = [];\r\n        }\r\n\r\n        if (!GM.CommonOper.isArrayContainsEle(scope.initedDlgFormIds, formid)) {\r\n            scope.initDataGridOptions(formid);\r\n        } else {\r\n            scope.initedDlgFormIds.push(formid);\r\n        }\r\n\r\n        if (!scope.formInfos) {\r\n            scope.formInfos = [];\r\n        }\r\n\r\n        if (!url) {\r\n            for (var i = 0; i < scope.formInfos.length; i++) {\r\n                if (scope.formInfos[i].formid == formid) {\r\n                    url = scope.formInfos[i].url;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (!url) {\r\n                GM.Form.CommonOper.syncAjaxGet(window.FORM_REST_URL.workflow.getFormInfoById + '?formid=' + formid, function (res) {\r\n                    if (res.success === true && res.data) {\r\n                        url = 'views/forms/' + res.data.dir;\r\n                        scope.formInfos.push({\r\n                            formid: formid,\r\n                            url: url\r\n                        });\r\n                    }\r\n                }, function (res) {});\r\n            }\r\n        }\r\n\r\n        Dialog = GM.Form.ngDialog.open({\r\n            template: url,\r\n            scope: scope\r\n        });\r\n    },\r\n    /**\r\n     * 打印\r\n     * @param {String} param    打印参数（默认案卷编号）\r\n     * @param {String} code     FastReport模板在WCF配置中对应的code\r\n     * @param {String} appId    业务系统ID\r\n     */\r\n    _print: function (param, code, appId) {\r\n        var params = {\r\n            code: code,\r\n            appid: appId,\r\n            param: param\r\n        };\r\n\r\n        var url = FORM_REST_URL.workflow.print;\r\n\r\n        GM.Form.restful.post(url, params).then(function (res) {\r\n            if (res.success === true && res.data) {\r\n                var results = res.data.split(';');\r\n\r\n                for (var i = 0; i < results.length; i++) {\r\n                    if (results[i] !== '') {\r\n                        var r = results[i].replace(/\\\\/g, '/');\r\n\r\n                        if (r.indexOf('./') === 0) {\r\n                            r = r.substring(1, r.length);\r\n                        } else if (r.indexOf('/') !== 0) {\r\n                            r = '/' + r;\r\n                        }\r\n\r\n                        top.window.open(FORM_REST_URL.workflow.printResultUrl + r);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    },\r\n    _treeConfig: function (scope, node) {\r\n        scope.treeFormKey = pNode.formid + ';' + pNode.sxh + ';' + pNode.subtype;\r\n    },\r\n    _clickEvent: function (validScope, name) {\r\n        var _this = this;\r\n        var names = name.split(',');\r\n\r\n        if (name == 'goBack') {\r\n            _this._doClick(names);\r\n        } else {\r\n            top.GM.LayoutOper.validateForm(GM.Form.validationObject, validScope.allForms, function () {\r\n                GM.Form.formScope.settings.formValid = true;\r\n                _this._doClick(names);\r\n            }, function () {\r\n                GM.Form.formScope.settings.formValid = false;\r\n                GM.Form.CommonOper.showFailureMsg('表单验证不通过，请先根据页面提示进行修改');\r\n            });\r\n        }\r\n    },\r\n    _doClick: function (names) {\r\n        if (names.length === 0) {\r\n            return;\r\n        }\r\n\r\n        eval('GM.Form.formScope.' + names[0] + '()');\r\n        names.splice(0, 1);\r\n        this._doClick(names);\r\n    },\r\n    _pushFormId: function (formid) {\r\n        GM.CommonOper.addUniqueEle(GM.Form.parameters.formIds, formid);\r\n    },\r\n    _pushSavingFormId: function (formid) {\r\n        GM.CommonOper.addUniqueEle(GM.Form.parameters.savingFormIds, formid);\r\n    },\r\n    _getPages: function (tabs) {\r\n        var pages = [];\r\n        this._retrievePages(pages, tabs);\r\n        return pages;\r\n    },\r\n    _retrievePages: function (pages, tabs) {\r\n        for (var kk = 0; kk < tabs.length; kk++) {\r\n            if (tabs[kk].children) {\r\n                this._retrievePages(pages, tabs[kk].children);\r\n            } else {\r\n                if (!!tabs[kk].formid && tabs[kk].formid != 'map') {\r\n                    this._pushFormId(tabs[kk].formid);\r\n\r\n                    if (tabs[kk].save === true || GM.LayoutOper.getParamsValue(tabs[kk].url, 'readonly') == 'true') {\r\n                        this._pushSavingFormId(tabs[kk].formid);\r\n                    }\r\n                }\r\n\r\n                pages.push(tabs[kk]);\r\n            }\r\n        }\r\n    },\r\n    _getLayoutUrl: function (pstyle) {\r\n        pstyle = pstyle || 'tab';\r\n\r\n        if (pstyle.indexOf('url:') === 0) {\r\n            return pstyle.substring(4, pstyle.length);\r\n        }\r\n\r\n        return STATIC_RESOURCES_PATH + 'core-views/layout/' + pstyle + '.html';\r\n    },\r\n    _loadPage: function () {\r\n        var _this = this;\r\n        GM.Form.Workflow.init();\r\n\r\n        if (GM.Form.parameters.urlParams.formid) {\r\n            GM.Form.formScope.settings.layoutUrl = _this._getLayoutUrl('raw');\r\n            _this._pushFormId(GM.Form.parameters.urlParams.formid);\r\n            GM.Form.parameters.dataLoaded = true;\r\n        } else {\r\n            var sIndexJsonUrl;\r\n\r\n            //获取节点定义json文件路径\r\n            if (!GM.Form.formScope.taskInfo.bizKey) {\r\n                sIndexJsonUrl = 'views/' + GM.Form.parameters.urlParams.processKey + '/起草.json';\r\n                GM.Form.formScope.settings.showBottom = true;\r\n            } else {\r\n                GM.Form.formScope.settings.topUrl = STATIC_RESOURCES_PATH + 'core-views/layout/top.html';\r\n                sIndexJsonUrl = 'views/' + GM.Form.formScope.taskInfo.processKey + '/' + GM.Form.formScope.taskInfo.taskKey + '.json';\r\n                GM.Form.formScope.settings.showBottom = GM.Form.formScope.taskInfo.name != '查看';\r\n            }\r\n\r\n            GM.Form.CommonOper.syncAjaxGet(sIndexJsonUrl, function (res) {\r\n                GM.Form.formScope.settings.layoutUrl = _this._getLayoutUrl(res.style ? res.style : 'raw');\r\n                GM.Form.formScope.settings.tabs = res.tabs;\r\n                GM.Form.formScope.settings.forms = _this._getPages(res.tabs);\r\n                GM.Form.formScope.settings.buttons = res.buttons;\r\n                GM.Form.formScope.settings.prints = res.prints;\r\n                GM.Form.formScope.settings.loadWebGIS = !!res.webgis;\r\n\r\n                if (GM.Form.formScope.settings.forms && GM.Form.formScope.settings.forms.length > 0) {\r\n                    for (var i = 0; i < GM.Form.formScope.settings.forms.length; i++) {\r\n                        if (GM.Form.formScope.settings.forms[i].formid) {\r\n                            _this._pushFormId(GM.Form.formScope.settings.forms[i].formid);\r\n\r\n                            if (GM.Form.formScope.settings.forms[i].save === true) {\r\n                                _this._pushSavingFormId(GM.Form.formScope.settings.forms[i].formid);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }, function (res) {});\r\n        }\r\n    }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/base/form-engine.js","window.formWebgis = {\r\n    init: function () {\r\n        GM.Form.formScope.graphStat = {};\r\n    },\r\n    savePlots: function (ywh, payload, asDraft) {\r\n        var strData = JSON.stringify(payload);\r\n        var saveData = {\r\n            ywh: ywh,\r\n            strParams: strData,\r\n            asDraft: asDraft === true ? '1' : '0'\r\n        };\r\n\r\n        return GM.Form.restful.post(RESTURL.graph.savePlots, null, saveData);\r\n    },\r\n    saveGraphStatics: function () {\r\n        if (!GM.Form.parameters.saveLayerName) {\r\n            return;\r\n        }\r\n\r\n        var polygon = [],\r\n            savePolygon = [];\r\n        var param = {\r\n            layerName: GM.Form.parameters.saveLayerName\r\n        };\r\n\r\n        var status = false;\r\n        var strObjectName = null;\r\n\r\n        if (GM.Form.formScope.graphStat.hasOwnProperty('polygon')) {\r\n            polygon = GM.Form.formScope.graphStat.polygon;\r\n            status = GM.GIS.ExternalApi.saveJXPolygons(polygon, GM.Form.formScope);\r\n            strObjectName = GM.GIS.ExternalApi.getJhObjectIDName();\r\n        }\r\n\r\n        if (status === false) {\r\n            return false;\r\n        }\r\n\r\n        if (GM.Form.formScope.graphStat.statistics) {\r\n            param.statistics = GM.Form.formScope.graphStat.statistics;\r\n        }\r\n\r\n        for (var p = 0; p < polygon.length; p++) {\r\n            var vObjectId = (polygon[p].feature && polygon[p].feature.get(strObjectName))\r\n                ? polygon[p].feature.get(strObjectName) : undefined;\r\n\r\n            vObjectId = (vObjectId && vObjectId != '') ? vObjectId : polygon[p].objectid;\r\n\r\n            savePolygon.push({\r\n                polygonNum: polygon[p].polygonNum,\r\n                area: polygon[p].area,\r\n                name: polygon[p].name,\r\n                strGeom: polygon[p].strGeom,\r\n                objectid: vObjectId\r\n            });\r\n        }\r\n\r\n        param.polygon = savePolygon;\r\n        GM.Form.formScope.saveGraphParam = param;\r\n\r\n        return true;\r\n    }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/base/form-webgis.js","import 'formCommonApi';\r\nimport 'agencyService';\r\n\r\nGM.Form.Workflow = {\r\n    init: function () {\r\n        var _this = this;\r\n\r\n        GM.Form.formScope.taskInfo = {\r\n            bizKey: GM.Form.parameters.urlParams.ywh,\r\n            draftBizKey: GM.Form.parameters.urlParams.did || GM.Form.parameters.urlParams.duuid, //草稿业务号\r\n            processDefId: GM.Form.parameters.urlParams.processDefId,\r\n            processKey: GM.Form.parameters.urlParams.processKey, //流程标识\r\n            processName: GM.Form.parameters.urlParams.processName,\r\n            taskKey: GM.Form.parameters.urlParams.taskKey, //节点名称\r\n            isClaimed: false, //是否已被签收\r\n            bizName: GM.Form.parameters.urlParams.caseTitle, //业务名称\r\n            startTime: undefined, //接收时间\r\n            forbid: false, //是否已被禁止\r\n            boxName: (GM.Form.parameters.urlParams.box || 'agency')\r\n        }; //当前节点信息\r\n\r\n        GM.Form.formScope.handOver = function () {\r\n            Dialog = GM.Form.ngDialog.open({\r\n                template: STATIC_RESOURCES_PATH + 'core-views/handOver.html',\r\n                scope: GM.Form.formScope\r\n            });\r\n        };\r\n\r\n        GM.Form.formScope.startProcessAndHandOver = function () {\r\n            GM.Form.formScope.startProcess(true, true);\r\n        };\r\n\r\n        GM.Form.formScope.startProcess = function (autoHandOver, notTurnToFirst) {\r\n            var ctrlCaseTitle = $(\"[data-role='bizname']\");\r\n\r\n            if (!ctrlCaseTitle || ctrlCaseTitle.length === 0) {\r\n                GM.Form.CommonOper.showFailureMsg('缺少用于案卷标题的控件！');\r\n                return;\r\n            }\r\n\r\n            ctrlCaseTitle = ctrlCaseTitle.val();\r\n\r\n            if (!ctrlCaseTitle || ctrlCaseTitle == '') {\r\n                GM.Form.CommonOper.showFailureMsg('案卷标题不能为空！');\r\n                return;\r\n            }\r\n\r\n            var param = {\r\n                appId: GM.Form.parameters.appId,\r\n                userId: GM.Form.parameters.userInfo.loginName,\r\n                processDefId: GM.Form.parameters.urlParams.processDefId,\r\n                title: ctrlCaseTitle\r\n            };\r\n\r\n            if (GM.Form.formScope.taskInfo.draftBizKey) {\r\n                param.draftKey = GM.Form.formScope.taskInfo.draftBizKey;\r\n            }\r\n\r\n            //设置业务箱内的附加的业务数据\r\n            var ctrlExtraBizDatas = angular.element(\"[data-role='biz-data']\");\r\n            var extraBizData;\r\n\r\n            if (ctrlExtraBizDatas.length > 0) {\r\n                for (var y = 0; y < ctrlExtraBizDatas.length; y++) {\r\n                    var sModel = $(ctrlExtraBizDatas[y].attr('ng-model'));\r\n\r\n                    if (sModel) {\r\n                        var arr = sModel.split('.');\r\n\r\n                        if (arr.length > 0) {\r\n                            if (!extraBizData) {\r\n                                extraBizData = {};\r\n                            }\r\n\r\n                            extraBizData[arr[arr.length - 1]] = eval('GM.Form.formScope.' + sModel);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (extraBizData) {\r\n                param.extraBizData = extraBizData;\r\n            }\r\n\r\n            _this._startProcess(param).then(function (res) {\r\n                if (res.success === true) {\r\n                    //保存数据\r\n                    GM.Form.parameters.urlParams.ywh = res.data.bizKey;\r\n                    GM.Form.formScope.taskInfo.taskKey = res.data.currentTaskId;\r\n                    GM.Form.formScope.taskInfo.bizKey = res.data.bizKey;\r\n                    GM.Form.formScope.taskInfo.bizName = res.data.caseTitle;\r\n                    GM.Form.formScope.taskInfo.startTime = res.data.startTime;\r\n                    GM.Form.formScope.taskInfo.isClaimed = true;\r\n\r\n                    if (autoHandOver === true) {\r\n                        GM.Form.formScope.saveAndHandOver();\r\n                    } else {\r\n                        GM.Form.formScope.save();\r\n                    }\r\n\r\n                    _this.saveBizFlowInfo('', res.data.bizKey);\r\n                    if (!notTurnToFirst) {\r\n                        let str = '';\r\n                        for (var key in GM.Form.parameters.urlParams) {\r\n                            str += '&' + key + '=' + GM.Form.parameters.urlParams[key];\r\n                        }\r\n                        window.location = str.replace(/&/, '?') + '&taskKey=' + GM.Form.formScope.taskInfo.taskKey;\r\n                    }\r\n                }\r\n            }, function (res) {});\r\n        };\r\n\r\n        //签收或放弃签收\r\n        GM.Form.formScope.claimOrUnclaim = function (status) {\r\n            var alertMessage, myUrl, erroeMessage;\r\n            if (status === 'claim') {\r\n                alertMessage = '确认签收？';\r\n                myUrl = FORM_REST_URL.workflow.claimTask;\r\n                erroeMessage = '签收失败';\r\n            } else {\r\n                alertMessage = '确认放弃？';\r\n                myUrl = FORM_REST_URL.workflow.unclaimTask;\r\n                erroeMessage = '放弃签收失败';\r\n            }\r\n            GM.Alert.show(alertMessage, '', null, function () {\r\n                GM.Form.restful.post(myUrl, null, {\r\n                    bizKey: GM.Form.formScope.taskInfo.bizKey,\r\n                    taskKey: GM.Form.formScope.taskInfo.taskKey,\r\n                    userId: GM.Form.parameters.userInfo.id\r\n                }).then(function (res) {\r\n                    if (res.success) {\r\n                        let str = '';\r\n                        for (var key in GM.Form.parameters.urlParams) {\r\n                            str += '&' + key + '=' + GM.Form.parameters.urlParams[key];\r\n                        }\r\n                        window.location = str.replace(/&/, '?') + '&taskKey=' + GM.Form.formScope.taskInfo.taskKey;\r\n                    } else {\r\n                        GM.Infomation.show(erroeMessage, {\r\n                            type: 'warning'\r\n                        });\r\n                    }\r\n                }, function (error) {\r\n                    GM.Infomation.show(error, {\r\n                        type: 'warning'\r\n                    });\r\n                });\r\n            });\r\n        };\r\n        //查看流程图\r\n        GM.Form.formScope.showWfGraph = function () {\r\n            GM.Form.formScope.blankTitle = '流程图';\r\n            GM.Form.formScope.htmlContent = '<img src=\"' + FORM_REST_URL.workflow.getHighLightTask + '?bizKey=' + GM.Form.formScope.taskInfo.bizKey + '\" style=\"margin-top:30px;\"/>';\r\n            //GM.Form.formScope.htmlContent = '<img src=\"http://192.168.5.27:8080/activiti-web/usertask/getHighLightTask?bizKey=Z201803230005\"/>';\r\n            Dialog = GM.Form.ngDialog.open({\r\n                template: STATIC_RESOURCES_PATH + 'core-views/model/blank.html',\r\n                scope: GM.Form.formScope\r\n            });\r\n        };\r\n\r\n        this._isTaskClaimed();\r\n        this._initBizFlowDetails();\r\n    },\r\n    _initBizFlowDetails: function () {\r\n        var _this = this;\r\n        //流转详情\r\n        GM.Form.formScope.pendingPageLz = {\r\n            currentPage: 1\r\n        };\r\n\r\n        GM.Form.formScope.$watch('pendingPageLz.currentPage', function () {\r\n            if (GM.Form.formScope.pendingPageLz.currentPage > 0) {\r\n                _this._getLzData();\r\n            }\r\n        });\r\n\r\n        //表格\r\n        GM.Form.formScope.lzGridOptions = {};\r\n\r\n        //定义操作\r\n        var strCellTemplate = '<span style=\"display:block;padding:5px;color:#3280fc\">正常</span>';\r\n\r\n        GM.Form.formScope.lzGridOptions.columnDefs = [{\r\n            name: 'taskKey',\r\n            displayName: '当前环节',\r\n            enableColumnMenu: false,\r\n            cellTooltip: true\r\n        },\r\n        {\r\n            name: 'assigneeName',\r\n            displayName: '办理人员',\r\n            enableColumnMenu: false,\r\n            cellTooltip: true\r\n        },\r\n        {\r\n            name: 'previousTaskKey',\r\n            displayName: '前一环节',\r\n            enableColumnMenu: false,\r\n            cellTooltip: true\r\n        },\r\n        {\r\n            name: 'submitterName',\r\n            displayName: '发件人员',\r\n            enableColumnMenu: false,\r\n            cellTooltip: true\r\n        },\r\n        {\r\n            name: 'startTime',\r\n            displayName: '接收时间',\r\n            enableColumnMenu: false,\r\n            cellTooltip: true\r\n        },\r\n        {\r\n            name: 'completeTime',\r\n            displayName: '转送时间',\r\n            enableColumnMenu: false,\r\n            cellTooltip: true\r\n        },\r\n        {\r\n            name: 'yj',\r\n            displayName: '预警',\r\n            enableColumnMenu: false,\r\n            cellTemplate: strCellTemplate\r\n        }\r\n        ];\r\n\r\n        //显示流转详情\r\n        GM.Form.formScope.showLzDialog = function () {\r\n            //打开弹出框\r\n            Dialog = GM.Form.ngDialog.open({\r\n                template: STATIC_RESOURCES_PATH + 'core-views/model/liuzhuan-modal.html',\r\n                scope: GM.Form.formScope,\r\n                className: 'ngdialog-theme-default custom' //不添加这个属性就是大对话框\r\n            });\r\n\r\n            //获取流转详情数据\r\n            _this._getLzData();\r\n        };\r\n\r\n        //查看图形\r\n        GM.Form.formScope.viewMap = function () {\r\n            var strDyh = GM.Form.formScope.result.zrzyjbxx.ZRZYDJDYH;\r\n            var strUrl = GM.LayoutOper.addURLParam(ONEMAP_PATH, 'ProjectType', 'zrzy');\r\n            strUrl = GM.LayoutOper.addURLParam(strUrl, 'ZRZYDJDYH', strDyh);\r\n            GM.FullModal.show('地图', strUrl);\r\n        };\r\n\r\n        //关闭弹出框\r\n        GM.Form.formScope.closeDialog = function () {\r\n            Dialog.close();\r\n        };\r\n    },\r\n    _getLzData: function () {\r\n        var url = window.FORM_REST_URL.workflow.getTaskTrackPage + '?current=' + GM.Form.formScope.pendingPageLz.currentPage + '&orderField=START_TIME&bizKey=' + GM.Form.formScope.taskInfo.bizKey;\r\n        GM.Form.restful.get(url, function (response) {\r\n            if (response.success === true) {\r\n                var dbData = response.data.records;\r\n\r\n                angular.forEach(dbData, function (item, index) {\r\n                    item.index = index + 1;\r\n                    item.startTime = GM.Form.filter('date')(item.startTime, 'yyyy-MM-dd HH:mm:ss');\r\n                    item.completeTime = GM.Form.filter('date')(item.completeTime, 'yyyy-MM-dd HH:mm:ss');\r\n                });\r\n\r\n                GM.Form.formScope.pendingPageLz.totalItems = response.data.total;\r\n                GM.Form.formScope.lzGridOptions.data = response.data.records;\r\n            }\r\n        }, function (res) {});\r\n    },\r\n    _isTaskClaimed: function () {\r\n        var url = FORM_REST_URL.workflow.isClaimed + '?bizKey=' + GM.Form.formScope.taskInfo.bizKey + '&taskkey=' + encodeURIComponent(GM.Form.formScope.taskInfo.name);\r\n        GM.Form.restful.get(url, null).then(function (response) {\r\n            GM.Form.formScope.taskInfo.isClaimed = response.success === true;\r\n        }, function (response) {});\r\n    },\r\n    _startProcess: function (param) {\r\n        return GM.Form.restful.get(FORM_REST_URL.workflow.startProcess, param);\r\n    },\r\n    saveBizFlowInfo: function (id, bizKey) {\r\n        GM.Form.restful.get(GM.Form.parameters.servers.updateBizFlowInfoServer + '?bizKey=' + bizKey + '&id=' + id).then(function (res) {}, function (res) {});\r\n    }\r\n};\r\n\r\nwindow.workflowCore = {\r\n\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/base/workflow.js","//定义表单通用配置\r\nwindow.FORM_SERVER_URLS = {};\r\n\r\nwindow.FORM_REST_URL = {\r\n    form: {\r\n        getHandOverVarServer: 'getHandOverVariables',\r\n        getDataServer: 'getData',\r\n        saveDataServer: 'saveData',\r\n        getSingleDataGridServer: 'getSingleDataGrid',\r\n        updateBizFlowInfoServer: 'updateBizFlowInfo'\r\n    },\r\n    workflow: {\r\n        isClaimed: ACTIVITI_SERVER + '/usertask/isTaskClaimed',\r\n        claimTask: ACTIVITI_SERVER + '/usertask/claimTask',\r\n        unclaimTask: ACTIVITI_SERVER + '/usertask/unclaimTask',\r\n        getHighLightTask: ACTIVITI_SERVER + '/usertask/getHighLightTask',\r\n        startProcess: ACTIVITI_SERVER + '/usertask/startProcess',\r\n        saveDataAsDraft: ACTIVITI_SERVER + '/usertask/saveDataAsDraft',\r\n        getDraftData: ACTIVITI_SERVER + '/usertask/getDraftData',\r\n        saveDraftInfo: ACTIVITI_SERVER + '/tdzz/saveDraftInfo',\r\n        getDrafts: ACTIVITI_SERVER + '/tdzz/getDrafts',\r\n        getRegionTree: ACTIVITI_SERVER + '/work/getRegionTree',\r\n        getBizInfo: ACTIVITI_SERVER + '/usertask/getProcessInstance',\r\n        getHandOverTarget: ACTIVITI_SERVER + '/usertask/getNextTasks',\r\n        handOver: ACTIVITI_SERVER + '/usertask/handOver',\r\n        getUUID: ACTIVITI_SERVER + '/usertask/getUUID',\r\n        print: ACTIVITI_SERVER + '/bizconfig/print',\r\n        getRedisString: ACTIVITI_SERVER + '/userdraft/getRedisString',\r\n        removeRedisString: ACTIVITI_SERVER + '/userdraft/removeRedisString',\r\n        redisString: ACTIVITI_SERVER + '/userdraft/redisString',\r\n        getTaskTrackPage: ACTIVITI_SERVER + '/usertask/getTaskTrackPage',\r\n        getDataGridDataSourceNames: ACTIVITI_SERVER + '/form/getDataGridDataSourceNames',\r\n        getFormInfoById: ACTIVITI_SERVER + '/form/getFormInfoById',\r\n        getProcessInstanceByBizKey: ACTIVITI_SERVER + '/usertask/getProcessInstanceByBizKey',\r\n        printResultUrl: 'http://192.168.5.222:8088/ftpdirectory'\r\n    }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/config.js","import 'fileService';\r\n\r\nangular.module('frameApp').controller('fileCtrl', ['$scope', '$location', '$fileService', '$captureService', 'ngDialog', '$validation',\r\n    function ($scope, $location, $fileService, $captureService, ngDialog, $validation) {\r\n        var urlParams = formBase.getUrlParamters($location.absUrl());\r\n        //业务号\r\n        var strYwh = urlParams.ywh;\r\n        //节点名称\r\n        var strStepName = urlParams.blbz;\r\n        //是否签收\r\n        var bCliam = true;\r\n\r\n        $scope.fileTreeConfig = {\r\n            activeNode: 'activeNode',\r\n            name: 'filename'\r\n        };\r\n\r\n        //点击节点\r\n        $scope.activeNode = function (pNode) {\r\n            if (pNode != null) {\r\n                if (pNode.processDefId != null) {\r\n                    //文件夹点击\r\n                    $scope.activeFolder = true;\r\n                } else {\r\n                    //文件点击\r\n                    $scope.activeFolder = false;\r\n                }\r\n            }\r\n            $scope.pActiveNode = pNode;\r\n        };\r\n\r\n        //上传材料\r\n        $scope.uploadFile = function () {\r\n            $('#file_upload').click();\r\n            $('#file_upload').unbind().change(function () {\r\n                var formData = new FormData();\r\n                formData.append('multipartFile', this.files[0]);\r\n                //formData.append(\"ywh\", strYwh);\r\n                formData.append('id', $scope.pActiveNode.id);\r\n                formData.append('dir', strYwh + '\\\\' + $scope.pActiveNode.filename);\r\n                formData.append('isDraft', (!!urlParams.duuid || !!urlParams.did) ? '1' : '0');\r\n                var response = GM.CommonOper.ajaxRequest(RESTURL.file.uploadFile, formData, {\r\n                    type: 'POST',\r\n                    cache: false,\r\n                    processData: false,\r\n                    contentType: false\r\n                });\r\n                if ($scope.pActiveNode.children == null) {\r\n                    $scope.pActiveNode.children = [];\r\n                }\r\n                if (response.data != null && response.data.children != null && response.data.children.length != 0) {\r\n                    var pData = response.data.children[0];\r\n                    pData.filename = pData.name;\r\n                    //pData.name = pData.fileName;\r\n                    $scope.pActiveNode.children.push(pData);\r\n                    $scope.$apply($scope.pActiveNode);\r\n                    GM.Infomation.show('上传成功！');\r\n                }\r\n                $('#file_upload').val('');\r\n                $scope.fileTree = $fileService.formatTreeData($scope.fileTree, strStepName, bCliam);\r\n            });\r\n        };\r\n\r\n        //编辑材料\r\n        $scope.editFolder = function () {\r\n            $scope.copyFocusItem = angular.copy($scope.pActiveNode);\r\n        };\r\n\r\n        //删除材料\r\n        $scope.deleteFolder = function () {\r\n            GM.Alert.show('提示？', '是否确认删除材料？', {\r\n                showCancelButton: true\r\n            }, function () {\r\n                $fileService.removeFolder($scope.pActiveNode.id).then(function (response) {\r\n                    GM.CommonOper.removeItemFromArray($scope.fileTree, $scope.pActiveNode, 'id');\r\n                    GM.Infomation.show('删除成功！');\r\n                }, function (error) {\r\n                    GM.Infomation.show('删除失败！');\r\n                    $log.error(error);\r\n                });\r\n            });\r\n        };\r\n\r\n        //删除文件\r\n        $scope.deleteFile = function () {\r\n            GM.Alert.show('提示？', '是否确认删除文件？', {\r\n                showCancelButton: true\r\n            }, function () {\r\n                $fileService.removeFile($scope.pActiveNode.id, $scope.pActiveNode.fileId).then(function (response) {\r\n                    GM.TreeOper.removeNode($scope.fileTree, $scope.pActiveNode);\r\n                    GM.Infomation.show('删除成功！');\r\n                }, function (error) {\r\n                    GM.Infomation.show('删除失败！');\r\n                    $log.error(error);\r\n                });\r\n            });\r\n        };\r\n\r\n        //编辑文件\r\n        $scope.editFile = function () {\r\n            $scope.copyFocusItem = angular.copy($scope.pActiveNode);\r\n        };\r\n\r\n        //查看文件\r\n        $scope.viewFile = function () {\r\n            //查看文件\r\n            var strUrl = $scope.pActiveNode.url;\r\n            var strFileType = GM.FilePath.getFileType(strUrl);\r\n            if (strFileType === 'img') {\r\n                $scope.imgUrl = strUrl;\r\n            } else {\r\n                window.open(strUrl);\r\n            }\r\n        };\r\n\r\n        //保存文件\r\n        $scope.saveFile = function () {\r\n            angular.copy($scope.pActiveNode, $scope.copyFocusItem);\r\n            $fileService.saveFile($scope.copyFocusItem).then(function (response) {\r\n                angular.copy($scope.copyFocusItem, $scope.pActiveNode);\r\n                GM.Infomation.show('修改成功！');\r\n                $('#fileModal').modal('hide');\r\n            }, function (error) {\r\n                GM.Infomation.show('修改失败！');\r\n                $log.error(error);\r\n            });\r\n        };\r\n        //新建材料\r\n        $scope.addFolder = function () {\r\n            Dialog = ngDialog.open({\r\n                template: 'folderModal.html',\r\n                scope: $scope\r\n            });\r\n        };\r\n        //关闭弹窗\r\n        $scope.closeDialog = function () {\r\n            if (ngDialog) {\r\n                ngDialog.close();\r\n            }\r\n        };\r\n\r\n        //保存材料\r\n        $scope.saveFolder = function (dislogScope) {\r\n            GM.LayoutOper.validateForm($validation, dislogScope.folderForm, function () {\r\n                $fileService.saveFolder($scope.copyFocusItem).then(function (response) {\r\n                    if ($scope.copyFocusItem.id == null) {\r\n                        //添加\r\n                        $scope.fileTree.push(response.data);\r\n                        GM.Infomation.show('添加成功！');\r\n                    } else {\r\n                        //修改\r\n                        angular.copy($scope.copyFocusItem, $scope.pActiveNode);\r\n                        GM.Infomation.show('修改成功！');\r\n                    }\r\n                    ngDialog.close();\r\n                }, function (error) {\r\n                    if ($scope.focusItem == null) {\r\n                        GM.Infomation.show('添加失败！');\r\n                    } else {\r\n                        GM.Infomation.show('修改失败！');\r\n                    }\r\n                    $log.error(error);\r\n                });\r\n            }, function () {});\r\n        };\r\n\r\n        //扫描文件\r\n        $scope.captureImg = function () {\r\n            $captureService.showCapture($scope);\r\n        };\r\n    }\r\n]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/controllers/file-controller.js","import 'formCoreService';\r\nimport 'formCommonApi';\r\nimport '../directives/tab-components';\r\nimport '../filters/workflow-filter';\r\n\r\nangular.module('frameApp').controller('indexCtrl', ['$scope', '$http', '$gmRestful', function($scope, $http, $gmRestful) {\r\n    GM.token = top.GM.token;\r\n    var pRestful = new $gmRestful();\r\n    GM.FrameManager.prepareData($scope, pRestful);\r\n    //获取所有的数据列表数据源，用于初始化数据列表控件\r\n    var bizKey = GM.LayoutOper.getParamsValue(window.location.href, 'ywh');\r\n    var taskKey = GM.LayoutOper.getParamsValue(window.location.href, 'taskKey');\r\n    var processKey = GM.LayoutOper.getParamsValue(window.location.href, 'processKey');\r\n    var url = 'views/' + processKey + '/' + (bizKey ? taskKey : '起草') + '.json';\r\n\r\n    var setUrl = function() {\r\n        var view = GM.LayoutOper.getParamsValue(window.location.href, 'view');\r\n\r\n        if (view) {\r\n            $scope.subUrl = 'views/' + view + '.html?' + window.location.href.split('?')[1];\r\n        } else {\r\n            $scope.subUrl = STATIC_RESOURCES_PATH + 'core-views/layout/formIndex.html';\r\n        }\r\n    };\r\n\r\n    var loadPage = function(res) {\r\n        var formIds = '';\r\n\r\n        if (res.tabs && res.tabs.length > 0) {\r\n            var formIdList = [];\r\n            for (var i = 0; i < res.tabs.length; i++) {\r\n                formIdList.push(res.tabs[i].formid);\r\n            }\r\n\r\n            formIds = formIdList.join(',');\r\n        }\r\n        //存储起草时需要用到的formid\r\n        $scope.formIds = formIds;\r\n        if (formIds) {\r\n            $http.get(window.FORM_REST_URL.workflow.getDataGridDataSourceNames + '?formids=' + formIds).then(function(res) {\r\n                if (res.data.success === true) {\r\n                    GM.Form.parameters.formDataSourceNames = res.data.data;\r\n                }\r\n\r\n                setUrl();\r\n            }, function(res) {\r\n                console.log(res);\r\n            });\r\n        } else {\r\n            var view = GM.LayoutOper.getParamsValue(window.location.href, 'view');\r\n\r\n            setUrl();\r\n        }\r\n    };\r\n    //只查看业务详情\r\n    if (!!bizKey && !taskKey && !processKey) {\r\n        var getInfoUrl = window.FORM_REST_URL.workflow.getProcessInstanceByBizKey + '?bizKey=' + encodeURIComponent(bizKey);\r\n        var box = GM.LayoutOper.getParamsValue(window.location.href, 'box');\r\n\r\n        GM.Form.CommonOper.syncAjaxGet(getInfoUrl, function(r) {\r\n            if (r && r.success === true && r.data) {\r\n                var res = r.data;\r\n                if (res.processDef && res.processDef.processDefinitionId) {\r\n                    processKey = res.processDef.processDefinitionId.split(':')[0];\r\n                    getInfoUrl = 'index.html?appId=' + GM.AppInfo.id + '&serviceAppKey=' + res.processDef.serviceAppKey +\r\n                        '&box=' + box + '&ywh=' + bizKey + '&processKey=' + processKey +\r\n                        '&processDefId=' + encodeURIComponent(res.processDef.processDefinitionId) + '&taskKey=' + encodeURIComponent('查看') +\r\n                        '&processName=' + encodeURIComponent(res.processDef.processName) + '&caseTitle=' + encodeURIComponent(res.caseTitle);\r\n                    window.location = getInfoUrl;\r\n                }\r\n            }\r\n        }, function(res) {\r\n            document.write('无法获取业务详情。');\r\n        });\r\n    } else {\r\n        GM.Form.CommonOper.syncAjaxGet(url, function(res) {\r\n            loadPage(res);\r\n        }, function(res) {});\r\n    }\r\n    $scope.closeDlg = function() {\r\n        $('button.close[data-dismiss]', window.parent.document).click();\r\n    };\r\n}]);\r\nangular.module('frameApp').controller('formCtrl', ['$scope', '$http', '$location', '$timeout', '$formCoreService', '$rootScope', '$filter', 'ngDialog', '$validation', '$gmTable',\r\n    function($scope, $http, $location, $timeout, $formCoreService, $rootScope, $filter, ngDialog, $validation, $gmTable) {\r\n        //处理加载的子页面的状态\r\n        $scope.$on('$includeContentLoaded', function(angularEvent, src) {\r\n            var pParams = GM.LayoutOper.getURLParams(src);\r\n            angularEvent.targetScope.readonly = pParams.readonly === 'true';\r\n        });\r\n\r\n        $formCoreService.loadPage($scope, $validation, $filter, ngDialog, $gmTable, $timeout);\r\n    }\r\n]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/controllers/form-controller.js","import 'handOverService';\r\n\r\nangular.module('frameApp').controller('handOverCtrl', ['$scope', '$handOverService',\r\n    function ($scope, $handOverService) {\r\n        $handOverService.loadPage($scope);\r\n    }\r\n]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/controllers/handover-controller.js","angular.module('frameApp').directive('tabTop', function () {\r\n    return {\r\n        restrict: 'EAC',\r\n        template: '<div class=\"form-top-div clearfix\"><div class=\"form-top-left pull-left\"><div ng-if=\"!taskInfo.forbid\"><h3>项目类型：{{taskInfo.processName}}&nbsp;&nbsp;&nbsp;当前节点：{{taskInfo.taskKey}}</h3>流程状态：<span class=\"label\"ng-if=\"!taskInfo.isClaimed\">未签收</span><span class=\"label label-success\"ng-if=\"taskInfo.isClaimed\">已签收</span></div><div ng-if=\"taskInfo.forbid\"><h3>项目类型：{{taskInfo.processName}}</div></div><div class=\"form-top-right pull-right\"ng-init=\"operatList = true\"ng-init=\"print = true\"><div class=\"dropdown\"><i class=\"icon icon-list-ul more\"data-toggle=\"dropdown\"title=\"菜单\"></i><ul class=\"dropdown-menu pull-right\"><li class=\"dropdown\"ng-if=\"!taskInfo.forbid && !taskInfo.isClaimed\"ng-click=\"claim(true);\"><a href=\"javascript:;\">签收</a></li><li class=\"dropdown\"ng-if=\"!taskInfo.forbid && taskInfo.isClaimed\"ng-click=\"claim(false)\"><a href=\"javascript:;\">放弃</a></li><li class=\"divider\"></li><li class=\"dropdown-submenu\"ng-click=\"showWfGraph()\"><a href=\"javascript:;\">流程图</a></li><li class=\"divider\"></li><li class=\"dropdown\"><a href=\"javascript:;\">打印</a><ul class=\"dropdown-menu pull-left\"><li ng-repeat=\"item in printItems\"><a href=\"javascript:;\"ng-click=\"print(item.code)\">{{item.name}}</a></li></ul></li><li class=\"divider\"></li><li class=\"dropdown\"ng-click=\"viewMap()\"><a href=\"javascript:;\">定位</a></li></ul></div></div></div><hr style=\"margin-top: 0\">',\r\n        link: function (scope, element, attr, transclution) {\r\n\r\n        }\r\n    };\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/directives/tab-components.js","angular.module('frameApp').filter('to_trusted', ['$sce', function ($sce) {\r\n    return function (text) {\r\n        return $sce.trustAsHtml(text);\r\n    };\r\n}]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/filters/workflow-filter.js","/**\r\n * @description 收件材料服务\r\n */\r\n//收件材料服务\r\nangular.module('frameApp').factory('$fileService', ['$gmRestful', function ($gmRestful) {\r\n    var result = {\r\n        /**\r\n         * 获取作为草稿的附件材料树\r\n         *\r\n         * @param {String} draftBizKey\r\n         * @param {String} processKey\r\n         * @param {String} subType\r\n         */\r\n        getDraftAttaches: function (draftBizKey, processKey, taskKey, subType) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.get(RESTURL.file.getDraftAttaches, {\r\n                draftBizKey: draftBizKey,\r\n                processKey: processKey,\r\n                taskKey: taskKey,\r\n                subType: subType\r\n            });\r\n            return pPromise;\r\n        },\r\n        getAttachesFromRedis: function (draftBizKey, processKey, taskKey, subType) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.get(RESTURL.file.getAttachesFromRedis, {\r\n                draftBizKey: draftBizKey,\r\n                processKey: processKey,\r\n                taskKey: taskKey,\r\n                subType: subType\r\n            });\r\n            return pPromise;\r\n        },\r\n        /**\r\n         * @description 查询文件目录树\r\n         * @param strYwh\r\n         * @returns {*}\r\n         */\r\n        queryTree: function (strYwh, subType, seqNo) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.get(RESTURL.file.queryTree, {\r\n                ywh: strYwh,\r\n                zlx: subType,\r\n                sxh: seqNo\r\n            });\r\n            return pPromise;\r\n        },\r\n        /**\r\n         * @description 保存材料信息\r\n         * @param folderData\r\n         * @returns {*}\r\n         */\r\n        saveFolder: function (folderData) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.post(RESTURL.file.saveFolder, {}, folderData);\r\n            return pPromise;\r\n        },\r\n        /**\r\n         * @description 删除材料\r\n         * @param strId {String} 材料ID\r\n         */\r\n        removeFolder: function (strId) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.post(RESTURL.file.deleteFolder, {}, {\r\n                id: strId\r\n            });\r\n            return pPromise;\r\n        },\r\n        /**\r\n         * @description 删除文件\r\n         * @param strId\r\n         */\r\n        removeFile: function (strId, strFileId) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.post(RESTURL.file.deleteFile, {}, {\r\n                id: strId,\r\n                fileId: strFileId,\r\n                status: 1\r\n            });\r\n            return pPromise;\r\n        },\r\n        /**\r\n         * @description 保存文件\r\n         * @param fileData\r\n         */\r\n        saveFile: function (fileData) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.post(RESTURL.file.saveFile, {}, fileData);\r\n            return pPromise;\r\n        },\r\n        /**\r\n         * @description 修证树节点数据\r\n         * @param treeNodes {Array} 树节点数据\r\n         * @param strStepName {String} 节点名称\r\n         * @param bCliam {是否签收}\r\n         */\r\n        formatTreeData: function (treeNodes, strStepName, bCliam) {\r\n            if (treeNodes == null) {\r\n                return;\r\n            }\r\n            var arrayNodes = GM.TreeOper.getAllNodes(treeNodes);\r\n            for (var ii = 0; ii < arrayNodes.length; ii++) {\r\n                var pNode = arrayNodes[ii];\r\n                if (pNode.processDefId) {\r\n                    //文件夹节点\r\n                    pNode.parent = true;\r\n                    var bEnable = this._isFileEnable(pNode, strStepName, bCliam);\r\n                    if (bEnable === false) {\r\n                        pNode.nodeType = 'disabled';\r\n                        if (pNode.children != null && pNode.children.length > 0) {\r\n                            for (var jj = 0; jj < pNode.children.length; jj++) {\r\n                                var pItemNode = pNode.children[jj];\r\n                                pItemNode.nodeType = pNode.nodeType;\r\n                            }\r\n                        }\r\n                    } else {\r\n                        //材料是否必须\r\n                        var bNessary = this._isFileNecessary(pNode);\r\n                        if (bNessary === true && (pNode.children == null || pNode.children.length === 0)) {\r\n                            pNode.nodeType = 'error';\r\n                        } else {\r\n                            pNode.nodeType = 'default';\r\n                        }\r\n                    }\r\n                } else {\r\n                    pNode.filename = pNode.name;\r\n                }\r\n            }\r\n            return treeNodes;\r\n        },\r\n        initTree: function (treeScope, bizKey, taskKey, subType, seqNo, urlParams) {\r\n            var _this = this;\r\n            var sSubType = subType || '';\r\n            var sSeqNo = seqNo || '';\r\n\r\n            if (urlParams.duuid) {\r\n                _this.getDraftAttaches(bizKey, urlParams.processid, taskKey, sSubType).then(function (response) {\r\n                    var pTreeNode = _this.formatTreeData(response.data, urlParams.blbz, true);\r\n                    treeScope.fileTree = pTreeNode;\r\n                });\r\n            } else if (urlParams.did) {\r\n                _this.getAttachesFromRedis(bizKey, urlParams.processid, taskKey, sSubType).then(function (response) {\r\n                    var pTreeNode = _this.formatTreeData(response.data, urlParams.blbz, true);\r\n                    treeScope.fileTree = pTreeNode;\r\n                });\r\n            } else {\r\n                //查询文件树数据\r\n                _this.queryTree(bizKey, sSubType, sSeqNo).then(function (response) {\r\n                    var pTreeNode = _this.formatTreeData(response.data, urlParams.blbz, true);\r\n                    treeScope.fileTree = pTreeNode;\r\n                });\r\n            }\r\n        },\r\n        /**\r\n         * @description 材料是否可以编辑\r\n         * @param pNode\r\n         * @param strStepName\r\n         * @param bCliam\r\n         * @returns {boolean}\r\n         * @private\r\n         */\r\n        _isFileEnable: function (pNode, strStepName, bCliam) {\r\n            if (bCliam == false) {\r\n                //未签收\r\n                return false;\r\n            }\r\n            //配置节点比对\r\n\r\n            return true;\r\n        },\r\n        /**\r\n         * @description 材料是否必要\r\n         * @param pNode\r\n         * @private\r\n         */\r\n        _isFileNecessary: function (pNode) {\r\n            return true;\r\n        }\r\n    };\r\n    return result;\r\n}]);\r\n\r\n//拍摄服务\r\nangular.module('frameApp').factory('$captureService', ['$gmRestful', function ($gmRestful) {\r\n    var pRestful = new $gmRestful();\r\n    //基础操作\r\n    var BaseCapture = {\r\n        /**\r\n         * @description 展示对话框\r\n         */\r\n        showDialog: function () {\r\n            var nWindowHeight = $(window).height();\r\n            var nHeight = 650;\r\n            if (nHeight > nWindowHeight) {\r\n                nHeight = nWindowHeight;\r\n            }\r\n            var nWidth = (nHeight - 115) / 0.75 + 35 + 300;\r\n            $('.oa-capture-dialog').dialog({\r\n                title: '材料扫描',\r\n                modal: true,\r\n                width: nWidth,\r\n                height: nHeight\r\n            });\r\n        }\r\n    };\r\n\r\n    //通用摄像头控件\r\n    GM.DotNetCapture = {\r\n        showDialog: function ($scope) {\r\n            this.$scope = $scope;\r\n            this.$scope.tableData = [];\r\n            this.options = {\r\n                camera: 0,\r\n                resolution: 0\r\n            };\r\n            this._innitLayout();\r\n            this._initEvent();\r\n            BaseCapture.showDialog();\r\n        },\r\n        /**\r\n         * @description 初始化页面\r\n         */\r\n        _innitLayout: function () {\r\n            //修改页面对应的设备\r\n            this._modifyLayout();\r\n\r\n            if (this.device_camera == null) {\r\n                this.device_camera = $('#CaptureView')[0];\r\n            }\r\n            this.device_camera.CameraStop();\r\n            this.device_camera.Init();\r\n            var strCameras = this.device_camera.getDeviceNames();\r\n\r\n            if (strCameras) {\r\n                //设置默认显示摄像头的参数\r\n                var arrayCameras = strCameras.split(';');\r\n                //清除为空的数组元素\r\n                for (var ii = 0; ii < arrayCameras.length; ii++) {\r\n                    if (GM.CommonOper.isStrNullOrEmpty(arrayCameras[ii])) {\r\n                        GM.CommonOper.removeItemFromArray(arrayCameras, arrayCameras[ii]);\r\n                        ii--;\r\n                    }\r\n                }\r\n                this.$scope.arrayCameras = arrayCameras;\r\n            }\r\n            this.device_camera.CameraConn(this.options.camera, this.options.resolution);\r\n            this.$scope.selectCamera = String(this.options.camera);\r\n            this.$scope.arrayResolutions = this._getResolutions();\r\n            this.$scope.selectResolution = String(this.options.resolution);\r\n        },\r\n        _modifyLayout: function () {\r\n            $('#CaptureView').remove();\r\n            $('.oa-capture-view').append('<OBJECT ID=\"CaptureView\" CLASSID=\"CLSID:A14B31B4-C560-4DF7-A30C-59A3AE8C598D\" ' +\r\n                'style=\"height:100%;width:100%\"></OBJECT>');\r\n            var strClassID = $('#CaptureView').attr('CLASSID');\r\n            if (strClassID !== 'CLSID:A14B31B4-C560-4DF7-A30C-59A3AE8C598D') {\r\n                $('#CaptureView').remove();\r\n                $('.oa-capture-view').append('<OBJECT ID=\"CaptureView\" CLASSID=\"CLSID:A14B31B4-C560-4DF7-A30C-59A3AE8C598D\" ' +\r\n                    'style=\"height:100%;width:100%\"></OBJECT>');\r\n            }\r\n        },\r\n        _initEvent: function () {\r\n            var _this = this;\r\n            this.$scope.chooseCamera = function (nIndex) {\r\n                var nSelectIndex = Number(_this.$scope.selectCamera);\r\n                var nResolutionIndex = Number(_this.$scope.selectResolution);\r\n                _this.device_camera.CameraConn(nSelectIndex, 0);\r\n                _this.$scope.arrayResolutions = _this._getResolutions();\r\n                _this.$scope.selectResolution = '0';\r\n            };\r\n            this.$scope.chooseResolution = function (nIndex) {\r\n                var nSelectIndex = Number(_this.$scope.selectCamera);\r\n                var nResolutionIndex = Number(_this.$scope.selectResolution);\r\n                _this.device_camera.CameraConn(nSelectIndex, nResolutionIndex);\r\n            };\r\n\r\n            //刷新设备\r\n            this.$scope.updateCamera = function () {\r\n                _this.updateDevice();\r\n            };\r\n\r\n            //拍摄\r\n            this.$scope.shoot = function () {\r\n                var strBase64 = _this.device_camera.MakeCapture();\r\n                if (strBase64) {\r\n                    _this.$scope.tableData.push({\r\n                        name: _this.$scope.tableData.length + 1,\r\n                        strBase64: strBase64,\r\n                        uploadStatus: '待上传'\r\n                    });\r\n                }\r\n                //刷新摄像头\r\n                _this.updateDevice();\r\n            };\r\n\r\n            //重新拍摄\r\n            this.$scope.reshoot = function () {\r\n                _this.$scope.view = 'camera';\r\n            };\r\n\r\n            //查看图片\r\n            this.$scope.viewImg = function (pItem) {\r\n                _this.$scope.view = 'img';\r\n                _this.$scope.imgBase64 = pItem.strBase64;\r\n            };\r\n\r\n            //删除拍摄图片\r\n            this.$scope.deleteItem = function (pItem) {\r\n                GM.CommonOper.removeItemFromArray(_this.$scope.tableData, pItem);\r\n            };\r\n\r\n            //上传材料\r\n            this.$scope.uploadFile = function () {\r\n                for (var ii = 0; ii < _this.$scope.tableData.length; ii++) {\r\n                    var pUploadItem = _this.$scope.tableData[ii];\r\n                    if (pUploadItem.uploadStatus === '待上传') {\r\n                        var pResult = pRestful.ajax(RESTURL.file.uploadBase64, pUploadItem);\r\n                        if (pResult && pResult.success === true) {\r\n                            pUploadItem.uploadStatus === '上传成功';\r\n\r\n                            //添加节点\r\n                            if (_this.$scope.pActiveNode.children == null) {\r\n                                _this.$scope.pActiveNode.children = [];\r\n                            }\r\n                            var pData = pResult.data;\r\n                            _this.$scope.pActiveNode.children.push(pData);\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n\r\n            //注册对话框关闭事件\r\n            $('.oa-capture-dialog').on('dialogbeforeclose', function () {\r\n                _this.destory();\r\n            });\r\n\r\n            //页面离开事件\r\n            $(window).unbind('beforeunload', GM.DotNetCapture.destory).bind('beforeunload', GM.DotNetCapture.destory);\r\n        },\r\n        _getResolutions: function () {\r\n            var strResolutions = this.device_camera.getVideoResolutions();\r\n            if (strResolutions) {\r\n                var arrayResolutions = strResolutions.split(';');\r\n                return arrayResolutions;\r\n            }\r\n            return null;\r\n        },\r\n        /**\r\n         * @description 刷新设备\r\n         */\r\n        updateDevice: function () {\r\n            this.destory();\r\n            if (this.device_camera == null) {\r\n                this.device_camera = $('#CaptureView')[0];\r\n            }\r\n            this.device_camera.CameraStop();\r\n            this.device_camera.Init();\r\n            var nSelectIndex = Number(this.$scope.selectCamera);\r\n            var nResolutionIndex = Number(this.$scope.selectResolution);\r\n            this.device_camera.CameraConn(nSelectIndex, nResolutionIndex);\r\n        },\r\n        /**\r\n         * @description 回收对象\r\n         */\r\n        destory: function () {\r\n            if (GM.DotNetCapture.device_camera) {\r\n                GM.DotNetCapture.device_camera.CameraStop();\r\n                GM.DotNetCapture.device_camera = null;\r\n            }\r\n        }\r\n    };\r\n\r\n    var result = {\r\n        /**\r\n         * @description 展示高拍仪对话框\r\n         */\r\n        showCapture: function ($scope) {\r\n            $scope.capture = {};\r\n            var strVal = this.getVertion();\r\n            switch (strVal) {\r\n            case 'LiangTian':\r\n                //GM.OA.DotNetCapture.showDialog();\r\n                break;\r\n            case 'FangZheng':\r\n                //GM.OA.FangZhengCapture.showDialog();\r\n                break;\r\n            case 'JieYuA16D':\r\n                //GM.OA.JieYuA16DCapture.showDialog();\r\n                break;\r\n            case 'JieYuJYP6008T':\r\n                //GM.OA.JieYuJYP6008TCapture.showDialog();\r\n                break;\r\n            default:\r\n                GM.DotNetCapture.showDialog($scope);\r\n                break;\r\n            }\r\n        },\r\n        /**\r\n         * @description 获取高拍仪的版本\r\n         */\r\n        getVertion: function () {\r\n            return '';\r\n        }\r\n    };\r\n    return result;\r\n}]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/services/file-service.js","angular.module('frameApp').factory('$formCoreService', ['$gmRestful', function ($gmRestful) {\r\n    var service = {\r\n        loadPage: function (scope, validation, filter, dlg, gmTable, timeout) {\r\n            GM.Form.FormEngine.init(scope, new $gmRestful(), validation, filter, dlg, gmTable, timeout);\r\n            GM.Form.FormData.init(scope.formIds);\r\n            scope.getData();\r\n        }\r\n    };\r\n\r\n    return service;\r\n}]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/services/form-core-service.js","angular.module('frameApp').factory('$handOverService', ['$gmRestful', function ($gmRestful) {\r\n    var service = {\r\n        loadPage: function (scope) {\r\n            var _this = this;\r\n\r\n            if (!scope.taskInfo || !scope.taskInfo.hasOwnProperty('taskKey') || !scope.taskInfo.taskKey) {\r\n                GM.Form.CommonOper.showFailureMsg('无法获取移交相关参数！');\r\n                return;\r\n            }\r\n\r\n            scope.result = {};\r\n            scope.nextNodes = [];\r\n            scope.handOverConfig = {\r\n                name: 'name',\r\n                children: 'childrens',\r\n                checkNode: 'checkItem'\r\n            };\r\n\r\n            _this._bindEvents(scope);\r\n\r\n            //先获取移交参数\r\n            _this._getHandOverChecks(scope.taskInfo.processDefId, scope.taskInfo.taskKey, scope.taskInfo.bizKey).then(function (r) {\r\n                if (r.success === true) {\r\n                    scope.handOverVar = r.data;\r\n\r\n                    _this._getHandOverTarget(scope.taskInfo.processDefId, scope.taskInfo.taskKey, r.data).then(function (res) {\r\n                        if (res.success === true && res.data && res.data != null) {\r\n                            scope.nextNodes = res.data;\r\n                            scope.isOnlyLastNode = res.data.length === 1 && res.data[0].node == '__结束__';\r\n                            var userArray = [];\r\n                            var subArray = angular.copy(res.data);\r\n\r\n                            for (var i = 0; i < subArray.length; i++) {\r\n                                userArray[i] = {\r\n                                    name: subArray[i].node,\r\n                                    childrens: subArray[i].groups\r\n                                };\r\n\r\n                                if (!subArray[i].groups) {\r\n                                    continue;\r\n                                }\r\n\r\n                                for (var j = 0; j < subArray[i].groups.length; j++) {\r\n                                    userArray[i].childrens[j] = {\r\n                                        name: subArray[i].groups[j].name,\r\n                                        id: subArray[i].groups[j].id,\r\n                                        childrens: subArray[i].groups[j].users\r\n                                    };\r\n                                }\r\n                            }\r\n\r\n                            scope.chooseRole = userArray;\r\n                        } else if (res.message) {\r\n                            GM.Form.CommonOper.showFailureMsg(res.message);\r\n                        }\r\n                    }, function (res) {\r\n                        GM.Form.CommonOper.showFailureMsg(res.message);\r\n                    });\r\n                }\r\n            }, function (r) {\r\n                GM.Form.CommonOper.showFailureMsg(r.message);\r\n            });\r\n        },\r\n        _bindEvents: function (scope) {\r\n            var _this = this;\r\n\r\n            scope.checkItem = function (item) {\r\n                _this._checkItem(scope, item);\r\n            };\r\n\r\n            scope.modelHandOver = function () {\r\n                _this._doHandOver(scope);\r\n            };\r\n\r\n            scope.unselectUser = function (node, id, name) {\r\n                _this._unselect(scope, node, id, name);\r\n            };\r\n        },\r\n        _checkItem: function (scope, item) {\r\n            var _this = this;\r\n            scope.selectedUsers = [];\r\n\r\n            if (item instanceof Array) {\r\n                for (var i = 0; i < item.length; i++) {\r\n                    if (item[i].flag == '3') {\r\n                        _this._selectUser(scope, item[i].node, item[i].id, item[i].name);\r\n                    }\r\n                }\r\n            } else {\r\n                if (item && item.flag == '3') {\r\n                    _this._selectUser(scope, item.node, item.id, item.name);\r\n                }\r\n            }\r\n        },\r\n        _selectUser: function (scope, node, id, name) {\r\n            var user = {\r\n                id: id,\r\n                name: name\r\n            };\r\n\r\n            var bFlag = false;\r\n\r\n            for (var i = 0; i < scope.selectedUsers.length; i++) {\r\n                if (scope.selectedUsers[i]['node'] && scope.selectedUsers[i]['node'] == node) {\r\n                    if (!GM.CommonOper.isArrayContainsEle(scope.selectedUsers[i]['users'], user)) {\r\n                        var users = scope.selectedUsers[i]['users'] || [];\r\n                        users.push(user);\r\n                        scope.selectedUsers[i]['users'] = users;\r\n                    }\r\n\r\n                    bFlag = true;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (!bFlag) {\r\n                scope.selectedUsers.push({\r\n                    node: node,\r\n                    users: [user]\r\n                });\r\n            }\r\n        },\r\n        _unselect: function (scope, node, id, name) {\r\n            var _this = this;\r\n            _this._uncheckTreeUser(scope, node, id, name);\r\n\r\n            for (var i = 0; i < scope.selectedUsers.length; i++) {\r\n                if (scope.selectedUsers[i]['node'] && scope.selectedUsers[i]['node'] == node) {\r\n                    var users = scope.selectedUsers[i]['users'];\r\n                    var deleteItem = {\r\n                        id: id,\r\n                        name: name\r\n                    };\r\n                    GM.CommonOper.removeItemFromArray(users, deleteItem, 'id');\r\n\r\n                    if (users.length === 0) {\r\n                        scope.selectedUsers.splice(i, 1);\r\n                    } else {\r\n                        scope.selectedUsers[i]['users'] = users;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        _uncheckUserOnTree: function (cur, nodeName, id, name) {\r\n            var _this = this;\r\n            if (cur.childrens && cur.childrens.length > 0) {\r\n                for (var i = 0; i < cur.childrens.length; i++) {\r\n                    _this._uncheckUserOnTree(cur.childrens[i], nodeName, id, name);\r\n                }\r\n            } else if (cur.flag == '3' && cur.id == id && cur.node == nodeName) {\r\n                cur.check = false;\r\n            }\r\n        },\r\n        _uncheckTreeUser: function (scope, nodeName, id, name) {\r\n            for (var i = 0; i < scope.chooseRole.length; i++) {\r\n                this._uncheckUserOnTree(scope.chooseRole[i], nodeName, id, name);\r\n            }\r\n        },\r\n        _doHandOver: function (scope) {\r\n            if ((!scope.isOnlyLastNode || scope.isOnlyLastNode !== true) && (!scope.selectedUsers || scope.selectedUsers.length === 0)) {\r\n                GM.Form.CommonOper.showFailureMsg('请先选择移交对象！');\r\n                return;\r\n            }\r\n\r\n            var _this = this;\r\n            var param = {\r\n                userId: top.GM.userInfo.loginName,\r\n                bizKey: scope.taskInfo.bizKey,\r\n                taskKey: scope.taskInfo.taskKey,\r\n                variables: scope.handOverVar\r\n            };\r\n\r\n            if (scope.isOnlyLastNode !== true) {\r\n                var target = {\r\n                    target: []\r\n                };\r\n                var arrayIds = null;\r\n\r\n                for (var u = 0; u < scope.selectedUsers.length; u++) {\r\n                    arrayIds = GM.Form.CommonOper.mapFieldArray(scope.selectedUsers[u].users, 'id');\r\n                    target.target.push({\r\n                        node: scope.selectedUsers[u].node,\r\n                        users: arrayIds\r\n                    });\r\n                }\r\n\r\n                param.targets = JSON.stringify(target);\r\n            }\r\n\r\n            this._handOver(param).then(function (response) {\r\n                if (response.success === true) {\r\n                    if (response.data) {\r\n                        _this._saveBizFlowInfo(response.data, scope.taskInfo.bizKey);\r\n                    }\r\n\r\n                    var sMsg = scope.isOnlyLastNode === true ? '流程已结束！' : '移交成功！';\r\n                    GM.Form.CommonOper.showSuccessMsg(sMsg);\r\n                    GM.Form.formScope.closeDialog();\r\n                    var strBoxName = scope.handOverParam && scope.handOverParam.boxName;\r\n                    top.goPendingPage(strBoxName);\r\n                } else {\r\n                    GM.Form.CommonOper.showFailureMsg(response.message);\r\n                }\r\n            }, function (response) {\r\n                GM.Form.CommonOper.showFailureMsg(response.message);\r\n            });\r\n        },\r\n        _getBizInfo: function (userId, bizKey, taskKey) {\r\n            return $gmRestful().get(FORM_REST_URL.workflow.getBizInfo, {\r\n                userId: userId,\r\n                bizKey: bizKey,\r\n                taskKey: taskKey\r\n            });\r\n        },\r\n        _getHandOverChecks: function (processDefId, taskKey, bizKey) {\r\n            return $gmRestful().get(GM.Form.parameters.servers.getHandOverVarServer, {\r\n                processDefId: processDefId,\r\n                taskKey: taskKey,\r\n                bizKey: bizKey\r\n            });\r\n        },\r\n        _getHandOverTarget: function (processDefId, taskKey, v) {\r\n            return $gmRestful().get(FORM_REST_URL.workflow.getHandOverTarget, {\r\n                processDefId: processDefId,\r\n                taskKey: taskKey,\r\n                'var': JSON.stringify(v)\r\n            });\r\n        },\r\n        _handOver: function (param) {\r\n            return $gmRestful().post(FORM_REST_URL.workflow.handOver, param);\r\n        },\r\n        _saveBizFlowInfo: function (id, bizKey) {\r\n            GM.Form.CommonOper.syncAjaxGet(GM.Form.parameters.servers.updateBizFlowInfoServer + '?bizKey=' + bizKey, function (res) {\r\n\r\n            }, function (res) {});\r\n        }\r\n    };\r\n\r\n    return service;\r\n}]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/services/handover-service.js","import 'formConfig';\r\nimport 'formCore';\r\nimport 'fileCtrl';\r\nimport 'formCtrl';\r\nimport 'handOverCtrl';\r\nimport 'agencyCtrl';\r\nimport 'completeCtrl';\r\nimport 'draftCtrl';\r\nimport 'protocolCtrl';\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/form.js","import 'agencyService';\r\n\r\nangular.module('frameApp').controller('agencyCtrl', ['$scope', '$rootScope', '$agencyService', '$filter', function ($scope, $rootScope, $agencyService, $filter) {\r\n    var userId = GM.userInfo.loginName;\r\n    var appId = GM.AppInfo.id;\r\n\r\n    $scope.agencyForm = {\r\n        userId: userId,\r\n        appId: appId,\r\n        orderField: 'startTime'\r\n    };\r\n\r\n    //使用自定义分页控件\r\n    $scope.$watch('pendingPage.currentPage', function () {\r\n        if ($scope.pendingPage.currentPage > 0) {\r\n            $scope.agencyForm.current = $scope.pendingPage.currentPage;\r\n            queryData();\r\n        }\r\n    });\r\n    $scope.pendingPage.currentPage = 1;\r\n\r\n    //查询数据\r\n    function queryData () {\r\n        $agencyService.queryPendingData($scope.agencyForm).then(function (response) {\r\n            var dbData = response.data.records;\r\n            angular.forEach(dbData, function (item, index) {\r\n                item.index = index + 1;\r\n                item.startTime = $filter('date')(item.startTime, 'yyyy-MM-dd HH:mm:ss');\r\n            });\r\n            $scope.userData.data.page.records = dbData;\r\n            $scope.pendingPage.totalItems = response.data.total;\r\n        }, function (erron) {\r\n            GM.Infomation.show(erron.message, {\r\n                type: 'warning'\r\n            });\r\n        });\r\n    }\r\n\r\n    /***标签查询*****/\r\n    $scope.tagData = {\r\n        tags: [{\r\n            name: '计划待办',\r\n            value: '计划待办'\r\n        }, {\r\n            name: '实施待办',\r\n            value: '实施待办'\r\n        }, {\r\n            name: '验收待办',\r\n            value: '验收待办'\r\n        }],\r\n        checkTag: 'checkTag'\r\n    };\r\n\r\n    $scope.checkTag = function (tags) {\r\n        $scope.agencyForm.xmjd = [];\r\n        for (var i = 0; i < tags.length; i++) {\r\n            $scope.agencyForm.xmjd.push(tags[i].value);\r\n        }\r\n        queryData();\r\n    };\r\n\r\n    //表格控件数据\r\n    $scope.userData = {\r\n        config: {\r\n            'taskKey': {\r\n                'type': 'a',\r\n                'click': 'goProcess'\r\n            }\r\n        },\r\n        data: {\r\n            page: {},\r\n            head: {\r\n                'index': '序号',\r\n                'bizKey': '案卷编号',\r\n                'bizName': '案卷名称',\r\n                'processName': '项目类型',\r\n                'startTime': '提交时间',\r\n                'submitterName': '提交人',\r\n                'taskKey': '当前环节'\r\n            }\r\n        },\r\n        headList: ['index', 'bizKey', 'bizName', 'processName', 'startTime', 'submitterName', 'taskKey']\r\n    };\r\n\r\n    var getExtraBizFields = function () {\r\n        return $agencyService.queryExtraBizFields(appId).then(function (res) {\r\n            if (res.success === true && res.data && res.data.length > 0) {\r\n                for (var i = 0; i < res.data.length; i++) {\r\n                    $scope.userData.headList.splice(4, 0, res.data[i].field);\r\n                    $scope.userData.data.head[res.data[i].field] = res.data[i].label;\r\n                }\r\n            }\r\n        }, function (res) {});\r\n    };\r\n\r\n    //查询\r\n    $scope.refer = function () {\r\n        queryData();\r\n    };\r\n\r\n    //清除\r\n    $scope.delet = function () {\r\n        $scope.agencyForm = {\r\n            userId: userId\r\n        };\r\n        queryData();\r\n    };\r\n\r\n    // 节点\r\n    $scope.goProcess = function (item) {\r\n        console.log(item);\r\n        $rootScope.processUrl = $agencyService.getHtmlPath() + '?appId=' + appId + '&serviceAppKey=' + item.serviceAppKey + '&box=agency&ywh=' + item.bizKey + '&processKey=' + item.processKey + '&processDefId=' + item.processDefId + '&taskKey=' + encodeURIComponent(item.taskKey ? item.taskKey : '起草') + '&processName=' + encodeURIComponent(item.processName) + '&caseTitle=' + encodeURIComponent(item.bizName);\r\n        $(\"[ng-controller='agencyCtrl'] *\").hide();\r\n        $(\"[ng-controller='agencyCtrl']\").append('<iframe frameborder=\"0\" height=\"100%\" width=\"100%\" name =\"agencyCtrl\"></iframe>');\r\n        window['agencyCtrl'].location.href = $rootScope.processUrl;\r\n    };\r\n\r\n    //跳转到待办页面\r\n    $scope.goPending = function () {\r\n        $scope.activeNaviFromPath('/agency', true);\r\n    };\r\n}]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/office/controllers/agency-ctrl.js","import 'agencyService';\r\n\r\nangular.module('frameApp').controller('completeCtrl', ['$scope', '$rootScope', '$agencyService', '$filter', function ($scope, $rootScope, $agencyService, $filter) {\r\n    var userId = GM.userInfo.loginName;\r\n    var appId = GM.AppInfo.id;\r\n\r\n    $scope.completeForm = {\r\n        userId: userId,\r\n        appId: appId,\r\n        orderField: 'completeTime'\r\n    };\r\n\r\n    //使用自定义分页控件\r\n    $scope.pendingPage = {\r\n        currentPage: 1\r\n    };\r\n    $scope.$watch('pendingPage.currentPage', function () {\r\n        if ($scope.pendingPage.currentPage > 0) {\r\n            $scope.completeForm.current = $scope.pendingPage.currentPage;\r\n            queryData();\r\n        }\r\n    });\r\n    $scope.pendingPage.currentPage = 1;\r\n\r\n    //查询数据\r\n    function queryData () {\r\n        $agencyService.queryCompleteData($scope.completeForm).then(function (response) {\r\n            var dbData = response.data.records;\r\n            angular.forEach(dbData, function (item, index) {\r\n                item.index = index + 1;\r\n                item.completeTime = $filter('date')(item.completeTime, 'yyyy-MM-dd');\r\n            });\r\n            $scope.userData.data.page.records = dbData;\r\n            $scope.pendingPage.totalItems = response.data.total;\r\n        }, function (erron) {\r\n            GM.Infomation.show(erron.message, {\r\n                type: 'warning'\r\n            });\r\n        });\r\n    }\r\n\r\n    /***标签查询*****/\r\n    $scope.tagData = {\r\n        tags: [{\r\n            name: '计划阶段',\r\n            value: 0\r\n        }, {\r\n            name: '实施阶段',\r\n            value: 1\r\n        }, {\r\n            name: '验收阶段',\r\n            value: 2\r\n        }],\r\n        checkTag: 'checkTag'\r\n    };\r\n\r\n    $scope.checkTag = function (tags) {\r\n        $scope.completeForm.xmjd = [];\r\n        for (var i = 0; i < tags.length; i++) {\r\n            $scope.completeForm.xmjd.push(tags[i].name);\r\n        }\r\n        queryData();\r\n    };\r\n\r\n    //表格控件数据\r\n    $scope.userData = {\r\n        config: {\r\n            operate: [{\r\n                name: '查看',\r\n                icon: 'icon-edit',\r\n                click: 'goProcess'\r\n            }]\r\n        },\r\n        data: {\r\n            page: {},\r\n            head: {\r\n                'index': '序号',\r\n                'bizKey': '案卷编号',\r\n                'bizName': '案卷名称',\r\n                'processName': '项目类型',\r\n                'taskKey': '已办环节',\r\n                'completeTime': '提交时间',\r\n                'targetTaskKey': '接收环节',\r\n                'receiverName': '接收人'\r\n            }\r\n        },\r\n        headList: ['index', 'bizKey', 'bizName', 'processName', 'taskKey', 'completeTime', 'targetTaskKey', 'receiverName']\r\n    };\r\n\r\n    $scope.refer = function () {\r\n        queryData();\r\n    };\r\n\r\n    //清除\r\n    $scope.delet = function () {\r\n        $scope.completeForm = {\r\n            userId: userId\r\n        };\r\n        queryData();\r\n    };\r\n\r\n    // 节点\r\n    $scope.goProcess = function (item) {\r\n        console.log(item);\r\n        $rootScope.processUrl = 'forms/index.html?appId=' + appId + '&serviceAppKey=' + item.serviceAppKey + '&box=complete&ywh=' + item.bizKey + '&processKey=' + item.processKey + '&processDefId=' + item.processDefId + '&taskKey=' + encodeURIComponent('查看') + '&processName=' + encodeURIComponent(item.processName) + '&caseTitle=' + encodeURIComponent(item.bizName);\r\n        $(\"[ng-controller='completeCtrl'] *\").hide();\r\n        $(\"[ng-controller='completeCtrl']\").append('<iframe frameborder=\"0\" height=\"100%\" width=\"100%\" name =\"completeCtrl\"></iframe>');\r\n        window['completeCtrl'].location.href = $rootScope.processUrl;\r\n    };\r\n\r\n    //跳转到待办页面\r\n    $scope.goPending = function () {\r\n        $scope.activeNaviFromPath('/complete', true);\r\n    };\r\n}]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/office/controllers/complete-ctrl.js","import 'draftService';\r\n\r\nangular.module('frameApp').controller('draftCtrl', ['$scope', '$location', '$rootScope', '$draftService', '$agencyService', '$log', function ($scope, $location, $rootScope, $draftService, $agencyService, $log) {\r\n    var userId = GM.userInfo.loginName;\r\n    $scope.draftForm = {\r\n        userId: userId\r\n    };\r\n\r\n    //获取项目所在地数据字典\r\n    $scope.regions = GM.userInfo.areas;\r\n    $scope.treearea = {\r\n        name: 'title',\r\n        children: 'childrens',\r\n        attvalue: 'code'\r\n    };\r\n\r\n    //使用自定义分页控件\r\n    $scope.pendingPage = {\r\n        currentPage: 1\r\n    };\r\n\r\n    $scope.$watch('pendingPage.currentPage', function () {\r\n        if ($scope.pendingPage.currentPage > 0) {\r\n            $scope.draftForm.current = $scope.pendingPage.currentPage;\r\n            queryData();\r\n        }\r\n    });\r\n    $scope.pendingPage.currentPage = 1;\r\n\r\n    //查询数据\r\n    function queryData () {\r\n        $agencyService.queryDraftData($scope.draftForm).then(function (response) {\r\n            var cgData = response.data.page.records;\r\n            angular.forEach(cgData, function (item, index) {\r\n                item.index = index + 1;\r\n            });\r\n            $scope.userData.data.page.records = cgData;\r\n            $scope.pendingPage.totalItems = response.data.page.total;\r\n        }, function (erron) {\r\n            GM.Infomation.show(erron.message, {\r\n                type: 'warning'\r\n            });\r\n        });\r\n    }\r\n\r\n    /***标签查询*****/\r\n    $scope.tagData = {\r\n        tags: [{\r\n            name: '一般开发项目',\r\n            value: '一般开发项目'\r\n        }, {\r\n            name: '专项基金开发项目',\r\n            value: '专项基金开发项目'\r\n        }, {\r\n            name: '一般整理项目',\r\n            value: '一般整理项目'\r\n        }, {\r\n            name: '国土部门高标准项目',\r\n            value: '国土部门高标准项目'\r\n        }, {\r\n            name: '其它部门高标准项目',\r\n            value: '其它部门高标准项目'\r\n        }, {\r\n            name: '一般复垦项目',\r\n            value: '一般复垦项目'\r\n        }, {\r\n            name: '采空区复垦',\r\n            value: '采空区复垦'\r\n        }, {\r\n            name: '矿业用地存量复垦',\r\n            value: '矿业用地存量复垦'\r\n        }],\r\n        checkTag: 'checkTag'\r\n    };\r\n\r\n    $scope.checkTag = function (tags) {\r\n        $scope.draftForm.xmjd = [];\r\n        for (var i = 0; i < tags.length; i++) {\r\n            $scope.draftForm.xmjd.push(tags[i].value);\r\n        }\r\n        queryData();\r\n    };\r\n\r\n    //表格控件数据\r\n    $scope.userData = {\r\n        config: {\r\n            operate: [{\r\n                name: '编辑',\r\n                icon: 'icon-edit',\r\n                click: 'goProcess'\r\n            }]\r\n        },\r\n        data: {\r\n            page: {},\r\n            head: {\r\n                'index': '序号',\r\n                'xmysubh': '预算编号',\r\n                'xmmc': '项目名称',\r\n                'xzqmc': '项目位置',\r\n                'zgm': '总规模',\r\n                'ztz': '总投资',\r\n                'xmjd': '项目阶段',\r\n                'xmlx': '项目类型'\r\n            }\r\n        },\r\n        headList: ['index', 'xmysubh', 'xmmc', 'xzqmc', 'zgm', 'ztz', 'xmjd', 'xmlx']\r\n    };\r\n\r\n    //查询\r\n    $scope.refer = function () {\r\n        queryData();\r\n    };\r\n\r\n    //清除\r\n    $scope.delet = function () {\r\n        $scope.draftForm = {\r\n            userId: userId\r\n        };\r\n        queryData();\r\n    };\r\n\r\n    //跳转回本页面\r\n    $scope.goPending = function () {\r\n        $scope.activeNaviFromPath('/draft', true);\r\n    };\r\n\r\n    // 节点\r\n    $scope.goProcess = function (item) {\r\n        $rootScope.processUrl = $agencyService.getHtmlPath() + '?did=' + item.id + '&box=draft&processid=' + encodeURIComponent(item.processKey);\r\n        $(\"[ng-controller='draftCtrl'] *\").hide();\r\n        $(\"[ng-controller='draftCtrl']\").append('<iframe frameborder=\"0\" height=\"100%\" width=\"100%\" name =\"draftCtrl\"></iframe>');\r\n        window['draftCtrl'].location.href = $rootScope.processUrl;\r\n    };\r\n}]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/office/controllers/draft-ctrl.js","import 'protocolCtrl';\r\n\r\nangular.module('frameApp').controller('protocolCtrl', ['$scope', '$rootScope', '$protocolService', '$agencyService', '$log', function ($scope, $rootScope, $protocolService, $agencyService, $log) {\r\n    //起草箱\r\n    //top.GM.AppInfo.id = \"aa836f906aa545f6ba32a065a32c4e8a\";\r\n    //top.GM.AppInfo.name = \"自然资源统一确权登记\";\r\n\r\n    //用户权限\r\n    if (!top.GM.userInfo || top.GM.userInfo.permissions.length === 0) {\r\n        GM.Infomation.show('无法获取当前用户权限！', {\r\n            type: 'danger',\r\n            placement: 'center'\r\n        });\r\n\r\n        return;\r\n    }\r\n\r\n    $protocolService.queryDraft(top.GM.AppInfo.id, top.GM.userInfo.permissions.join(',')).then(function (response) {\r\n        $scope.draftData = response.data;\r\n    }, function (error) {\r\n        $log.error(error);\r\n    });\r\n\r\n    //起草按钮\r\n    $scope.draftProcess = function (processData) {\r\n        $protocolService.getUUID(null).then(function (res) {\r\n            if (res && res.success === true) {\r\n                goToDraft(processData, res.data);\r\n            } else {\r\n                goToDraft(processData, 'unknown');\r\n            }\r\n        }, function (res) {\r\n            goToDraft(processData, 'unknown');\r\n        });\r\n    };\r\n\r\n    //跳转到待办页面\r\n    $scope.goPending = function () {\r\n        $scope.activeNaviFromPath('/protocol', true);\r\n    };\r\n\r\n    var goToDraft = function (processData, uuid) {\r\n        var processKey = processData.processDefinitionId.split(':')[0];\r\n        $rootScope.processUrl = $agencyService.getHtmlPath() + '?startFlag=1&duuid=' + uuid + '&box=protocol&appId=' + top.GM.AppInfo.id + '&serviceAppKey=' + processData.serviceAppKey + '&processKey=' + processKey + '&processDefId=' + processData.id + '&processName=' + encodeURIComponent(processData.processName);\r\n        $(\"[ng-controller='protocolCtrl'] *\").hide();\r\n        $(\"[ng-controller='protocolCtrl']\").append('<iframe frameborder=\"0\" height=\"100%\" width=\"100%\" name =\"protocolCtrl\"></iframe>');\r\n        window['protocolCtrl'].location.href = $rootScope.processUrl;\r\n    };\r\n}]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/office/controllers/protocol-ctrl.js","angular.module('frameApp').factory('$agencyService', ['$gmRestful', function ($gmRestful) {\r\n    var result = {\r\n        queryExtraBizFields: function (appId) {\r\n            return new $gmRestful().get(ACTIVITI_SERVER + 'usertask/getExtraBizFields?appId=' + appId);\r\n        },\r\n        //查询拟件数据\r\n        queryStartData: function (params) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.get(RESTURL.process.start, params);\r\n            return pPromise;\r\n        },\r\n        //查询待办数据\r\n        queryPendingData: function (params) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.get(ACTIVITI_SERVER + 'usertask/list/handling', params);\r\n            return pPromise;\r\n        },\r\n        //查询项目查询\r\n        getQuery: function (params) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.get(RESTURL.process.query, params);\r\n            return pPromise;\r\n        },\r\n        //格式化时间\r\n        processDate: function (timeStamp) {\r\n            var date = new Date(timeStamp);\r\n            return [date.getFullYear(), date.getMonth() + 1, date.getDate()].join('-');\r\n        },\r\n        //查询经办数据\r\n        queryCompleteData: function (params) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.get(ACTIVITI_SERVER + 'usertask/list/handled', params);\r\n            return pPromise;\r\n        },\r\n        //查询草稿数据\r\n        queryDraftData: function (params) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.get(ACTIVITI_SERVER + 'userdraft/getDraftInfo', params);\r\n            return pPromise;\r\n        },\r\n        /**\r\n         * @description 获取页面路径\r\n         * @param processId\r\n         * @param nodeId\r\n         * @returns {*}\r\n         */\r\n        getHtmlPath: function () {\r\n            var strResult = null;\r\n            strResult = 'forms/index.html';\r\n            return strResult;\r\n        },\r\n        //流程分类管理\r\n        getProcessCatalogs: function (params, id) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.get(RESTURL.wf.getProcessCatalogs + (id ? ('?id=' + id) : ''), params);\r\n            return pPromise;\r\n        },\r\n        //编辑\r\n        edit: function (params) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.post(RESTURL.wf.editProcessCatalog, params);\r\n            return pPromise;\r\n        },\r\n        //删除\r\n        delete: function (params, id) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.get(RESTURL.wf.deleteProcessCatalog + '?id=' + id, params);\r\n            return pPromise;\r\n        }\r\n    };\r\n    return result;\r\n}]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/office/services/agency-services.js","angular.module('frameApp').factory('$draftService', ['$gmRestful', function ($gmRestful) {\r\n    var result = {\r\n        //查询草稿箱数据\r\n        queryPendingData: function (params) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.get(ACTIVITI_SERVER + 'userdraft/getDraftInfo', params);\r\n            return pPromise;\r\n        }\r\n    };\r\n    return result;\r\n}]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/office/services/draft-services.js"],"sourceRoot":""}