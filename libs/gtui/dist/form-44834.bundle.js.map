{"version":3,"sources":["webpack:///./src/form/app.js","webpack:///./src/form/core/base/api.js","webpack:///./src/form/core/base/form-data.js","webpack:///./src/form/core/base/form-engine.js","webpack:///./src/form/core/base/form-webgis.js","webpack:///./src/form/core/base/workflow.js","webpack:///./src/form/core/config.js","webpack:///./src/form/core/controllers/file-controller.js","webpack:///./src/form/core/controllers/form-controller.js","webpack:///./src/form/core/controllers/handover-controller.js","webpack:///./src/form/core/directives/tab-components.js","webpack:///./src/form/core/services/file-service.js","webpack:///./src/form/core/services/form-core-service.js","webpack:///./src/form/core/services/handover-service.js","webpack:///./src/form/core/views/model/dialog.html","webpack:///./src/form/form.js","webpack:///./src/form/office/controllers/agency-ctrl.js","webpack:///./src/form/office/controllers/complete-ctrl.js","webpack:///./src/form/office/controllers/draft-ctrl.js","webpack:///./src/form/office/controllers/protocol-ctrl.js","webpack:///./src/form/office/services/agency-services.js","webpack:///./src/form/office/services/draft-services.js","webpack:///./src/form/office/services/protocol-services.js"],"names":["angular","module","ex","GM","Form","CommonOper","showSuccessMsg","msg","Infomation","show","type","placement","showFailureMsg","getUUID","i","chars","split","uuid","Math","random","join","showDialog","url","title","size","callback","w","h","option","iframe","indexOf","Date","backdrop","arrSize","parseInt","e","$","zui","ModalTrigger","hidden","mapFieldArray","array","field","result","length","_typeof","push","syncAjaxGet","successCallback","errorCallback","param","this","_syncAjax","syncAjaxPost","opt","async","success","res","error","data","ajax","getCnFormatMoney","n","fraction","digit","unit","head","abs","s","floor","pow","replace","p","j","setObjectAttrVal","obj","exp","index","val","arr","cloneObject","copy","setTime","getTime","Array","len","Object","attr","hasOwnProperty","Error","showMapDialog","window","frames","pMap","dialog","autoOpen","resizeable","draggable","effect","duration","hide","modal","width","height","zIndex","position","my","at","of","pLocation","parent","location","strPathName","pathname","toLowerCase","substr","FilePath","getDirName","href","origin","__webpack_require__","FormData","init","formid","_initScopeVar","_bindEvents","formScope","gridQueryParams","queryType","undefined","queryValue","parameters","formDataSourceNames","_initOptions","_datas","globe","saveKeys","_this","getData","urlParams","startFlag","_getData","did","_getDraftData","save","failureCallback","_saveData","saveAndHandOver","saveDraft","_saveDraft","duuid","getSingleDataGrid","ds","_getSingleDataGrid","dataGridSelect","item","_dataGridSelect","grid","appScope","closeThisDialog","saveDialog","_saveDialog","closeFormDialog","newDataGridRecord","buttons","dataGridNewFlag","isArrayContainsEle","savingFormIds","showFormDialog","dgA","_dataGridOperA","dgB","_dataGridOperB","getRedisString","key","_getRedisString","removeRedisString","_removeRedisString","redisString","_redisString","initDataGridOptions","_initDataGridOptions","initDataGridHeaders","fieldString","operString","_getGridOption","scope","dgds","sDataItems","sTemplateItems","FORM_REST_URL","workflow","getDataGridDataSourceNames","ele","event","srcElement","linkText","text","templates","element","_showDataGridDlg","service","method","tip","ywh","Alert","showCancelButton","_invokeDataGridREST","_deleteDataGridRecordWithoutBizKey","$dgid","entity","$$dgid","uiGrid","prefix","removeItemFromArray","FormEngine","clearTemporaryUrlParameters","alias","formAlias","u","arrDataItems","substring","urlTempParams","RESTURL","dg","dataItems","toUpperCase","restful","post","get","then","message","paras","para","searchType","searchValue","up","formids","dataSourceName","urlParameters","JSON","stringify","servers","getSingleDataGridServer","_bindDataGrid","hd","templateItems","gridOptionName","gridOptions","tableGrid","gmTable","heads","arrTemps","name","click","gridParas","displayName","enableColumnMenu","cellTooltip","strCellTemplate","getCellTemplate","cellTemplate","columnDefs","timeout","updateSize","pstyle","isDataComplex","globalTreeData","dgData","page","records","headList","process","getDraftInfo","response","parse","id","userId","top","userInfo","loginName","appId","AppInfo","processDefId","processName","processKey","ctrl","bizName","saveDraftBaseInfo","_getSavingData","saveDraftInfo","r","keepOldData","params","formIds","getDataServer","keys","forEach","m","startsWith","sService","fr","treeKey","isEmptyObject","totalItems","_setGridDataWithTempData","jIndex","dgId","subKey","dialogParameter","saveDataServer","serverUrl","getAnalyzedParam","bHas","lkey","_pretreatedSavingData","alia","autoHandOver","handOver","validationObject","ngDialog","filter","serviceAppKey","realName","dataLoaded","formValid","saveLayerName","getHandOverVarServer","updateBizFlowInfoServer","_functions","beforeGetData","afterGetData","pageLoaded","settings","layoutUrl","forms","tabs","prints","topUrl","showBottom","loadWebGIS","draftInfo","hasInitCalcs","v","f","d","g","t","LayoutOper","getURLParams","_getFormServiceUrl","form","_loadPage","_doAfterLoadPage","getAppServerUrl","appKey","lastIndexOf","each","tabId","newTabId","tabDiv","next","find","_watchCalcExp","ii","CONFIG_JSON","app","value","FORM_SERVER","console","log","dateAdd","dateStr","span","isNaN","parseFloat","a","setDate","getDate","year","getFullYear","toString","month","getMonth","day","dateDiff","date1","date2","invokePlugin","validScope","_clickEvent","treeConfig","activeNode","treeEvent","node","_treeConfig","goBack","goPendingPage","box","print","code","_print","taskInfo","bizKey","clearParams","_showFormDialog","Dialog","close","formLoaded","_formLoaded","isCbChecked","b","_isCheckBoxChecked","cbCheck","_cbCheck","dialogButtonClick","ss","c","eval","$watch","sUserNgModel","vCur","organizations","orgs","dt","vYear","vMonth","vDate","vSysDate","arrCalcOpers","sCalcExp","isCn","sModel","sDigits","arrEleBinds","curEleBind","sNewCalcExp","containsObj","curVal","curSign","sLastExp","isString","uu","vLastOper","toFixed","formCommonOper","vCalResult","ee","bChecked","target","prop","arrDataGridDataSources","arrVals","initedDlgFormIds","formInfos","getFormInfoById","dir","dialogPara","arrBtns","formBtns","arrSBtn","open","template","plain","printCfgUrl","printConfigUrl","ftpHost","ftpPort","ftpApp","appid","results","treeFormKey","pNode","sxh","subtype","names","_doClick","validateForm","allForms","splice","_pushFormId","addUniqueEle","_pushSavingFormId","_getPages","pages","_retrievePages","kk","children","getParamsValue","_getLayoutUrl","STATIC_RESOURCES_PATH","Workflow","sIndexJsonUrl","getTaskConfig","encodeURIComponent","taskKey","style","webgis","formWebgis","graphStat","savePlots","payload","asDraft","saveData","strParams","graph","saveGraphStatics","polygon","savePolygon","layerName","status","strObjectName","GIS","ExternalApi","saveJXPolygons","getJhObjectIDName","statistics","vObjectId","feature","objectid","polygonNum","area","strGeom","saveGraphParam","draftBizKey","isClaimed","caseTitle","startTime","forbid","boxName","getProcessInstanceByBizKey","startProcessAndHandOver","startProcess","notTurnToFirst","_startProcess","claimOrUnclaim","_claimOrUnclaim","showWfGraph","blankTitle","htmlContent","getHighLightTask","_isTaskClaimed","_initBizFlowDetails","alertMessage","myUrl","erroeMessage","claimTask","unclaimTask","str","ctrlCaseTitle","draftKey","ctrlExtraBizDatas","extraBizData","y","currentTaskId","saveBizFlowInfo","pendingPageLz","currentPage","_getLzData","lzGridOptions","showLzDialog","className","viewMap","strDyh","zrzyjbxx","ZRZYDJDYH","strUrl","addURLParam","ONEMAP_PATH","FullModal","closeDialog","getTaskTrackPage","dbData","completeTime","total","readonly","workflowCore","FORM_SERVER_URLS","ACTIVITI_SERVER","saveDataAsDraft","getDraftData","getDrafts","getRegionTree","getBizInfo","getHandOverTarget","controller","$scope","$location","$fileService","$captureService","$validation","formBase","getUrlParamters","absUrl","strYwh","strStepName","blbz","fileTreeConfig","activeFolder","pActiveNode","uploadFile","unbind","change","formData","append","files","filename","ajaxRequest","file","cache","processData","contentType","pData","$apply","fileTree","formatTreeData","editFolder","copyFocusItem","deleteFolder","removeFolder","$log","deleteFile","removeFile","fileId","TreeOper","removeNode","editFile","viewFile","getFileType","imgUrl","saveFile","addFolder","saveFolder","dislogScope","folderForm","focusItem","captureImg","showCapture","$http","$gmRestful","token","pRestful","FrameManager","prepareData","setUrl","view","subUrl","getInfoUrl","processDef","processDefinitionId","document","write","formIdList","loadPage","closeDlg","$timeout","$formCoreService","$filter","$gmTable","$on","angularEvent","src","pParams","targetScope","$handOverService","directive","restrict","link","transclution","factory","getDraftAttaches","subType","getAttachesFromRedis","queryTree","seqNo","zlx","folderData","strId","strFileId","fileData","treeNodes","bCliam","arrayNodes","getAllNodes","_isFileEnable","nodeType","jj","_isFileNecessary","initTree","treeScope","sSubType","sSeqNo","processid","pTreeNode","BaseCapture","nWindowHeight","nHeight","nWidth","DotNetCapture","tableData","options","camera","resolution","_innitLayout","_initEvent","_modifyLayout","device_camera","CameraStop","Init","strCameras","getDeviceNames","arrayCameras","isStrNullOrEmpty","CameraConn","selectCamera","String","arrayResolutions","_getResolutions","selectResolution","remove","chooseCamera","nIndex","nSelectIndex","Number","chooseResolution","nResolutionIndex","updateCamera","updateDevice","shoot","strBase64","MakeCapture","uploadStatus","reshoot","viewImg","pItem","imgBase64","deleteItem","pUploadItem","pResult","uploadBase64","on","destory","bind","strResolutions","getVideoResolutions","capture","getVertion","validation","dlg","nextNodes","handOverConfig","checkNode","_getHandOverChecks","handOverVar","_getHandOverTarget","isOnlyLastNode","userArray","subArray","childrens","groups","users","chooseRole","checkItem","_checkItem","modelHandOver","_doHandOver","unselectUser","_unselect","selectedUsers","flag","_selectUser","user","bFlag","_uncheckTreeUser","_uncheckUserOnTree","cur","nodeName","check","variables","arrayIds","targets","_handOver","_saveBizFlowInfo","sMsg","strBoxName","handOverParam","_getBizInfo","var","exports","$rootScope","$agencyService","queryData","queryPendingData","agencyForm","userData","pendingPage","erron","orderField","current","tagData","tags","checkTag","xmjd","config","submitterName","refer","delet","goProcess","processUrl","getHtmlPath","goPending","activeNaviFromPath","queryCompleteData","completeForm","operate","icon","targetTaskKey","receiverName","$draftService","queryDraftData","draftForm","cgData","regions","areas","treearea","attvalue","xmysubh","xmmc","xzqmc","zgm","ztz","xmlx","$protocolService","permissions","queryDraft","draftData","draftProcess","goToDraft","queryExtraBizFields","queryStartData","start","getQuery","query","processDate","timeStamp","date","getProcessCatalogs","wf","edit","editProcessCatalog","delete","deleteProcessCatalog","roles"],"mappings":"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","file":"form-44834.bundle.js","sourcesContent":["try {\r\n    angular.module('frameApp');\r\n} catch (ex) {\r\n    angular.module('frameApp', ['ui.router', 'ngAnimate', 'gm.ngCustom.control', 'ngResource', 'ngSanitize', 'ngCookies']);\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/app.js","//定义表单通用API\r\n//表单对象命名空间\r\n//表单对象命名空间\r\nGM.Form = {};\r\n\r\n/**\r\n * @description 流程表单通用接口类\r\n * @class GM.Form.CommonOper\r\n */\r\nGM.Form.CommonOper = {\r\n    /**\r\n     * 展示成功信息\r\n     * @param {String} msg 成功信息\r\n     */\r\n    showSuccessMsg: function (msg) {\r\n        GM.Infomation.show(msg, {\r\n            type: 'success',\r\n            placement: 'center'\r\n        });\r\n    },\r\n    /**\r\n     * 展示失败信息\r\n     * @param {String} msg 失败信息\r\n     */\r\n    showFailureMsg: function (msg) {\r\n        GM.Infomation.show(msg, {\r\n            type: 'danger',\r\n            placement: 'center'\r\n        });\r\n    },\r\n    getUUID: function () {\r\n        var chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split('');\r\n        var uuid = [],\r\n            i;\r\n        var radix = 16 || chars.length;\r\n\r\n        if (32) {\r\n            // Compact form\r\n            for (i = 0; i < 32; i++) {\r\n                uuid[i] = chars[0 | Math.random() * radix];\r\n            }\r\n        } else {\r\n            // rfc4122, version 4 form\r\n            var r;\r\n\r\n            // rfc4122 requires these characters\r\n            uuid[8] = uuid[13] = uuid[18] = uuid[23] = '-';\r\n            uuid[14] = '4';\r\n\r\n            // Fill in random data. At i==19 set the high bits of clock sequence\r\n            // as\r\n            // per rfc4122, sec. 4.1.5\r\n            for (i = 0; i < 36; i++) {\r\n                if (!uuid[i]) {\r\n                    r = 0 | Math.random() * radix;\r\n                    uuid[i] = chars[(i == 19) ? (r & 0x3) | 0x8 : r];\r\n                }\r\n            }\r\n        }\r\n\r\n        return uuid.join('');\r\n    },\r\n    /**\r\n     * 展示一个对话框\r\n     * @param url 对话框内容URL\r\n     * @param size 对话框尺寸类型：lg、sm、fullscreen、''默认大小\r\n     * @param reload 关闭对话框时的回调函数\r\n     */\r\n    showDialog: function (url, title, size, callback) {\r\n        var w, h;\r\n\r\n        var option = {\r\n            iframe: url + ((url.indexOf('?') > -1 ? '&' : '?') + 'version=' + new Date()),\r\n            title: title,\r\n            backdrop: 'static'\r\n        };\r\n\r\n        if (size && size.indexOf(',') > -1) {\r\n            var arrSize = size.split(',');\r\n\r\n            try {\r\n                w = parseInt(arrSize[0]) + 'px';\r\n            } catch (e) {\r\n                w = '1000px';\r\n            }\r\n\r\n            try {\r\n                h = parseInt(arrSize[1]) + 'px';\r\n            } catch (e) {\r\n                h = '800px';\r\n            }\r\n\r\n            option['width'] = w;\r\n            option['height'] = h;\r\n        } else {\r\n            option['size'] = size;\r\n        }\r\n\r\n        var myModalTrigger = new $.zui.ModalTrigger(option);\r\n\r\n        myModalTrigger.show({\r\n            hidden: function () {\r\n                if (callback) {\r\n                    callback();\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /**\r\n     * 取数组元素中对应属性的值组成新的数组\r\n     * @param array\r\n     * @param field\r\n     * @returns {Array}\r\n     */\r\n    mapFieldArray: function (array, field) {\r\n        var result = [];\r\n\r\n        for (var i = 0; i < array.length; i++) {\r\n            if (typeof (array[i]) === 'object' && array[i][field]) {\r\n                result.push(array[i][field]);\r\n            }\r\n        }\r\n\r\n        return result;\r\n    },\r\n    /**\r\n     * 同步执行GET\r\n     *\r\n     * @param {String} url                  url地址\r\n     * @param {Function} successCallback    成功时的回调函数\r\n     * @param {Function} errorCallback      失败时的回调函数\r\n     * @param {Object} param                传入数据\r\n     */\r\n    syncAjaxGet: function (url, successCallback, errorCallback, param) {\r\n        this._syncAjax('GET', url, successCallback, errorCallback, param);\r\n    },\r\n    /**\r\n     * 同步执行POST\r\n     *\r\n     * @param {String} url                  url地址\r\n     * @param {Function} successCallback    成功时的回调函数\r\n     * @param {Function} errorCallback      失败时的回调函数\r\n     * @param {Object} param                传入数据\r\n     */\r\n    syncAjaxPost: function (url, successCallback, errorCallback, param) {\r\n        this._syncAjax('POST', url, successCallback, errorCallback, param);\r\n    },\r\n    _syncAjax: function (type, url, successCallback, errorCallback, param) {\r\n        var opt = {\r\n            url: url,\r\n            async: false,\r\n            type: type,\r\n            success: function (res) {\r\n                successCallback(res);\r\n            },\r\n            error: function (res) {\r\n                errorCallback(res);\r\n            }\r\n        };\r\n\r\n        if (param) {\r\n            opt.data = param;\r\n        }\r\n\r\n        $.ajax(opt);\r\n    },\r\n    /**\r\n     * 获取金额大写\r\n     * @param {Number} n\r\n     */\r\n    getCnFormatMoney: function (n) {\r\n        var fraction = ['角', '分'];\r\n        var digit = [\r\n            '零', '壹', '贰', '叁', '肆',\r\n            '伍', '陆', '柒', '捌', '玖'\r\n        ];\r\n        var unit = [\r\n            ['元', '万', '亿'],\r\n            ['', '拾', '佰', '仟']\r\n        ];\r\n        var head = n < 0 ? '欠' : '';\r\n        n = Math.abs(n);\r\n        var s = '';\r\n        for (var i = 0; i < fraction.length; i++) {\r\n            s += (digit[Math.floor(n * 10 * Math.pow(10, i)) % 10] + fraction[i]).replace(/零./, '');\r\n        }\r\n        s = s || '整';\r\n        n = Math.floor(n);\r\n        for (var i = 0; i < unit[0].length && n > 0; i++) {\r\n            var p = '';\r\n            for (var j = 0; j < unit[1].length && n > 0; j++) {\r\n                p = digit[n % 10] + unit[1][j] + p;\r\n                n = Math.floor(n / 10);\r\n            }\r\n            s = p.replace(/(零.)*零$/, '').replace(/^$/, '零') + unit[0][i] + s;\r\n        }\r\n        return head + s.replace(/(零.)*零元/, '元')\r\n            .replace(/(零.)+/g, '零')\r\n            .replace(/^整$/, '零元整');\r\n    },\r\n    setObjectAttrVal: function (obj, exp, index, val) {\r\n        if (!obj) {\r\n            return;\r\n        }\r\n\r\n        var arr = exp.split('.');\r\n\r\n        if (index == arr.length - 1) {\r\n            obj[arr[index]] = val;\r\n            return;\r\n        }\r\n\r\n        obj = obj[arr[index]];\r\n        index++;\r\n\r\n        this.setObjectAttrVal(obj, exp, index, val);\r\n    },\r\n    cloneObject: function (obj) {\r\n        // Handle the 3 simple types, and null or undefined\r\n        if (null == obj || 'object' !== typeof obj) return obj;\r\n\r\n        // Handle Date\r\n        if (obj instanceof Date) {\r\n            var copy = new Date();\r\n            copy.setTime(obj.getTime());\r\n            return copy;\r\n        }\r\n\r\n        // Handle Array\r\n        if (obj instanceof Array) {\r\n            var copy = [];\r\n            for (var i = 0, len = obj.length; i < len; ++i) {\r\n                copy[i] = GM.Form.CommonOper.cloneObject(obj[i]);\r\n            }\r\n            return copy;\r\n        }\r\n\r\n        // Handle Object\r\n        if (obj instanceof Object) {\r\n            var copy = {};\r\n            for (var attr in obj) {\r\n                if (obj.hasOwnProperty(attr)) copy[attr] = GM.Form.CommonOper.cloneObject(obj[attr]);\r\n            }\r\n            return copy;\r\n        }\r\n\r\n        throw new Error(\"Unable to copy obj! Its type isn't supported.\");\r\n    },\r\n    /**\r\n     * @description 展示地图对话框\r\n     */\r\n    showMapDialog: function () {\r\n        if (window.frames['processMap'].pMap == null) {\r\n            //第一次加载\r\n            $('#mapViewDialog').dialog({\r\n                title: '地图查看',\r\n                autoOpen: false,\r\n                resizeable: true,\r\n                draggable: true,\r\n                show: {\r\n                    effect: 'fadeIn',\r\n                    duration: 500\r\n                },\r\n                hide: {\r\n                    effect: 'fadeOut',\r\n                    duration: 500\r\n                },\r\n                modal: false,\r\n                width: 1200,\r\n                height: 500,\r\n                zIndex: 100,\r\n                position: {\r\n                    my: 'right bottom',\r\n                    at: 'right bottom',\r\n                    of: window\r\n                }\r\n            });\r\n            var pLocation = parent.location;\r\n            var strPathName = pLocation.pathname;\r\n            if (strPathName.toLowerCase().substr(strPathName.length - 4, 4) === 'html') {\r\n                strPathName = GM.FilePath.getDirName(strPathName);\r\n            } else if (strPathName.toLowerCase().substr(strPathName.length - 1, 1) === '\\/') {\r\n                strPathName = strPathName.substr(0, strPathName.length - 1);\r\n            }\r\n            window.frames['processMap'].location.href = pLocation.origin + strPathName + '/map.html';\r\n        }\r\n        $('#mapViewDialog').dialog('open');\r\n    }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/base/api.js","import 'formCommonApi';\r\n\r\n/**\r\n * 流程表单数据通用操作类\r\n * @class GM.Form.FormData\r\n */\r\nGM.Form.FormData = {\r\n\t/**\r\n\t * 初始化\r\n\t */\r\n\tinit: function(formid) {\r\n\t\tthis._initScopeVar();\r\n\t\tthis._bindEvents(formid);\r\n\r\n\t\tGM.Form.formScope.gridQueryParams = {\r\n\t\t\tqueryType: undefined,\r\n\t\t\tqueryValue: undefined\r\n\t\t};\r\n\r\n\t\t//加载表单时，初始化表单上所有的数据列表对象\r\n\t\tif(GM.Form.parameters.formDataSourceNames && GM.Form.parameters.formDataSourceNames.length > 0) {\r\n\t\t\tthis._initOptions(GM.Form.formScope, GM.Form.parameters.formDataSourceNames);\r\n\t\t}\r\n\t},\r\n\t_datas: {\r\n\t\tglobe: {}, //全局数据对象\r\n\t\tsaveKeys: {} //有表单出现多次时，保存的判断依据\r\n\t},\r\n\t_initScopeVar: function() {\r\n\t\tGM.Form.formScope.result = {}; //当前表单数据对象\r\n\t},\r\n\t_bindEvents: function(formid) {\r\n\t\tvar _this = this;\r\n\r\n\t\t//获取数据\r\n\t\tGM.Form.formScope.getData = function() {\r\n\t\t\t//if(!GM.Form.parameters.urlParams.did && !GM.Form.parameters.urlParams.duuid) {\r\n\t\t\tif(GM.Form.parameters.urlParams.startFlag !== '1') {\r\n\t\t\t\t_this._getData(formid);\r\n\t\t\t} else if(GM.Form.parameters.urlParams.did) {\r\n\t\t\t\t_this._getDraftData(GM.Form.parameters.urlParams.did);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t//保存数据\r\n\t\tGM.Form.formScope.save = function(successCallback, failureCallback) {\r\n\t\t\t_this._saveData(false, successCallback, failureCallback);\r\n\t\t};\r\n\r\n\t\t//保存数据并移交\r\n\t\tGM.Form.formScope.saveAndHandOver = function() {\r\n\t\t\t_this._saveData(true);\r\n\t\t};\r\n\r\n\t\tGM.Form.formScope.saveDraft = function() {\r\n\t\t\t_this._saveDraft(GM.Form.parameters.urlParams.duuid || GM.Form.parameters.urlParams.did);\r\n\t\t};\r\n\r\n\t\tGM.Form.formScope.getSingleDataGrid = function(formid, ds) {\r\n\t\t\t_this._getSingleDataGrid(GM.Form.formScope, formid, ds);\r\n\t\t};\r\n\r\n\t\tGM.Form.formScope.dataGridSelect = function(item) {\r\n\t\t\t_this._dataGridSelect(GM.Form.formScope, item);\r\n\t\t\titem.grid.appScope.closeThisDialog();\r\n\t\t};\r\n\r\n\t\tGM.Form.formScope.saveDialog = function(ds) {\r\n\t\t\t_this._saveDialog(ds);\r\n\t\t\tGM.Form.formScope.closeFormDialog();\r\n\t\t};\r\n\r\n\t\tGM.Form.formScope.newDataGridRecord = function(url, formid, title, buttons) {\r\n\t\t\t//clearFormDialog();\r\n\t\t\tGM.Form.parameters.dataGridNewFlag = true;\r\n\r\n\t\t\tif(!GM.CommonOper.isArrayContainsEle(GM.Form.parameters.savingFormIds, formid)) {\r\n\t\t\t\tGM.Form.parameters.savingFormIds.push(formid);\r\n\t\t\t}\r\n\r\n\t\t\tGM.Form.formScope.showFormDialog(url, formid, title, buttons, true);\r\n\t\t};\r\n\r\n\t\tGM.Form.formScope.dgA = function(item) {\r\n\t\t\t_this._dataGridOperA(GM.Form.formScope, item);\r\n\t\t};\r\n\r\n\t\tGM.Form.formScope.dgB = function(item) {\r\n\t\t\t_this._dataGridOperB(GM.Form.formScope, item);\r\n\t\t};\r\n\r\n\t\tGM.Form.formScope.getRedisString = function(key) {\r\n\t\t\treturn _this._getRedisString(key);\r\n\t\t};\r\n\r\n\t\tGM.Form.formScope.removeRedisString = function(key) {\r\n\t\t\t_this._removeRedisString(key);\r\n\t\t};\r\n\r\n\t\tGM.Form.formScope.redisString = function(key, data) {\r\n\t\t\t_this._redisString(key, data);\r\n\t\t};\r\n\r\n\t\tGM.Form.formScope.initDataGridOptions = function(formid) {\r\n\t\t\t_this._initDataGridOptions(GM.Form.formScope, formid);\r\n\t\t};\r\n\r\n\t\tGM.Form.formScope.initDataGridHeaders = function(ds, fieldString, operString) {\r\n\t\t\t_this._getGridOption(GM.Form.formScope, ds, null, null, fieldString, operString);\r\n\t\t};\r\n\t},\r\n\t/**\r\n\t * 初始化表单上所有数据列表控件数据源\r\n\t *\r\n\t * @param {Object} scope    当前作用域\r\n\t * @param {Array} dgds      所有数据列表的数据源别名列表\r\n\t */\r\n\t_initOptions: function(scope, dgds) {\r\n\t\tif(!dgds || dgds.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfor(var i = 0; i < dgds.length; i++) {\r\n\t\t\tif(dgds[i]) {\r\n\t\t\t\tvar grid = $(\"div[ui-grid='\" + dgds[i] + \"Option']\");\r\n\t\t\t\tvar sDataItems, sTemplateItems;\r\n\r\n\t\t\t\tif(grid.length > 0) {\r\n\t\t\t\t\tsDataItems = grid.attr('data-items');\r\n\t\t\t\t\tsTemplateItems = grid.attr('template-items');\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._getGridOption(scope, dgds[i], null, null, sDataItems, sTemplateItems);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t/**\r\n\t * 根据formid初始化相关的所有数据列表对象\r\n\t *\r\n\t * @param {Object} scope 当前作用域\r\n\t * @param {String} formid 表单ID\r\n\t */\r\n\t_initDataGridOptions: function(scope, formid) {\r\n\t\tvar _this = this;\r\n\t\tvar url = window.FORM_REST_URL.workflow.getDataGridDataSourceNames + '?formids=' + formid;\r\n\t\tGM.Form.CommonOper.syncAjaxGet(url, function(res) {\r\n\t\t\tif(res.success === true && res.data) {\r\n\t\t\t\t_this._initOptions(scope, res.data);\r\n\t\t\t}\r\n\t\t}, function(res) {});\r\n\t},\r\n\t/**\r\n\t * 获取Redis缓存的数据\r\n\t *\r\n\t * @param {String} key 键\r\n\t */\r\n\t_getRedisString: function(key) {\r\n\t\tvar result;\r\n\t\tGM.Form.CommonOper.syncAjaxGet(window.FORM_REST_URL.workflow.getRedisString + '?key=' + key, function(res) {\r\n\t\t\tif(res.success === true && !!res.data) {\r\n\t\t\t\tresult = res.data;\r\n\t\t\t}\r\n\t\t}, function(res) {});\r\n\r\n\t\treturn result;\r\n\t},\r\n\t/**\r\n\t * 删除Redis缓存的数据\r\n\t *\r\n\t * @param {String} key 键\r\n\t */\r\n\t_removeRedisString: function(key) {\r\n\t\tGM.Form.CommonOper.syncAjaxGet(window.FORM_REST_URL.workflow.removeRedisString + '?key=' + key, function(res) {}, function(res) {});\r\n\t},\r\n\t/**\r\n\t * 缓存数据到Redis\r\n\t *\r\n\t * @param {String} key 键\r\n\t * @param {String} data 数据\r\n\t */\r\n\t_redisString: function(key, data) {\r\n\t\tGM.Form.CommonOper.syncAjaxPost(window.FORM_REST_URL.workflow.getRedisString + '?key=' + key, function(res) {}, function(res) {}, {\r\n\t\t\tkey: key,\r\n\t\t\tdata: data\r\n\t\t});\r\n\t},\r\n\t/**\r\n\t * 数据列表通用操作之一：弹出对话框\r\n\t *\r\n\t * @param {Object} scope    当前作用域\r\n\t * @param {Object} item     当前行对象\r\n\t */\r\n\t_dataGridOperA: function(scope, item) {\r\n\t\tvar ele = event.srcElement;\r\n\r\n\t\tif(!ele) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar linkText = $(ele).text();\r\n\t\tvar templates = item.grid.element.attr('template-items').split(',');\r\n\t\tvar formid, title, buttons;\r\n\r\n\t\tfor(var i = 0; i < templates.length; i++) {\r\n\t\t\tvar arr = templates[i].split(':');\r\n\r\n\t\t\tif(arr.length < 3) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif(arr[1] == linkText) {\r\n\t\t\t\tformid = arr[2];\r\n\t\t\t\ttitle = arr[1];\r\n\t\t\t\tbuttons = arr[3].replace(/%/g, ',').replace(/\\$/g, ':');\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(formid) {\r\n\t\t\tthis._showDataGridDlg(scope, item, formid, null, title, buttons);\r\n\t\t}\r\n\t},\r\n\t/**\r\n\t * 数据列表通用操作之二：调用REST服务\r\n\t *\r\n\t * @param {Object} scope    当前作用域\r\n\t * @param {Object} item     当前行对象\r\n\t */\r\n\t_dataGridOperB: function(scope, item) {\r\n\t\tvar ele = event.srcElement;\r\n\r\n\t\tif(!ele) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar linkText = $(ele).text();\r\n\t\tvar templates = item.grid.element.attr('template-items').split(',');\r\n\t\tvar service, method, tip, msg;\r\n\r\n\t\tfor(var i = 0; i < templates.length; i++) {\r\n\t\t\tvar arr = templates[i].split(':');\r\n\r\n\t\t\tif(arr.length < 3) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif(arr[1] == linkText) {\r\n\t\t\t\tservice = arr[2];\r\n\r\n\t\t\t\tif(arr[3]) {\r\n\t\t\t\t\tmethod = arr[3];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(arr[4]) {\r\n\t\t\t\t\ttip = arr[4].replace(/RDS_COLON/g, ':').replace(/RDS_COMMA/g, ',');\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(arr[5]) {\r\n\t\t\t\t\tmsg = arr[5];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar _this = this;\r\n\r\n\t\tif(!GM.Form.parameters.urlParams.ywh && (linkText == '删除' || $(ele).attr('title') == '删除')) {\r\n\t\t\tif(tip) {\r\n\t\t\t\tGM.Alert.show('提示', tip, {\r\n\t\t\t\t\tshowCancelButton: true\r\n\t\t\t\t}, function() {\r\n\t\t\t\t\t_this._deleteDataGridRecordWithoutBizKey(scope, item);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t_this._deleteDataGridRecordWithoutBizKey(scope, item);\r\n\t\t\t}\r\n\t\t} else if(service) {\r\n\t\t\tif(tip) {\r\n\t\t\t\tGM.Alert.show('提示', tip, {\r\n\t\t\t\t\tshowCancelButton: true\r\n\t\t\t\t}, function() {\r\n\t\t\t\t\t_this._invokeDataGridREST(scope, item, service, method, msg);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t_this._invokeDataGridREST(scope, item, service, method, msg);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t_deleteDataGridRecordWithoutBizKey: function(scope, item) {\r\n\t\tvar $dgid = item.entity.$$dgid;\r\n\r\n\t\tif($dgid) {\r\n\t\t\tvar uiGrid = item.grid.element.attr('ui-grid');\r\n\t\t\tvar prefix = 'list$' + uiGrid.replace('Option', '') + '$';\r\n\r\n\t\t\tfor(var key in scope) {\r\n\t\t\t\tif(key.indexOf(prefix) === 0) {\r\n\t\t\t\t\tfor(var i = 0; i < scope[key].length; i++) {\r\n\t\t\t\t\t\tif(scope[key][i]['$$dgid'] == $dgid) {\r\n\t\t\t\t\t\t\tGM.CommonOper.removeItemFromArray(scope[key], scope[key][i], '$$dgid');\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(scope[uiGrid].data) {\r\n\t\t\t\t\t\tfor(var i = 0; i < scope[uiGrid].data.length; i++) {\r\n\t\t\t\t\t\t\tif(scope[uiGrid].data[i]['$$dgid'] == $dgid) {\r\n\t\t\t\t\t\t\t\tGM.CommonOper.removeItemFromArray(scope[uiGrid].data, scope[uiGrid].data[i], '$$dgid');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t/**\r\n\t * 数据列表通用操作之一：弹出对话框\r\n\t *\r\n\t * @param {Object} scope    当前作用域\r\n\t * @param {Object} item     当前行对象\r\n\t * @param {String} formid   弹出对话框的formid\r\n\t * @param {String} url      弹出对话框的url\r\n\t * @param {String} title    弹出对话框的标题\r\n\t * @param {String} buttons  弹出对话框的按钮\r\n\t */\r\n\t_showDataGridDlg: function(scope, item, formid, url, title, buttons) {\r\n\t\tGM.Form.FormEngine.clearTemporaryUrlParameters();\r\n\t\tvar ds = item.grid.element.attr('data-items');\r\n\t\tvar uiGrid = item.grid.element.attr('ui-grid');\r\n\r\n\t\tif(uiGrid) {\r\n\t\t\tuiGrid = uiGrid.replace('Option', '');\r\n\t\t}\r\n\r\n\t\tif(!GM.Form.parameters.urlParams.ywh) {\r\n\t\t\t//如果是新增，需要先从当前作用域中获取已编辑的数据\r\n\t\t\tvar alias;\r\n\t\t\tvar prefix = 'list$' + uiGrid;\r\n\t\t\tvar $dgid = item.entity.$$dgid;\r\n\r\n\t\t\tfor(var i = 0; i < GM.Form.parameters.formAlias.length; i++) {\r\n\t\t\t\tif(GM.Form.parameters.formAlias[i].formid == formid) {\r\n\t\t\t\t\talias = GM.Form.parameters.formAlias[i].alias;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif(alias) {\r\n\t\t\t\tfor(var key in alias) {\r\n\t\t\t\t\tif(scope[prefix + '$' + key]) {\r\n\t\t\t\t\t\tfor(var i = 0; i < scope[prefix + '$' + key].length; i++) {\r\n\t\t\t\t\t\t\tif(scope[prefix + '$' + key][i]['$$dgid'] == $dgid) {\r\n\t\t\t\t\t\t\t\tscope.result[key] = scope[prefix + '$' + key][i];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif(!GM.CommonOper.isArrayContainsEle(GM.Form.parameters.savingFormIds, formid)) {\r\n\t\t\t\tGM.Form.parameters.savingFormIds.push(formid);\r\n\t\t\t}\r\n\r\n\t\t\tGM.Form.formScope.showFormDialog(url, formid, title, buttons);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//向弹出的对话框作用域传入相关参数\r\n\t\tif(ds) {\r\n\t\t\tvar arr = ds.split(',');\r\n\r\n\t\t\tfor(var u = 0; u < arr.length; u++) {\r\n\t\t\t\tif(arr[u]) {\r\n\t\t\t\t\tvar arrDataItems = arr[u].split(':');\r\n\r\n\t\t\t\t\tif(arrDataItems.length === 3) {\r\n\t\t\t\t\t\tvar field = arrDataItems[0];\r\n\r\n\t\t\t\t\t\tif(field.indexOf('*') === 0) {\r\n\t\t\t\t\t\t\tfield = field.substring(1, field.length);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tGM.Form.parameters.urlParams[arrDataItems[2]] = item.entity[field];\r\n\r\n\t\t\t\t\t\tif(!GM.CommonOper.isArrayContainsEle(GM.Form.parameters.urlTempParams, arrDataItems[2])) {\r\n\t\t\t\t\t\t\tGM.Form.parameters.urlTempParams.push(arrDataItems[2]);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tGM.Form.formScope.showFormDialog(url, formid, title, buttons);\r\n\t\tthis._getData(formid, true);\r\n\t},\r\n\t/**\r\n\t * 数据列表通用操作之二：调用REST服务\r\n\t *\r\n\t * @param {Object} scope    当前作用域\r\n\t * @param {Object} item     当前行对象\r\n\t * @param {String} service  调用的service\r\n\t * @param {String} method   GET 或者 POST等\r\n\t * @param {String} msg      调用成功后的提示信息\r\n\t */\r\n\t_invokeDataGridREST: function(scope, item, service, method, msg) {\r\n\t\tif(!RESTURL.dg || !RESTURL.dg[service]) {\r\n\t\t\tGM.Form.CommonOper.showFailureMsg('未配置[' + service + ']服务。');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar _this = this;\r\n\r\n\t\tvar formid = item.grid.element.attr('formid');\r\n\t\tvar dataItems = item.grid.element.attr('data-items');\r\n\t\tvar ds = item.grid.element.attr('ui-grid');\r\n\r\n\t\tif(ds) {\r\n\t\t\tds = ds.replace('Option', '');\r\n\t\t}\r\n\r\n\t\tvar param = {};\r\n\r\n\t\t//向弹出的对话框作用域传入相关参数\r\n\t\tif(dataItems) {\r\n\t\t\tvar arr = dataItems.split(',');\r\n\r\n\t\t\tfor(var u = 0; u < arr.length; u++) {\r\n\t\t\t\tif(arr[u]) {\r\n\t\t\t\t\tvar arrDataItems = arr[u].split(':');\r\n\r\n\t\t\t\t\tif(arrDataItems.length === 3) {\r\n\t\t\t\t\t\tvar field = arrDataItems[0];\r\n\r\n\t\t\t\t\t\tif(field.indexOf('*') === 0) {\r\n\t\t\t\t\t\t\tfield = field.substring(1, field.length);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tparam[arrDataItems[2]] = item.entity[field];\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar invoke;\r\n\r\n\t\tif(method && method.toUpperCase() == 'POST') {\r\n\t\t\tinvoke = GM.Form.restful.post(window.RESTURL.dg[service], param);\r\n\t\t} else {\r\n\t\t\tinvoke = GM.Form.restful.get(window.RESTURL.dg[service], param);\r\n\t\t}\r\n\r\n\t\tinvoke.then(function(res) {\r\n\t\t\tif(res.success === true && !!formid && !!ds) {\r\n\t\t\t\t_this._getSingleDataGrid(scope, formid, ds);\r\n\t\t\t} else if(res.success === false) {\r\n\t\t\t\tGM.Form.CommonOper.showFailureMsg(res.message);\r\n\t\t\t}\r\n\t\t}, function(res) {\r\n\t\t\tGM.Form.CommonOper.showFailureMsg(res.message);\r\n\t\t});\r\n\t},\r\n\t/**\r\n\t * 将选定的项目相关的信息展示在页面上\r\n\t *\r\n\t * @param {Object} scope\r\n\t * @param {Object} item\r\n\t */\r\n\t_dataGridSelect: function(scope, item) {\r\n\t\tvar ds = item.grid.element.attr('ui-grid');\r\n\r\n\t\tif(ds) {\r\n\t\t\tds = ds.replace('Option', '');\r\n\t\t\tvar paras = scope[ds + 'KeyParas'];\r\n\r\n\t\t\tif(paras && paras.length > 0) {\r\n\t\t\t\tfor(var u = 0; u < paras.length; u++) {\r\n\t\t\t\t\tGM.Form.parameters.urlParams[paras[u].para] = item.entity[paras[u].key];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif(scope.gridQueryParams && !!scope.gridQueryParams.queryType && !!scope.gridQueryParams.queryValue) {\r\n\t\t\t\tGM.Form.parameters.urlParams.searchType = scope.gridQueryParams.queryType;\r\n\t\t\t\tGM.Form.parameters.urlParams.searchValue = scope.gridQueryParams.queryValue;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._getData(false, true);\r\n\t\tscope.closeFormDialog();\r\n\t},\r\n\t/**\r\n\t * 刷新单个数据列表\r\n\t *\r\n\t * @param {Object} scope    当前作用域\r\n\t * @param {String} formid   数据列表所在表单formid\r\n\t * @param {String} ds       数据列表的数据源别名\r\n\t */\r\n\t_getSingleDataGrid: function(scope, formid, ds) {\r\n\t\tif(!GM.Form.parameters.urlParams.ywh) {\r\n\t\t\tfor(var key in scope) {\r\n\t\t\t\tif(key.indexOf('list$' + ds) === 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar _this = this;\r\n\t\tvar para = angular.copy(GM.Form.parameters.urlParams);\r\n\r\n\t\tif(!para.ywh) {\r\n\t\t\tpara.ywh = para.did || para.duuid;\r\n\t\t}\r\n\r\n\t\tif(scope.gridQueryParams.queryValue) {\r\n\t\t\tpara.queryType = scope.gridQueryParams.queryType;\r\n\t\t\tpara.queryValue = scope.gridQueryParams.queryValue;\r\n\t\t\tscope.gridQueryParams = {\r\n\t\t\t\tqueryType: '',\r\n\t\t\t\tqueryValue: ''\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tvar up = {\r\n\t\t\t'up': para\r\n\t\t};\r\n\r\n\t\tvar param = {\r\n\t\t\tformids: formid,\r\n\t\t\tdataSourceName: ds,\r\n\t\t\turlParameters: JSON.stringify(up)\r\n\t\t};\r\n\t\tGM.Form.restful.get(GM.Form.parameters.servers.getSingleDataGridServer, param).then(function(res) {\r\n\t\t\tif(res.success === true && res.data) {\r\n\t\t\t\t_this._bindDataGrid(scope, ds, res.data);\r\n\t\t\t}\r\n\t\t}, function(res) {});\r\n\t},\r\n\t/**\r\n\t * 获取数据列表的相关配置\r\n\t *\r\n\t * @param {Object} scope            作用域\r\n\t * @param {String} ds               数据列表的数据源别名\r\n\t * @param {Array} data              数据\r\n\t * @param {Array} hd                表头列表\r\n\t * @param {String} dataItems        包含标题和字段对应关系的字符串（与hd不能同时为空）\r\n\t * @param {String} templateItems    操作列表\r\n\t */\r\n\t_getGridOption: function(scope, ds, data, hd, dataItems, templateItems) {\r\n\t\tvar gridOptionName = ds + 'Option';\r\n\t\tscope[gridOptionName] = {};\r\n\r\n\t\tvar gridOptions = {};\r\n\t\tvar tableGrid = new GM.Form.gmTable();\r\n\t\tvar templates = [],\r\n\t\t\theads = [];\r\n\r\n\t\tif(templateItems) {\r\n\t\t\tvar arrTemps = templateItems.split(',');\r\n\t\t\tfor(var i = 0; i < arrTemps.length; i++) {\r\n\t\t\t\tif(arrTemps[i] != '') {\r\n\t\t\t\t\tvar arr = arrTemps[i].split(':');\r\n\t\t\t\t\ttemplates.push({\r\n\t\t\t\t\t\tname: arr[1],\r\n\t\t\t\t\t\tclick: arr[0]\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(dataItems) {\r\n\t\t\tvar arrTemps = dataItems.split(',');\r\n\t\t\tvar gridParas = [];\r\n\r\n\t\t\tfor(var i = 0; i < arrTemps.length; i++) {\r\n\t\t\t\tif(!!arrTemps[i] && arrTemps[i].indexOf('*') !== 0) {\r\n\t\t\t\t\tvar arr = arrTemps[i].split(':');\r\n\t\t\t\t\theads.push({\r\n\t\t\t\t\t\tname: arr[0],\r\n\t\t\t\t\t\tdisplayName: arr[1],\r\n\t\t\t\t\t\tenableColumnMenu: false,\r\n\t\t\t\t\t\tcellTooltip: true\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif(arr.length === 3) {\r\n\t\t\t\t\t\tgridParas.push({\r\n\t\t\t\t\t\t\tkey: arr[0],\r\n\t\t\t\t\t\t\tpara: arr[2]\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif(gridParas.length > 0) {\r\n\t\t\t\tscope[ds + 'KeyParas'] = gridParas;\r\n\t\t\t}\r\n\t\t} else if(hd && hd.length > 0) {\r\n\t\t\tfor(var i = 0; i < hd.length; i++) {\r\n\t\t\t\theads.push({\r\n\t\t\t\t\tname: hd[i],\r\n\t\t\t\t\tdisplayName: hd[i],\r\n\t\t\t\t\tenableColumnMenu: false,\r\n\t\t\t\t\tcellTooltip: true\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(templates.length > 0) {\r\n\t\t\tvar strCellTemplate = tableGrid.getCellTemplate(templates);\r\n\r\n\t\t\theads.push({\r\n\t\t\t\tname: 'operate',\r\n\t\t\t\tdisplayName: '操作',\r\n\t\t\t\tenableColumnMenu: false,\r\n\t\t\t\tcellTemplate: strCellTemplate\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tgridOptions.data = data;\r\n\t\tgridOptions.columnDefs = heads;\r\n\t\tscope[gridOptionName] = gridOptions;\r\n\t\tGM.Form.timeout(function() {\r\n\t\t\ttableGrid.updateSize();\r\n\t\t}, 500);\r\n\t},\r\n\t_bindDataGrid: function(scope, ds, data) {\r\n\t\tvar _this = this;\r\n\r\n\t\tfor(var key in data) {\r\n\t\t\tif(!!ds && key != ds && key != 'page__' + ds) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif(key.indexOf('dg__') === 0) {\r\n\t\t\t\tif(!(data[key] instanceof Array)) {\r\n\t\t\t\t\tvar dgData = data[key];\r\n\t\t\t\t\tvar sDataItems = $(\"div[ui-grid='\" + key + \"Option']\").attr('data-items');\r\n\t\t\t\t\tvar sTemplateItems = $(\"div[ui-grid='\" + key + \"Option']\").attr('template-items');\r\n\r\n\t\t\t\t\t_this._getGridOption(scope, key, dgData.data.page.records, dgData.headList, sDataItems, sTemplateItems);\r\n\t\t\t\t} else if((scope.pstyle == 'landtree' || scope.isDataComplex === true) && scope.globalTreeData[key]) {\r\n\t\t\t\t\tscope.globalTreeData[key] = data[key];\r\n\t\t\t\t\t//updateDataGridsBind($scope.focusNode);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif(key && key.indexOf('page__') === 0) {\r\n\t\t\t\tscope[key] = data[key];\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t_getDraftData: function(key) {\r\n\t\tGM.Form.restful.get(RESTURL.process.getDraftInfo + '?id=' + key).then(function(response) {\r\n\t\t\tif(response.success === true && response.data != null) {\r\n\t\t\t\tGM.Form.formScope.result = JSON.parse(response.data);\r\n\t\t\t}\r\n\t\t}, function(response) {});\r\n\t},\r\n\t_saveDraft: function(key) {\r\n\t\tvar param = {\r\n\t\t\tid: key,\r\n\t\t\tuserId: top.GM.userInfo.loginName,\r\n\t\t\tappId: top.GM.AppInfo.id,\r\n\t\t\tprocessDefId: GM.Form.parameters.urlParams.processDefId,\r\n\t\t\tprocessName: GM.Form.parameters.urlParams.processName,\r\n\t\t\tprocessKey: GM.Form.parameters.urlParams.processKey\r\n\t\t};\r\n\r\n\t\tvar ctrl = angular.element(\"[data-role='bizname']\");\r\n\r\n\t\tif(ctrl && ctrl > 0) {\r\n\t\t\tparam.bizName = ctrl.val();\r\n\t\t}\r\n\r\n\t\tGM.Form.restful.get(RESTURL.process.saveDraftBaseInfo, param).then(function(res) {\r\n\t\t\tif(res.success === true) {\r\n\t\t\t\tparam = {\r\n\t\t\t\t\tid: key,\r\n\t\t\t\t\tdata: _this._getSavingData()\r\n\t\t\t\t};\r\n\t\t\t\tGM.Form.restful.post(RESTURL.process.saveDraftInfo, param).then(function(r) {\r\n\t\t\t\t\tif(r.success === true) {\r\n\t\t\t\t\t\tGM.Form.CommonOper.showSuccessMsg('保存成功！');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tGM.Form.CommonOper.showFailureMsg(r.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, function(r) {\r\n\t\t\t\t\tGM.Form.CommonOper.showFailureMsg(r.message);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}, function(res) {\r\n\t\t\tGM.Form.CommonOper.showFailureMsg(res.message);\r\n\t\t});\r\n\t},\r\n\t/**\r\n\t * 初始化页面数据\r\n\t *\r\n\t * @param {String} formid\r\n\t * @param {Boolean} keepOldData 是否保留原始数据\r\n\t */\r\n\t_getData: function(formid, keepOldData) {\r\n\t\tvar _this = this;\r\n\r\n\t\tvar params = {\r\n\t\t\tformids: (formid || GM.Form.parameters.formIds.join(',')),\r\n\t\t\turlParameters: JSON.stringify(GM.Form.parameters.urlParams)\r\n\t\t};\r\n\r\n\t\tGM.Form.restful.get(GM.Form.parameters.servers.getDataServer, params).then(function(res) {\r\n\t\t\tif(res.success === false) {\r\n\t\t\t\tGM.Form.CommonOper.showFailureMsg('页面加载数据失败：' + res.message);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t_this._datas.globe = res.data;\r\n\t\t\t\r\n\t\t\t//处理需要从REST服务调用的数据\r\n\t\t\tObject.keys(res.data).forEach(m => {\r\n\t\t\t\tif(m.startsWith(\"svc:\")) {\r\n\t\t\t\t\tlet sService = m.substring(4, m.length);\r\n\t\t\t\t\tGM.Form.CommonOper.syncAjaxGet(window.RESTURL.fr[sService] + \"?ywh=\" + GM.Form.parameters.urlParams.ywh).then(function(r){\r\n\t\t\t\t\t\tif(r.success === true && r.data) {\r\n\t\t\t\t\t\t\t_this._datas.globe[m] = r.data;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},function(r){\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t//console.log(_this._datas.globe);\r\n\t\t\t//console.log(GM.Form.formScope.result);\r\n\t\t\tif(!_this._datas.globe.treeKey) {\r\n\t\t\t\tif(!keepOldData) {\r\n\t\t\t\t\tGM.Form.formScope.result = _this._datas.globe;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfor(var key in GM.Form.formScope.result) {\r\n\t\t\t\t\t\tif(!_this._datas.globe[key]) {\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif(key.indexOf('dg__') < 0) {\r\n\t\t\t\t\t\t\tif(!$.isEmptyObject(_this._datas.globe[key]) &&\r\n\t\t\t\t\t\t\t\t$.isEmptyObject(GM.Form.formScope.result[key])) {\r\n\t\t\t\t\t\t\t\tGM.Form.formScope.result[key] = _this._datas.globe[key];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if(key.indexOf('dg__') === 0) {\r\n\t\t\t\t\t\t\tif(_this._datas.globe[key].data.page.records.length > 0 &&\r\n\t\t\t\t\t\t\t\tGM.Form.formScope.result[key].data.page.records.length === 0) {\r\n\t\t\t\t\t\t\t\tGM.Form.formScope.result[key] = _this._datas.globe[key];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if(key.indexOf('page__') === 0) {\r\n\t\t\t\t\t\t\tif(_this._datas.globe[key].totalItems > 0 &&\r\n\t\t\t\t\t\t\t\tGM.Form.formScope.result[key].totalItems === 0) {\r\n\t\t\t\t\t\t\t\tGM.Form.formScope.result[key] = _this._datas.globe[key];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor(var key in _this._datas.globe) {\r\n\t\t\t\t\t\tif(!GM.Form.formScope.result[key] || $.isEmptyObject(GM.Form.formScope.result[key])) {\r\n\t\t\t\t\t\t\tGM.Form.formScope.result[key] = _this._datas.globe[key];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tfor(var key in _this._datas.globe) {\r\n\t\t\t\t\tif(key == 'treeKey' || _this._datas.globe.treeKey[key]) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tGM.Form.formScope.result[key] = _this._datas.globe[key];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//初始化数据表格与其分页对象\r\n\t\t\t_this._bindDataGrid(GM.Form.formScope, null, _this._datas.globe);\r\n\t\t}, function(res) {\r\n\t\t\tGM.Form.CommonOper.showFailureMsg('页面加载数据失败：' + res.message);\r\n\t\t});\r\n\t},\r\n\t_getSavingData: function() {\r\n\t\tvar data;\r\n\r\n\t\tif(this._datas.globe.treeKey) {\r\n\t\t\t//this.updateGlobalData();\r\n\t\t\tdata = angular.copy(this._datas.globe);\r\n\t\t} else {\r\n\t\t\tdata = angular.copy(GM.Form.formScope.result);\r\n\t\t}\r\n\r\n\t\tdata = JSON.stringify(data);\r\n\t\treturn data;\r\n\t},\r\n\t/**\r\n\t * 将作用域中数据列表的临时数据更新到数据列表配置对象数据项中\r\n\t *\r\n\t * @param {Object} ds       数据列表别名\r\n\t */\r\n\t_setGridDataWithTempData: function(ds) {\r\n\t\tif(!GM.Form.formScope[ds + 'Option']) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar prefix = 'list$' + ds;\r\n\r\n\t\tfor(var key in GM.Form.formScope) {\r\n\t\t\tif(key.indexOf(prefix) < 0) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif(!GM.Form.formScope[ds + 'Option']['data'] || GM.Form.formScope[ds + 'Option']['data'].length === 0) {\r\n\t\t\t\tGM.Form.formScope[ds + 'Option']['data'] = [];\r\n\t\t\t}\r\n\r\n\t\t\tfor(var i = 0; i < GM.Form.formScope[key].length; i++) {\r\n\t\t\t\tvar dgId = GM.Form.formScope[key][i]['$$dgid'];\r\n\t\t\t\tvar jIndex;\r\n\r\n\t\t\t\tfor(var j = 0; j < GM.Form.formScope[ds + 'Option']['data'].length; j++) {\r\n\t\t\t\t\tif(GM.Form.formScope[ds + 'Option']['data'][j]['$$dgid'] == dgId) {\r\n\t\t\t\t\t\tjIndex = j;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(jIndex || jIndex === 0) {\r\n\t\t\t\t\tfor(var subKey in GM.Form.formScope[key][i]) {\r\n\t\t\t\t\t\tGM.Form.formScope[ds + 'Option']['data'][jIndex][subKey] = GM.Form.formScope[key][i][subKey];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tjIndex = undefined;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tGM.Form.formScope[ds + 'Option']['data'].push(angular.copy(GM.Form.formScope[key][i]));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tGM.Form.parameters.dataGridNewFlag = false;\r\n\t},\r\n\t_saveDialog: function(ds) {\r\n\t\tif(!GM.Form.formScope.dialogParameter.formid) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar _this = this;\r\n\r\n\t\t//如果业务号为空，则数据列表上添加的数据应该先不直接入库\r\n\t\tif(!GM.Form.parameters.urlParams.ywh) {\r\n\t\t\t//获取对话框表单内的数据对象\r\n\t\t\tvar serverUrl = window.FORM_REST_URL.workflow.getAnalyzedParam + '?formid=' + GM.Form.formScope.dialogParameter.formid;\r\n\t\t\tGM.Form.CommonOper.syncAjaxGet(serverUrl, function(res) {\r\n\t\t\t\tif(res.success === true) {\r\n\t\t\t\t\tvar $dgid, bHas;\r\n\r\n\t\t\t\t\tfor(var i = 0; i < GM.Form.parameters.formAlias.length; i++) {\r\n\t\t\t\t\t\tif(GM.Form.parameters.formAlias[i].formid == GM.Form.formScope.dialogParameter.formid) {\r\n\t\t\t\t\t\t\tGM.Form.parameters.formAlias[i].alias = angular.copy(res.data);\r\n\t\t\t\t\t\t\tbHas = true;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(!bHas) {\r\n\t\t\t\t\t\tGM.Form.parameters.formAlias.push({\r\n\t\t\t\t\t\t\tformid: GM.Form.formScope.dialogParameter.formid,\r\n\t\t\t\t\t\t\talias: angular.copy(res.data)\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor(var key in res.data) {\r\n\t\t\t\t\t\tif(!GM.Form.formScope.result[key]) {\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar lkey = 'list$' + ds + '$' + key;\r\n\r\n\t\t\t\t\t\tif(GM.Form.parameters.dataGridNewFlag || !GM.Form.formScope.result[key]['$$dgid']) {\r\n\t\t\t\t\t\t\tif(!$dgid) {\r\n\t\t\t\t\t\t\t\tGM.Form.CommonOper.syncAjaxGet(window.FORM_REST_URL.workflow.getUUID, function(r) {\r\n\t\t\t\t\t\t\t\t\t$dgid = r.data;\r\n\t\t\t\t\t\t\t\t}, function(r) {});\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tGM.Form.formScope.result[key]['$$dgid'] = $dgid;\r\n\r\n\t\t\t\t\t\t\tif(!GM.Form.formScope[lkey]) {\r\n\t\t\t\t\t\t\t\tGM.Form.formScope[lkey] = [];\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif(!GM.Form.formScope.result[key]['ROW_ID']) {\r\n\t\t\t\t\t\t\t\tGM.Form.formScope.result[key]['ROW_ID'] = GM.Form.formScope[lkey].length + 1;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tGM.Form.formScope[lkey].push(angular.copy(GM.Form.formScope.result[key]));\r\n\t\t\t\t\t\t\t_this._setGridDataWithTempData(ds);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tfor(var i = 0; i < GM.Form.formScope[lkey].length; i++) {\r\n\t\t\t\t\t\t\t\tif(GM.Form.formScope[lkey][i]['$$dgid'] == GM.Form.formScope.result[key]['$$dgid']) {\r\n\t\t\t\t\t\t\t\t\tGM.Form.formScope[lkey][i] = angular.copy(GM.Form.formScope.result[key]);\r\n\t\t\t\t\t\t\t\t\t_this._setGridDataWithTempData(ds);\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}, function(res) {});\r\n\t\t} else {\r\n\t\t\tvar paras = {};\r\n\t\t\tangular.copy(GM.Form.parameters.urlParams, paras);\r\n\r\n\t\t\tif(GM.Form.formScope.dialogParameter.params) {\r\n\t\t\t\tfor(var key in GM.Form.formScope.dialogParameter.params) {\r\n\t\t\t\t\tparas[key] = GM.Form.formScope.dialogParameter.params[key];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar param = {\r\n\t\t\t\tformids: GM.Form.formScope.dialogParameter.formid,\r\n\t\t\t\turlParameters: JSON.stringify(paras),\r\n\t\t\t\tkeys: JSON.stringify(_this._datas.saveKeys),\r\n\t\t\t\tdata: _this._getSavingData()\r\n\t\t\t};\r\n\r\n\t\t\tGM.Form.CommonOper.syncAjaxPost(GM.Form.parameters.servers.saveDataServer, function(res) {\r\n\t\t\t\tif(res.success === true) {\r\n\t\t\t\t\tGM.Form.CommonOper.showSuccessMsg('保存成功');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tGM.Form.CommonOper.showFailureMsg(res.message);\r\n\t\t\t\t}\r\n\t\t\t}, function(res) {\r\n\t\t\t\tGM.Form.CommonOper.showFailureMsg(res.message);\r\n\t\t\t}, param);\r\n\t\t}\r\n\t},\r\n\t/**\r\n\t * 将数据列表的临时数据赋予待保存对象中\r\n\t */\r\n\t_pretreatedSavingData: function() {\r\n\t\tfor(var key in GM.Form.formScope) {\r\n\t\t\tif(key.indexOf('list$') < 0) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tvar arr = key.split('$');\r\n\r\n\t\t\tif(arr.length < 3) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tvar alia = arr[2];\r\n\t\t\tvar data = GM.Form.formScope[key];\r\n\r\n\t\t\tfor(var subKey in GM.Form.formScope.result) {\r\n\t\t\t\tif(alia == subKey) {\r\n\t\t\t\t\tif(!(GM.Form.formScope.result[subKey] instanceof Array)) {\r\n\t\t\t\t\t\tGM.Form.formScope.result[subKey] = [];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor(var i = 0; i < data.length; i++) {\r\n\t\t\t\t\t\tvar jIndex = -1;\r\n\r\n\t\t\t\t\t\tfor(var j = 0; j < GM.Form.formScope.result[subKey].length; j++) {\r\n\t\t\t\t\t\t\tif(GM.Form.formScope.result[subKey][j]['$$dgid'] &&\r\n\t\t\t\t\t\t\t\tGM.Form.formScope.result[subKey][j]['$$dgid'] == data[i]['$$dgid']) {\r\n\t\t\t\t\t\t\t\tjIndex = j;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif(jIndex > -1) {\r\n\t\t\t\t\t\t\tGM.Form.formScope.result[subKey][j] = data[i];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tGM.Form.formScope.result[subKey].push(data[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t/**\r\n\t * 保存数据\r\n\t *\r\n\t * @param {Boolean} autoHandOver        保存成功之后是否自动移交\r\n\t * @param {Function} successCallback    保存成功之后回调\r\n\t * @param {Function} failureCallback    保存失败之后回调\r\n\t */\r\n\t_saveData: function(autoHandOver, successCallback, failureCallback) {\r\n\t\tvar _this = this;\r\n\r\n\t\tif(GM.Form.parameters.urlParams.startFlag == '1') {\r\n\t\t\t_this._pretreatedSavingData();\r\n\t\t}\r\n\r\n\t\tvar param = {\r\n\t\t\turlParameters: JSON.stringify(GM.Form.parameters.urlParams),\r\n\t\t\tkeys: JSON.stringify(_this._datas.saveKeys),\r\n\t\t\tdata: _this._getSavingData()\r\n\t\t};\r\n\r\n\t\tif(GM.Form.parameters.savingFormIds && GM.Form.parameters.savingFormIds.length > 0) {\r\n\t\t\tparam.formids = GM.Form.parameters.savingFormIds.join(',');\r\n\t\t} else {\r\n\t\t\tparam.formids = GM.Form.parameters.formIds.join(',');\r\n\t\t}\r\n\r\n\t\tGM.Form.CommonOper.syncAjaxPost(GM.Form.parameters.servers.saveDataServer, function(res) {\r\n\t\t\tif(res.success === true) {\r\n\t\t\t\tif(successCallback) {\r\n\t\t\t\t\tsuccessCallback();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(autoHandOver === true) {\r\n\t\t\t\t\tGM.Form.formScope.handOver();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tGM.Form.CommonOper.showSuccessMsg('保存成功');\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif(failureCallback) {\r\n\t\t\t\t\tfailureCallback();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tGM.Form.CommonOper.showFailureMsg(res.message);\r\n\t\t\t}\r\n\t\t}, function(res) {\r\n\t\t\tif(failureCallback) {\r\n\t\t\t\tfailureCallback();\r\n\t\t\t}\r\n\r\n\t\t\tGM.Form.CommonOper.showFailureMsg(res.message);\r\n\t\t}, param);\r\n\t}\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/base/form-data.js","import 'formCommonApi';\r\nimport 'formWorkflow';\r\nimport 'formData';\r\nimport 'formWebgis';\r\n\r\nGM.Form.formScope = undefined; //angular当前SCOPE\r\nGM.Form.restful = undefined; //RESTful服务调用对象\r\nGM.Form.validationObject = undefined; //页面\r\nGM.Form.ngDialog = undefined; //对话框组件\r\nGM.Form.gmTable = undefined; //数据列表控件\r\nGM.Form.filter = undefined; //过滤器对象\r\nGM.Form.timeout = undefined; //定时器对象\r\n//表单参数\r\nGM.Form.parameters = {\r\n    appId: undefined, //APP ID\r\n    serviceAppKey: undefined, //APP标识，由前文传入，非当前登录信息所述\r\n    urlParams: undefined, //页面参数\r\n    urlTempParams: [], //在页面弹出的对话框上传入的临时参数列表\r\n    userInfo: {\r\n        realName: top.GM.userInfo == null ? '' : top.GM.userInfo.realName,\r\n        loginName: top.GM.userInfo == null ? '' : top.GM.userInfo.loginName\r\n    }, //用户登录信息\r\n    dataLoaded: false, //数据是否已加载\r\n    formValid: true, //数据验证是否通过\r\n    formIds: [], //表单ID列表\r\n    savingFormIds: [], //待保存表单ID\r\n    saveLayerName: undefined, //不为空，则在保存之前保存图形坐标数据\r\n    servers: {\r\n        getDataServer: undefined, //获取数据服务接口地址\r\n        saveDataServer: undefined, //保存数据服务接口地址\r\n        getHandOverVarServer: undefined, //移交判断服务接口地址\r\n        updateBizFlowInfoServer: undefined, //在业务库中保存流程流转信息的拷贝\r\n        getSingleDataGridServer: undefined //获取单个数据列表数据源\r\n    },\r\n    formDataSourceNames: [], //当前表单及所涉及（如弹出框）的所有表单涉及到的所有数据源别名\r\n    dataGridNewFlag: false, //表单内数据列表是否正在新增记录\r\n    formAlias: [] //表单ID与表单别名的存储\r\n};\r\n\r\n/**\r\n * 流程表单引擎类\r\n * @class GM.Form.FormEngine\r\n */\r\nGM.Form.FormEngine = {\r\n    _functions: {\r\n        beforeGetData: [], //提取数据之前\r\n        afterGetData: [], //获取数据之后\r\n        pageLoaded: [] //页面加载之后\r\n    }, //各阶段额外执行的操作\r\n    _initScopeVar: function () {\r\n        var _this = this;\r\n\r\n        GM.Form.formScope.settings = {\r\n            layoutUrl: undefined, //表单组织形式\r\n            forms: [], //表单\r\n            tabs: [], //表单配置\r\n            prints: [], //打印列表\r\n            buttons: [], //底部按钮列表\r\n            topUrl: undefined, //头部功能区Url\r\n            showBottom: false, //底部功能区是否展示\r\n            loadWebGIS: false //是否加载地块管理等webgis功能\r\n        }; //表单整体框架设置\r\n\r\n        GM.Form.formScope.draftInfo = {\r\n            key: undefined\r\n        }; //草稿信息\r\n\r\n        GM.Form.formScope.dataLoaded = false;\r\n        GM.Form.formScope.hasInitCalcs = false;\r\n    },\r\n    /**\r\n     * 入口。初始化全局变量，scope上下文等\r\n     * @param {Object} scope    表单作用域\r\n     * @param {Object} r        调用RESTful服务对象\r\n     * @param {Object} v        控件验证对象\r\n     * @param {Object} d        对话框组件\r\n     * @param {Object} g        数据列表组件\r\n     */\r\n    init: function (scope, r, v, f, d, g, t) {\r\n        var _this = this;\r\n        GM.Form.parameters.urlParams = GM.LayoutOper.getURLParams(window.location.href);\r\n        GM.Form.parameters.appId = GM.Form.parameters.urlParams.appId;\r\n        GM.Form.parameters.serviceAppKey = GM.Form.parameters.urlParams.serviceAppKey;\r\n\r\n        if (GM.Form.parameters.urlParams.serviceAppKey) {\r\n            for (var key in GM.Form.parameters.servers) {\r\n                GM.Form.parameters.servers[key] = _this._getFormServiceUrl(GM.Form.parameters.urlParams.serviceAppKey) + FORM_REST_URL.form[key];\r\n            }\r\n        }\r\n\r\n        GM.Form.formScope = scope;\r\n        GM.Form.restful = r;\r\n        GM.Form.validationObject = v;\r\n        GM.Form.filter = f;\r\n        GM.Form.ngDialog = d;\r\n        GM.Form.gmTable = g;\r\n        GM.Form.timeout = t;\r\n\r\n        this._initScopeVar();\r\n\r\n        if (!GM.Form.formScope) {\r\n            this.showFailureMsg('无法初始化上下文！');\r\n            return;\r\n        }\r\n\r\n        if (!top.GM.userInfo) {\r\n            this.showFailureMsg('无法获取登录用户信息！');\r\n            return;\r\n        }\r\n\r\n        this._loadPage();\r\n        this._bindEvents();\r\n        this._doAfterLoadPage(GM.Form.formScope);\r\n    },\r\n    getAppServerUrl: function (appKey) {\r\n        var url = this._getFormServiceUrl(appKey || GM.Form.parameters.urlParams.serviceAppKey);\r\n\r\n        if (url) {\r\n            if (url.substring(url.length - 1, url.length) == '/') {\r\n                url = url.substring(0, url.length - 1);\r\n            }\r\n\r\n            return url.substring(0, url.lastIndexOf('/'));\r\n        }\r\n\r\n        return undefined;\r\n    },\r\n    clearTemporaryUrlParameters: function () {\r\n        if (GM.Form.parameters.urlTempParams.length > 0) {\r\n            for (var i = 0; i < GM.Form.parameters.urlTempParams.length; i++) {\r\n                if (GM.Form.parameters.urlParams[GM.Form.parameters.urlTempParams[i]]) {\r\n                    GM.Form.parameters.urlParams[GM.Form.parameters.urlTempParams[i]] = undefined;\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /**\r\n     * 在0.5秒后将重命名所有切换页，防止重名导致错误\r\n     */\r\n    _doAfterLoadPage: function (scope) {\r\n        var _this = this;\r\n\r\n        GM.Form.timeout(function () {\r\n            $('.nav li a[data-target]').each(function () {\r\n                var tabId = $(this).attr('data-target').replace('#', '');\r\n                var newTabId = GM.Form.CommonOper.getUUID();\r\n                var tabDiv = $(this).parent('li').parent('ul').parent('div').next('.div-content').find(\"div[id='\" + tabId + \"']\");\r\n\r\n                if (tabDiv.length > 0) {\r\n                    tabDiv.attr('id', newTabId);\r\n                    $(this).attr('data-target', '#' + newTabId);\r\n                }\r\n            });\r\n\r\n            if (scope.hasInitCalcs === false && angular.element('[calc-exp]').length > 0) {\r\n                _this._watchCalcExp(scope);\r\n                scope.hasInitCalcs = true;\r\n            }\r\n        }, 500);\r\n    },\r\n    _getFormServiceUrl: function (appKey) {\r\n        var result = null;\r\n\r\n        //然后取前端配置\r\n        if (result == null) {\r\n            try {\r\n                for (var ii = 0; ii < CONFIG_JSON.length; ii++) {\r\n                    if (appKey === CONFIG_JSON[ii].app) {\r\n                        result = CONFIG_JSON[ii].value + 'form/';\r\n                        break;\r\n                    }\r\n                }\r\n            } catch (ex) {\r\n                //调试环境取调试配置\r\n                result = FORM_SERVER;\r\n                console.log(ex);\r\n            }\r\n        }\r\n\r\n        return result;\r\n    },\r\n    /**\r\n     * 绑定ng事件\r\n     */\r\n    _bindEvents: function () {\r\n        var _this = this;\r\n\r\n        GM.Form.formScope.dateAdd = function (dateStr, span) {\r\n            if (isNaN(span)) {\r\n                return '';\r\n            }\r\n\r\n            span = parseFloat(span);\r\n\r\n            try {\r\n                var a = new Date(dateStr);\r\n                a.setDate(a.getDate() + span);\r\n                var year = a.getFullYear().toString();\r\n                var month = a.getMonth() + 1;\r\n\r\n                if (month < 10) {\r\n                    month = '0' + month;\r\n                } else {\r\n                    month = month.toString();\r\n                }\r\n\r\n                var day = a.getDate();\r\n\r\n                if (day < 10) {\r\n                    day = '0' + day;\r\n                } else {\r\n                    day = day.toString();\r\n                }\r\n\r\n                return year + '-' + month + '-' + day;\r\n            } catch (ex) {}\r\n\r\n            return '';\r\n        };\r\n\r\n        GM.Form.formScope.dateDiff = function (date1, date2) {\r\n            try {\r\n                var a = new Date(date1),\r\n                    b = new Date(date2);\r\n                return (b - a) / (1000 * 3600 * 24);\r\n            } catch (ex) {}\r\n        };\r\n\r\n        GM.Form.formScope.invokePlugin = function (validScope, name) {\r\n            _this._clickEvent(validScope, name);\r\n        };\r\n\r\n        GM.Form.formScope.treeConfig = {\r\n            'activeNode': 'treeEvent'\r\n        };\r\n\r\n        GM.Form.formScope.treeEvent = function (node) {\r\n            _this._treeConfig(GM.Form.formScope, node);\r\n        };\r\n\r\n        GM.Form.formScope.goBack = function () {\r\n            top.goPendingPage(GM.Form.parameters.urlParams.box);\r\n        };\r\n\r\n        //打印\r\n        GM.Form.formScope.print = function (code, para) {\r\n            _this._print(para || GM.Form.formScope.taskInfo.bizKey, code, top.GM.AppInfo.id);\r\n        };\r\n\r\n        //弹出对话框\r\n        GM.Form.formScope.showFormDialog = function (url, formid, name, buttons, clearParams) {\r\n            if (clearParams) {\r\n                _this.clearTemporaryUrlParameters();\r\n            }\r\n            _this._showFormDialog(GM.Form.formScope, url, formid, name, buttons);\r\n        };\r\n\r\n        GM.Form.formScope.closeFormDialog = function () {\r\n            GM.Form.Dialog.close();\r\n        };\r\n\r\n        GM.Form.formScope.formLoaded = function () {\r\n            _this._formLoaded(GM.Form.formScope);\r\n        };\r\n\r\n        GM.Form.formScope.isCbChecked = function (a, b) {\r\n            return _this._isCheckBoxChecked(GM.Form.formScope, a, b);\r\n        };\r\n\r\n        GM.Form.formScope.cbCheck = function (e, a, b) {\r\n            _this._cbCheck(GM.Form.formScope, e, a, b);\r\n        };\r\n\r\n        GM.Form.formScope.dialogButtonClick = function (s) {\r\n            var arr = s.split(';');\r\n\r\n            for (var i = 0; i < arr.length; i++) {\r\n                if (!arr[i]) {\r\n                    continue;\r\n                }\r\n\r\n                var ss = arr[i];\r\n                var c = ss.substring(1, 1);\r\n\r\n                if (c != ';' && c != \"'\" && c != '\"') {\r\n                    c = 'GM.Form.formScope.';\r\n                }\r\n\r\n                ss = c + ss;\r\n                ss = ss.replace(/RDS_L_PAR/g, '(').replace(/RDS_R_PAR/g, ')').replace(/RDS_COLON/g, ':').replace(/RDS_COMMA/g, ',').replace(/RDS_S_QUOTATION/g, \"'\").replace(/RDS_D_QUOTATION/g, '\"');\r\n\r\n                eval(ss);\r\n            }\r\n        };\r\n\r\n        //自动计算\r\n        GM.Form.formScope.$watch('dataLoaded', function () {\r\n            if (GM.Form.formScope.dataLoaded === true && GM.Form.formScope.hasInitCalcs === false && angular.element('[calc-exp]').length > 0) {\r\n                _this._watchCalcExp(GM.Form.formScope);\r\n                GM.Form.formScope.hasInitCalcs = true;\r\n            }\r\n        });\r\n    },\r\n    _watchCalcExp: function (scope) {\r\n        var _this = this;\r\n        //当前用户名\r\n        angular.element(\":text[calc-exp='user'][ng-model],textarea[calc-exp='user'][ng-model]\").each(function () {\r\n            var sUserNgModel = $(this).attr('ng-model');\r\n\r\n            scope.$watch(sUserNgModel, function () {\r\n                var vCur;\r\n\r\n                try {\r\n                    vCur = eval('GM.Form.formScope.' + sUserNgModel);\r\n                } catch (e) {\r\n\r\n                }\r\n\r\n                if (!vCur || vCur == '') {\r\n                    GM.Form.CommonOper.setObjectAttrVal(scope, sUserNgModel, 0, top.GM.userInfo.realName);\r\n                }\r\n            });\r\n        });\r\n\r\n        //当前用户登录名\r\n        angular.element(\":text[calc-exp='userid'][ng-model],textarea[calc-exp='userid'][ng-model]\").each(function () {\r\n            var sUserNgModel = $(this).attr('ng-model');\r\n\r\n            scope.$watch(sUserNgModel, function () {\r\n                var vCur;\r\n\r\n                try {\r\n                    vCur = eval('GM.Form.formScope.' + sUserNgModel);\r\n                } catch (e) {\r\n\r\n                }\r\n\r\n                if (!vCur || vCur == '') {\r\n                    GM.Form.CommonOper.setObjectAttrVal(scope, sUserNgModel, 0, top.GM.userInfo.loginName);\r\n                }\r\n            });\r\n        });\r\n\r\n        //当前用户登录名\r\n        angular.element(\":text[calc-exp='org'][ng-model],textarea[calc-exp='org'][ng-model]\").each(function () {\r\n            var sUserNgModel = $(this).attr('ng-model');\r\n\r\n            scope.$watch(sUserNgModel, function () {\r\n                var vCur;\r\n\r\n                try {\r\n                    vCur = eval('GM.Form.formScope.' + sUserNgModel);\r\n                } catch (e) {\r\n\r\n                }\r\n\r\n                if (!vCur || vCur == '') {\r\n                    if (top.GM.userInfo.organizations.length > 0) {\r\n                        var orgs = [];\r\n\r\n                        for (var i = 0; i < top.GM.userInfo.organizations.length; i++) {\r\n                            orgs.push(top.GM.userInfo.organizations[i].name);\r\n                        }\r\n                    }\r\n                    GM.Form.CommonOper.setObjectAttrVal(scope, sUserNgModel, 0, orgs.join(','));\r\n                }\r\n            });\r\n        });\r\n\r\n        //当日日期\r\n        angular.element(\":text[calc-exp='sysdate'][ng-model],textarea[calc-exp='sysdate'][ng-model]\").each(function () {\r\n            var sUserNgModel = $(this).attr('ng-model');\r\n\r\n            scope.$watch(sUserNgModel, function () {\r\n                var vCur;\r\n\r\n                try {\r\n                    vCur = eval('GM.Form.formScope.' + sUserNgModel);\r\n                } catch (e) {\r\n\r\n                }\r\n\r\n                if (!vCur || vCur == '') {\r\n                    var dt = new Date();\r\n                    var vYear = dt.getFullYear();\r\n                    var vMonth = (dt.getMonth() < 9 ? '0' : '') + (dt.getMonth() + 1);\r\n                    var vDate = (dt.getDate() < 10 ? '0' : '') + dt.getDate();\r\n                    var vSysDate = vYear + '-' + vMonth + '-' + vDate;\r\n\r\n                    GM.Form.CommonOper.setObjectAttrVal(scope, sUserNgModel, 0, vSysDate);\r\n                }\r\n            });\r\n        });\r\n\r\n        if (angular.element(\"[calc-exp][calc-exp!='user'][calc-exp!='userid'][calc-exp!='sysdate']\").length > 0) {\r\n            var arrCalcOpers = ['+', '-', '*', '/', '^', '%', '(', ')', ','];\r\n            angular.element(\"[calc-exp][calc-exp!='user'][calc-exp!='userid'][calc-exp!='sysdate']\").each(function () {\r\n                var sCalcExp = $(this).attr('calc-exp');\r\n                var isCn = sCalcExp.indexOf('cn(') === 0;\r\n\r\n                if (isCn) {\r\n                    sCalcExp = sCalcExp.substring(3, sCalcExp.length - 1);\r\n                }\r\n\r\n                var sModel = $(this).attr('ng-model');\r\n                var sDigits = $(this).attr('digits');\r\n                var arrEleBinds = [];\r\n                var curEleBind = '';\r\n                var sNewCalcExp = '';\r\n\r\n                for (var i = 0; i < sCalcExp.length; i++) {\r\n                    if (arrCalcOpers.containsObj(sCalcExp[i]) || i === sCalcExp.length - 1) {\r\n                        if (curEleBind != '') {\r\n                            if (i === sCalcExp.length - 1) {\r\n                                curEleBind += sCalcExp[i];\r\n                            }\r\n\r\n                            arrEleBinds.push(curEleBind.replace(')', ''));\r\n                            curEleBind = '';\r\n                        }\r\n\r\n                        sNewCalcExp += sCalcExp[i];\r\n\r\n                        if (i < sCalcExp.length - 1 && !arrCalcOpers.containsObj(sCalcExp[i + 1]) &&\r\n                            (sCalcExp[i + 1] < '0' || sCalcExp[i + 1] > '9')) {\r\n                            sNewCalcExp += 'GM.Form.formScope.';\r\n                        }\r\n                    } else {\r\n                        if (i === 0 && (sCalcExp[i] < '0' || sCalcExp[i] > '9')) {\r\n                            sNewCalcExp = 'GM.Form.formScope.';\r\n                        }\r\n\r\n                        curEleBind += sCalcExp[i];\r\n                        sNewCalcExp += sCalcExp[i];\r\n                    }\r\n                }\r\n\r\n                for (var i = 0; i < arrEleBinds.length; i++) {\r\n                    scope.$watch(arrEleBinds[i], function () {\r\n                        var curVal;\r\n                        var curSign = '';\r\n                        var sLastExp = '';\r\n                        var isString = false;\r\n\r\n                        if (sNewCalcExp.indexOf('GM.Form.formScope.dateAdd') === 0 || sNewCalcExp.indexOf('GM.Form.formScope.dateDiff') === 0) {\r\n                            isString = true;\r\n                            sLastExp = sNewCalcExp;\r\n                        } else {\r\n                            for (var uu = 0; uu < sNewCalcExp.length; uu++) {\r\n                                if (arrCalcOpers.containsObj(sNewCalcExp[uu]) || uu === sNewCalcExp.length - 1) {\r\n                                    if (uu === sNewCalcExp.length - 1) {\r\n                                        curSign += sNewCalcExp[uu];\r\n                                    }\r\n\r\n                                    if (curSign != '') {\r\n                                        try {\r\n                                            curVal = eval(curSign);\r\n                                        } catch (e) {\r\n                                            curVal = undefined;\r\n                                        }\r\n\r\n                                        var vLastOper = uu === sNewCalcExp.length - 1 ? '' : sNewCalcExp[uu];\r\n\r\n                                        if (curVal) {\r\n                                            if (!isNaN(curVal)) {\r\n                                                sLastExp += parseFloat(curVal).toFixed(6) + vLastOper;\r\n                                            } else {\r\n                                                sLastExp += curVal;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif(isString === false) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tisString = true;\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tsLastExp += '0' + vLastOper;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n                                        curSign = '';\r\n                                    } else {\r\n                                        sLastExp += sNewCalcExp[uu];\r\n                                    }\r\n                                } else {\r\n                                    curSign += sNewCalcExp[uu];\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        try {\r\n                            if (isString === true) {\r\n                                if (sLastExp.indexOf('GM.Form.formScope.dateAdd') === 0 || sLastExp.indexOf('GM.Form.formScope.dateDiff') === 0) {\r\n                                    GM.Form.CommonOper.setObjectAttrVal(scope, sModel, 0, eval(sLastExp));\r\n                                } else {\r\n                                    GM.Form.CommonOper.setObjectAttrVal(scope, sModel, 0, sLastExp);\r\n                                }\r\n                            } else {\r\n                                if (sDigits && sDigits != '') {\r\n                                    sLastExp = '(' + sLastExp + ').toFixed(' + sDigits + ').trimNumber()';\r\n                                }\r\n\r\n                                if (isCn) {\r\n                                    eval('GM.Form.formScope.' + sModel + \"='\" + formCommonOper.getCnFormatMoney(eval(sLastExp)) + \"'\");\r\n                                } else {\r\n                                    try {\r\n                                        var vCalResult = eval(sLastExp);\r\n\r\n                                        if (vCalResult == 'NaN') {\r\n                                            vCalResult = '';\r\n                                        }\r\n\r\n                                        GM.Form.CommonOper.setObjectAttrVal(scope, sModel, 0, vCalResult);\r\n                                    } catch (e) {}\r\n                                }\r\n                            }\r\n                        } catch (ee) {}\r\n                    });\r\n                }\r\n            });\r\n        }\r\n    },\r\n    _cbCheck: function (scope, e, a, b) {\r\n        if (!b || b == '') {\r\n            return;\r\n        }\r\n\r\n        var bChecked = angular.element(e.target).prop('checked');\r\n\r\n        var arr = a.split('.');\r\n        var obj = scope;\r\n\r\n        for (var i = 0; i < arr.length; i++) {\r\n            if (bChecked && !obj[arr[i]]) {\r\n                obj[arr[i]] = (i < arr.length - 1) ? {} : b;\r\n            } else {\r\n                if (i == arr.length - 1) {\r\n                    var result = obj[arr[i]].split(',');\r\n\r\n                    if (bChecked && !GM.CommonOper.isArrayContainsEle(result, b)) {\r\n                        result.push(b);\r\n                    } else if (!bChecked && GM.CommonOper.isArrayContainsEle(result, b)) {\r\n                        GM.CommonOper.removeItemFromArray(result, b);\r\n                    }\r\n\r\n                    obj[arr[i]] = result.join(',');\r\n                }\r\n            }\r\n\r\n            obj = obj[arr[i]];\r\n        }\r\n    },\r\n    /**\r\n     * 表单在页面渲染之后执行的操作\r\n     *\r\n     * @param {Object} scope\r\n     */\r\n    _formLoaded: function (scope) {\r\n        //初始化表单上各个数据列表的表头\r\n        var arrDataGridDataSources = [];\r\n        angular.element('[ui-grid]').each(function () {\r\n            arrDataGridDataSources.push(angular.element(this).attr('ui-grid').replace('Option', ''));\r\n        });\r\n\r\n        GM.Form.FormData._initOptions(scope, arrDataGridDataSources);\r\n    },\r\n    /**\r\n     * 判断checkbox列表中的单个checkbox是否被选中\r\n     *\r\n     * @param {String} a\r\n     * @param {String} b\r\n     */\r\n    _isCheckBoxChecked: function (scope, a, b) {\r\n        if (!a || a == '' || !b || b == '') {\r\n            return false;\r\n        }\r\n\r\n        var arr = a.split('.');\r\n        var obj = scope;\r\n\r\n        for (var i = 0; i < arr.length; i++) {\r\n            if (!obj[arr[i]]) {\r\n                return false;\r\n            }\r\n\r\n            obj = obj[arr[i]];\r\n        }\r\n\r\n        if (!obj || obj == '') {\r\n            return false;\r\n        }\r\n\r\n        var arrVals = obj.split(',');\r\n        return GM.CommonOper.isArrayContainsEle(arrVals, b);\r\n    },\r\n    /**\r\n     * 在表单框架内弹出对话框\r\n     * @param {String} scope    父scope\r\n     * @param {String} url      对话框内表单的URL\r\n     * @param {String} formid   对话框内表单的ID\r\n     * @param {String} name     对话框内表单的名称\r\n     * @param {String} buttons  对话框内表单的底部按钮\r\n     */\r\n    _showFormDialog: function (scope, url, formid, name, buttons) {\r\n        if (!scope.initedDlgFormIds) {\r\n            scope.initedDlgFormIds = [];\r\n        }\r\n\r\n        if (!GM.CommonOper.isArrayContainsEle(scope.initedDlgFormIds, formid)) {\r\n            scope.initDataGridOptions(formid);\r\n        } else {\r\n            scope.initedDlgFormIds.push(formid);\r\n        }\r\n\r\n        if (!scope.formInfos) {\r\n            scope.formInfos = [];\r\n        }\r\n\r\n        if (!url) {\r\n            for (var i = 0; i < scope.formInfos.length; i++) {\r\n                if (scope.formInfos[i].formid == formid) {\r\n                    url = scope.formInfos[i].url;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (!url) {\r\n                GM.Form.CommonOper.syncAjaxGet(window.FORM_REST_URL.workflow.getFormInfoById + '?formid=' + formid, function (res) {\r\n                    if (res.success === true && res.data) {\r\n                        url = 'views/forms/' + res.data.dir;\r\n                        scope.formInfos.push({\r\n                            formid: formid,\r\n                            url: url\r\n                        });\r\n                    }\r\n                }, function (res) {});\r\n            }\r\n        }\r\n\r\n        if (!!url && url.toLowerCase().indexOf('views/forms') < 0) {\r\n            url = 'views/forms/' + url;\r\n        }\r\n\r\n        var dialogPara = {\r\n            formid: formid,\r\n            title: name,\r\n            url: url\r\n        };\r\n\r\n        if (buttons) {\r\n            var arrBtns = buttons.split(',');\r\n            var formBtns = [];\r\n\r\n            for (var i = 0; i < arrBtns.length; i++) {\r\n                var arrSBtn = arrBtns[i].split(':');\r\n                formBtns.push({\r\n                    name: arrSBtn[0],\r\n                    click: arrSBtn[1],\r\n                    id: arrSBtn[2]\r\n                });\r\n            }\r\n\r\n            dialogPara.buttons = formBtns;\r\n        }\r\n\r\n        scope.dialogParameter = dialogPara;\r\n\r\n        GM.Form.Dialog = GM.Form.ngDialog.open({\r\n            template: require('../views/model/dialog.html'),\r\n            scope: scope,\r\n            plain: true\r\n        });\r\n    },\r\n    /**\r\n     * 打印\r\n     * @param {String} param    打印参数（默认案卷编号）\r\n     * @param {String} code     FastReport模板在WCF配置中对应的code\r\n     * @param {String} appId    业务系统ID\r\n     */\r\n    _print: function (param, code, appId) {\r\n        var printCfgUrl = window.FORM_REST_URL.workflow.printConfigUrl + '?appid=' + appId;\r\n        GM.Form.CommonOper.syncAjaxGet(printCfgUrl, function (res) {\r\n            if (res.success === true && res.data && res.data.length > 0) {\r\n                printCfgUrl = 'http://' + res.data[0].ftpHost + ':' + res.data[0].ftpPort + '/' + res.data[0].ftpApp + '/';\r\n            }\r\n        }, function (res) {});\r\n\r\n        var params = {\r\n            code: code,\r\n            appid: appId,\r\n            param: param\r\n        };\r\n\r\n        var url = window.FORM_REST_URL.workflow.print;\r\n\r\n        GM.Form.restful.post(url, params).then(function (res) {\r\n            if (res.success === true && res.data) {\r\n                var results = res.data.split(';');\r\n\r\n                for (var i = 0; i < results.length; i++) {\r\n                    if (results[i] !== '') {\r\n                        var r = results[i].replace(/\\\\/g, '/');\r\n\r\n                        if (r.indexOf('./') === 0) {\r\n                            r = r.substring(1, r.length);\r\n                        } else if (r.indexOf('/') !== 0) {\r\n                            r = '/' + r;\r\n                        }\r\n\r\n                        top.window.open(printCfgUrl + r);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    },\r\n    _treeConfig: function (scope, node) {\r\n        scope.treeFormKey = pNode.formid + ';' + pNode.sxh + ';' + pNode.subtype;\r\n    },\r\n    _clickEvent: function (validScope, name) {\r\n        var _this = this;\r\n        var names = name.split(',');\r\n\r\n        if (name == 'goBack') {\r\n            _this._doClick(names);\r\n        } else {\r\n            top.GM.LayoutOper.validateForm(GM.Form.validationObject, validScope.allForms, function () {\r\n                GM.Form.formScope.settings.formValid = true;\r\n                _this._doClick(names);\r\n            }, function () {\r\n                GM.Form.formScope.settings.formValid = false;\r\n                GM.Form.CommonOper.showFailureMsg('表单验证不通过，请先根据页面提示进行修改');\r\n            });\r\n        }\r\n    },\r\n    _doClick: function (names) {\r\n        if (names.length === 0) {\r\n            return;\r\n        }\r\n\r\n        eval('GM.Form.formScope.' + names[0] + '()');\r\n        names.splice(0, 1);\r\n        this._doClick(names);\r\n    },\r\n    _pushFormId: function (formid) {\r\n        GM.CommonOper.addUniqueEle(GM.Form.parameters.formIds, formid);\r\n    },\r\n    _pushSavingFormId: function (formid) {\r\n        GM.CommonOper.addUniqueEle(GM.Form.parameters.savingFormIds, formid);\r\n    },\r\n    _getPages: function (tabs) {\r\n        var pages = [];\r\n        this._retrievePages(pages, tabs);\r\n        return pages;\r\n    },\r\n    _retrievePages: function (pages, tabs) {\r\n        for (var kk = 0; kk < tabs.length; kk++) {\r\n            if (tabs[kk].children) {\r\n                this._retrievePages(pages, tabs[kk].children);\r\n            } else {\r\n                if (!!tabs[kk].formid && tabs[kk].formid != 'map') {\r\n                    this._pushFormId(tabs[kk].formid);\r\n\r\n                    if (tabs[kk].save === true || GM.LayoutOper.getParamsValue(tabs[kk].url, 'readonly') !== 'true') {\r\n                        this._pushSavingFormId(tabs[kk].formid);\r\n                    }\r\n                }\r\n\r\n                pages.push(tabs[kk]);\r\n            }\r\n        }\r\n    },\r\n    _getLayoutUrl: function (pstyle) {\r\n        pstyle = pstyle || 'tab';\r\n\r\n        if (pstyle.indexOf('url:') === 0) {\r\n            return pstyle.substring(4, pstyle.length);\r\n        }\r\n\r\n        return STATIC_RESOURCES_PATH + 'dist/core-views/layout/' + pstyle + '.html';\r\n    },\r\n    _loadPage: function () {\r\n        var _this = this;\r\n        GM.Form.Workflow.init();\r\n\r\n\t\tif(GM.Form.parameters.urlParams.formid) {\r\n\t\t\tGM.Form.formScope.settings.layoutUrl = _this._getLayoutUrl('raw');\r\n\t\t\t_this._pushFormId(GM.Form.parameters.urlParams.formid);\r\n\t\t\tGM.Form.parameters.dataLoaded = true;\r\n\t\t} else {\r\n\t\t\tvar sIndexJsonUrl = window.FORM_REST_URL.workflow.getTaskConfig + \"?processDefId=\" + GM.Form.parameters.urlParams.processDefId + \"&taskKey=\";\r\n\r\n\t\t\t//获取节点定义json文件路径\r\n\t\t\tif(!GM.Form.formScope.taskInfo.bizKey) {\r\n\t\t\t\tsIndexJsonUrl += encodeURIComponent(\"起草\");\r\n\t\t\t\tGM.Form.formScope.settings.showBottom = true;\r\n\t\t\t} else {\r\n\t\t\t\tGM.Form.formScope.settings.topUrl = STATIC_RESOURCES_PATH + '/dist/core-views/layout/top.html';\r\n\t\t\t\tsIndexJsonUrl += encodeURIComponent(GM.Form.formScope.taskInfo.taskKey);\r\n\t\t\t\tGM.Form.formScope.settings.showBottom = GM.Form.formScope.taskInfo.name != '查看';\r\n\t\t\t}\r\n\r\n\t\t\tGM.Form.CommonOper.syncAjaxGet(sIndexJsonUrl, function(res) {\r\n\t\t\t\tif(res.success === true && res.data) {\r\n\t\t\t\t\tGM.Form.formScope.settings.layoutUrl = _this._getLayoutUrl(!!res.data.style ? res.data.style : 'tab');\r\n\t\t\t\t\tGM.Form.formScope.settings.tabs = res.data.forms;\r\n\t\t\t\t\tGM.Form.formScope.settings.forms = _this._getPages(res.data.forms);\r\n\t\t\t\t\tGM.Form.formScope.settings.buttons = res.data.buttons;\r\n\t\t\t\t\tGM.Form.formScope.settings.prints = res.data.prints;\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(res.data.webgis) {\r\n\t\t\t\t\t\tGM.Form.formScope.settings.loadWebGIS = !!res.data.webgis;\r\n\t\t\t\t\t}\r\n\r\n                if (GM.Form.formScope.settings.forms && GM.Form.formScope.settings.forms.length > 0) {\r\n                    for (var i = 0; i < GM.Form.formScope.settings.forms.length; i++) {\r\n                        if (GM.Form.formScope.settings.forms[i].formid) {\r\n                            _this._pushFormId(GM.Form.formScope.settings.forms[i].formid);\r\n\r\n\t\t\t\t\t\t\t\tif(GM.Form.formScope.settings.forms[i].save === true) {\r\n\t\t\t\t\t\t\t\t\t_this._pushSavingFormId(GM.Form.formScope.settings.forms[i].formid);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}, function(res) {});\r\n\t\t}\r\n\t}\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/base/form-engine.js","window.formWebgis = {\r\n    init: function () {\r\n        GM.Form.formScope.graphStat = {};\r\n    },\r\n    savePlots: function (ywh, payload, asDraft) {\r\n        var strData = JSON.stringify(payload);\r\n        var saveData = {\r\n            ywh: ywh,\r\n            strParams: strData,\r\n            asDraft: asDraft === true ? '1' : '0'\r\n        };\r\n\r\n        return GM.Form.restful.post(RESTURL.graph.savePlots, null, saveData);\r\n    },\r\n    saveGraphStatics: function () {\r\n        if (!GM.Form.parameters.saveLayerName) {\r\n            return;\r\n        }\r\n\r\n        var polygon = [],\r\n            savePolygon = [];\r\n        var param = {\r\n            layerName: GM.Form.parameters.saveLayerName\r\n        };\r\n\r\n        var status = false;\r\n        var strObjectName = null;\r\n\r\n        if (GM.Form.formScope.graphStat.hasOwnProperty('polygon')) {\r\n            polygon = GM.Form.formScope.graphStat.polygon;\r\n            status = GM.GIS.ExternalApi.saveJXPolygons(polygon, GM.Form.formScope);\r\n            strObjectName = GM.GIS.ExternalApi.getJhObjectIDName();\r\n        }\r\n\r\n        if (status === false) {\r\n            return false;\r\n        }\r\n\r\n        if (GM.Form.formScope.graphStat.statistics) {\r\n            param.statistics = GM.Form.formScope.graphStat.statistics;\r\n        }\r\n\r\n        for (var p = 0; p < polygon.length; p++) {\r\n            var vObjectId = (polygon[p].feature && polygon[p].feature.get(strObjectName))\r\n                ? polygon[p].feature.get(strObjectName) : undefined;\r\n\r\n            vObjectId = (vObjectId && vObjectId != '') ? vObjectId : polygon[p].objectid;\r\n\r\n            savePolygon.push({\r\n                polygonNum: polygon[p].polygonNum,\r\n                area: polygon[p].area,\r\n                name: polygon[p].name,\r\n                strGeom: polygon[p].strGeom,\r\n                objectid: vObjectId\r\n            });\r\n        }\r\n\r\n        param.polygon = savePolygon;\r\n        GM.Form.formScope.saveGraphParam = param;\r\n\r\n        return true;\r\n    }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/base/form-webgis.js","import 'formCommonApi';\r\nimport 'agencyService';\r\n\r\n/**\r\n * 流程扭转类\r\n * @class GM.Form.FormData\r\n */\r\nGM.Form.Workflow = {\r\n    init: function () {\r\n        var _this = this;\r\n\r\n        GM.Form.formScope.taskInfo = {\r\n            bizKey: GM.Form.parameters.urlParams.ywh,\r\n            draftBizKey: GM.Form.parameters.urlParams.did || GM.Form.parameters.urlParams.duuid, //草稿业务号\r\n            processDefId: GM.Form.parameters.urlParams.processDefId,\r\n            processKey: GM.Form.parameters.urlParams.processKey, //流程标识\r\n            processName: GM.Form.parameters.urlParams.processName,\r\n            taskKey: GM.Form.parameters.urlParams.taskKey, //节点名称\r\n            isClaimed: false, //是否已被签收\r\n            bizName: GM.Form.parameters.urlParams.caseTitle, //业务名称\r\n            startTime: undefined, //接收时间\r\n            forbid: GM.Form.parameters.urlParams.forbid == '1', //是否已被禁止\r\n            boxName: (GM.Form.parameters.urlParams.box || 'agency')\r\n        }; //当前节点信息\r\n\r\n        if (GM.Form.parameters.urlParams.ywh) {\r\n            var url = window.FORM_REST_URL.workflow.getProcessInstanceByBizKey + '?bizKey=' + GM.Form.parameters.urlParams.ywh;\r\n            GM.Form.restful.get(url).then(function (res) {\r\n                if (res.success === true && res.data) {\r\n                    GM.Form.formScope.taskInfo.startTime = res.data.startTime;\r\n                }\r\n            }, function (res) {});\r\n        }\r\n\r\n        GM.Form.formScope.handOver = function () {\r\n            window.Dialog = GM.Form.ngDialog.open({\r\n                template: STATIC_RESOURCES_PATH + '/dist/core-views/handOver.html',\r\n                scope: GM.Form.formScope\r\n            });\r\n        };\r\n\r\n        GM.Form.formScope.startProcessAndHandOver = function () {\r\n            GM.Form.formScope.startProcess(true, true);\r\n        };\r\n\r\n        GM.Form.formScope.startProcess = function (autoHandOver, notTurnToFirst) {\r\n            _this._startProcess(autoHandOver, notTurnToFirst);\r\n        };\r\n\r\n        //签收或放弃签收\r\n        GM.Form.formScope.claimOrUnclaim = function (status) {\r\n            _this._claimOrUnclaim(status);\r\n        };\r\n\r\n        //查看流程图\r\n        GM.Form.formScope.showWfGraph = function () {\r\n            GM.Form.formScope.blankTitle = '流程图';\r\n            GM.Form.formScope.htmlContent = '<img src=\"' + FORM_REST_URL.workflow.getHighLightTask + '?bizKey=' + GM.Form.formScope.taskInfo.bizKey + '\" style=\"margin-top:30px;\"/>';\r\n            //GM.Form.formScope.htmlContent = '<img src=\"http://192.168.5.27:8080/activiti-web/usertask/getHighLightTask?bizKey=Z201803230005\"/>';\r\n            Dialog = GM.Form.ngDialog.open({\r\n                template: STATIC_RESOURCES_PATH + '/dist/core-views/model/blank.html',\r\n                scope: GM.Form.formScope\r\n            });\r\n        };\r\n\r\n        _this._isTaskClaimed();\r\n        _this._initBizFlowDetails();\r\n    },\r\n    _claimOrUnclaim: function (status) {\r\n        var alertMessage, myUrl, erroeMessage;\r\n        if (status === 'claim') {\r\n            alertMessage = '确认签收？';\r\n            myUrl = FORM_REST_URL.workflow.claimTask;\r\n            erroeMessage = '签收失败';\r\n        } else {\r\n            alertMessage = '确认放弃？';\r\n            myUrl = FORM_REST_URL.workflow.unclaimTask;\r\n            erroeMessage = '放弃签收失败';\r\n        }\r\n        GM.Alert.show(alertMessage, '', null, function () {\r\n            GM.Form.restful.get(myUrl, {\r\n                bizKey: GM.Form.formScope.taskInfo.bizKey,\r\n                taskKey: GM.Form.formScope.taskInfo.taskKey,\r\n                userId: GM.Form.parameters.userInfo.loginName\r\n            }).then(function (res) {\r\n                if (res.success === true) {\r\n                    let str = '';\r\n                    for (var key in GM.Form.parameters.urlParams) {\r\n                        str += '&' + key + '=' + GM.Form.parameters.urlParams[key];\r\n                    }\r\n                    window.location = str.replace(/&/, '?') + '&taskKey=' + GM.Form.formScope.taskInfo.taskKey;\r\n                } else {\r\n                    GM.Infomation.show(erroeMessage, {\r\n                        type: 'warning'\r\n                    });\r\n                }\r\n            }, function (error) {\r\n                GM.Infomation.show(error.message, {\r\n                    type: 'warning'\r\n                });\r\n            });\r\n        });\r\n    },\r\n    _startProcess: function (autoHandOver, notTurnToFirst) {\r\n        var _this = this;\r\n        var ctrlCaseTitle = $(\"[data-role='bizname']\");\r\n\r\n        if (!ctrlCaseTitle || ctrlCaseTitle.length === 0) {\r\n            GM.Form.CommonOper.showFailureMsg('缺少用于案卷标题的控件！');\r\n            return;\r\n        }\r\n\r\n        ctrlCaseTitle = ctrlCaseTitle.val();\r\n\r\n        if (!ctrlCaseTitle || ctrlCaseTitle == '') {\r\n            GM.Form.CommonOper.showFailureMsg('案卷标题不能为空！');\r\n            return;\r\n        }\r\n\r\n        var param = {\r\n            appId: GM.Form.parameters.appId,\r\n            userId: GM.Form.parameters.userInfo.loginName,\r\n            processDefId: GM.Form.parameters.urlParams.processDefId,\r\n            title: ctrlCaseTitle\r\n        };\r\n\r\n        if (GM.Form.formScope.taskInfo.draftBizKey) {\r\n            param.draftKey = GM.Form.formScope.taskInfo.draftBizKey;\r\n        }\r\n\r\n        //设置业务箱内的附加的业务数据\r\n        var ctrlExtraBizDatas = angular.element(\"[data-role='biz-data']\");\r\n        var extraBizData;\r\n\r\n        if (ctrlExtraBizDatas.length > 0) {\r\n            for (var y = 0; y < ctrlExtraBizDatas.length; y++) {\r\n                var sModel = $(ctrlExtraBizDatas[y].attr('ng-model'));\r\n\r\n                if (sModel) {\r\n                    var arr = sModel.split('.');\r\n\r\n                    if (arr.length > 0) {\r\n                        if (!extraBizData) {\r\n                            extraBizData = {};\r\n                        }\r\n\r\n                        extraBizData[arr[arr.length - 1]] = eval('GM.Form.formScope.' + sModel);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (extraBizData) {\r\n            param.extraBizData = extraBizData;\r\n        }\r\n\r\n        GM.Form.restful.get(FORM_REST_URL.workflow.startProcess, param).then(function (res) {\r\n            if (res.success === true) {\r\n                //保存数据\r\n                GM.Form.parameters.urlParams.ywh = res.data.bizKey;\r\n                GM.Form.formScope.taskInfo.taskKey = res.data.currentTaskId;\r\n                GM.Form.formScope.taskInfo.bizKey = res.data.bizKey;\r\n                GM.Form.formScope.taskInfo.bizName = res.data.caseTitle;\r\n                GM.Form.formScope.taskInfo.startTime = res.data.startTime;\r\n                GM.Form.formScope.taskInfo.isClaimed = true;\r\n\r\n                if (autoHandOver === true) {\r\n                    GM.Form.formScope.saveAndHandOver();\r\n                } else {\r\n                    GM.Form.formScope.save();\r\n                }\r\n\r\n                _this.saveBizFlowInfo('', res.data.bizKey);\r\n                if (!notTurnToFirst) {\r\n                    let str = '';\r\n                    for (var key in GM.Form.parameters.urlParams) {\r\n                        str += '&' + key + '=' + GM.Form.parameters.urlParams[key];\r\n                    }\r\n                    window.location = str.replace(/&/, '?') + '&taskKey=' + GM.Form.formScope.taskInfo.taskKey;\r\n                }\r\n            }\r\n        }, function (res) {});\r\n    },\r\n    _initBizFlowDetails: function () {\r\n        var _this = this;\r\n        //流转详情\r\n        GM.Form.formScope.pendingPageLz = {\r\n            currentPage: 1\r\n        };\r\n\r\n        GM.Form.formScope.$watch('pendingPageLz.currentPage', function () {\r\n            if (GM.Form.formScope.pendingPageLz.currentPage > 0) {\r\n                _this._getLzData();\r\n            }\r\n        });\r\n\r\n        //表格\r\n        GM.Form.formScope.lzGridOptions = {};\r\n\r\n        //定义操作\r\n        var strCellTemplate = '<span style=\"display:block;padding:5px;color:#3280fc\">正常</span>';\r\n\r\n        GM.Form.formScope.lzGridOptions.columnDefs = [{\r\n            name: 'taskKey',\r\n            displayName: '当前环节',\r\n            enableColumnMenu: false,\r\n            cellTooltip: true\r\n        },\r\n        {\r\n            name: 'assigneeName',\r\n            displayName: '办理人员',\r\n            enableColumnMenu: false,\r\n            cellTooltip: true\r\n        },\r\n        {\r\n            name: 'previousTaskKey',\r\n            displayName: '前一环节',\r\n            enableColumnMenu: false,\r\n            cellTooltip: true\r\n        },\r\n        {\r\n            name: 'submitterName',\r\n            displayName: '发件人员',\r\n            enableColumnMenu: false,\r\n            cellTooltip: true\r\n        },\r\n        {\r\n            name: 'startTime',\r\n            displayName: '接收时间',\r\n            enableColumnMenu: false,\r\n            cellTooltip: true\r\n        },\r\n        {\r\n            name: 'completeTime',\r\n            displayName: '转送时间',\r\n            enableColumnMenu: false,\r\n            cellTooltip: true\r\n        },\r\n        {\r\n            name: 'yj',\r\n            displayName: '预警',\r\n            enableColumnMenu: false,\r\n            cellTemplate: strCellTemplate\r\n        }\r\n        ];\r\n\r\n        //显示流转详情\r\n        GM.Form.formScope.showLzDialog = function () {\r\n            //打开弹出框\r\n            Dialog = GM.Form.ngDialog.open({\r\n                template: STATIC_RESOURCES_PATH + '/dist/core-views/model/liuzhuan-modal.html',\r\n                scope: GM.Form.formScope,\r\n                className: 'ngdialog-theme-default custom' //不添加这个属性就是大对话框\r\n            });\r\n\r\n            //获取流转详情数据\r\n            _this._getLzData();\r\n        };\r\n\r\n        //查看图形\r\n        GM.Form.formScope.viewMap = function () {\r\n            var strDyh = GM.Form.formScope.result.zrzyjbxx.ZRZYDJDYH;\r\n            var strUrl = GM.LayoutOper.addURLParam(ONEMAP_PATH, 'ProjectType', 'zrzy');\r\n            strUrl = GM.LayoutOper.addURLParam(strUrl, 'ZRZYDJDYH', strDyh);\r\n            GM.FullModal.show('地图', strUrl);\r\n        };\r\n\r\n        //关闭弹出框\r\n        GM.Form.formScope.closeDialog = function () {\r\n            Dialog.close();\r\n        };\r\n    },\r\n    _getLzData: function () {\r\n        var url = window.FORM_REST_URL.workflow.getTaskTrackPage + '?current=' + GM.Form.formScope.pendingPageLz.currentPage + '&orderField=START_TIME&bizKey=' + GM.Form.formScope.taskInfo.bizKey;\r\n        GM.Form.restful.get(url, function (response) {\r\n            if (response.success === true) {\r\n                var dbData = response.data.records;\r\n\r\n                angular.forEach(dbData, function (item, index) {\r\n                    item.index = index + 1;\r\n                    item.startTime = GM.Form.filter('date')(item.startTime, 'yyyy-MM-dd HH:mm:ss');\r\n                    item.completeTime = GM.Form.filter('date')(item.completeTime, 'yyyy-MM-dd HH:mm:ss');\r\n                });\r\n\r\n                GM.Form.formScope.pendingPageLz.totalItems = response.data.total;\r\n                GM.Form.formScope.lzGridOptions.data = response.data.records;\r\n            }\r\n        }, function (res) {});\r\n    },\r\n    _isTaskClaimed: function () {\r\n        var url = FORM_REST_URL.workflow.isClaimed + '?bizKey=' + GM.Form.formScope.taskInfo.bizKey + '&taskkey=' + encodeURIComponent(GM.Form.formScope.taskInfo.taskKey);\r\n        GM.Form.restful.get(url, null).then(function (response) {\r\n            var isClaimed = response.success === true && response.data === true;\r\n            GM.Form.formScope.taskInfo.isClaimed = response.success === true && response.data === true;\r\n\r\n            if (!isClaimed) {\r\n                GM.Form.formScope.readonly = true;\r\n            }\r\n        }, function (response) {});\r\n    },\r\n    saveBizFlowInfo: function (id, bizKey) {\r\n        GM.Form.restful.get(GM.Form.parameters.servers.updateBizFlowInfoServer + '?bizKey=' + bizKey + '&id=' + id).then(function (res) {}, function (res) {});\r\n    }\r\n};\r\n\r\nwindow.workflowCore = {\r\n\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/base/workflow.js","//定义表单通用配置\r\nwindow.FORM_SERVER_URLS = {};\r\n\r\nwindow.FORM_REST_URL = {\r\n    form: {\r\n        getHandOverVarServer: 'getHandOverVariables',\r\n        getDataServer: 'getData',\r\n        saveDataServer: 'saveData',\r\n        getSingleDataGridServer: 'getSingleDataGrid',\r\n        updateBizFlowInfoServer: 'updateBizFlowInfo'\r\n    },\r\n    workflow: {\r\n        isClaimed: ACTIVITI_SERVER + '/usertask/isTaskClaimed',\r\n        claimTask: ACTIVITI_SERVER + '/usertask/claimTask',\r\n        unclaimTask: ACTIVITI_SERVER + '/usertask/unclaimTask',\r\n        getHighLightTask: ACTIVITI_SERVER + '/usertask/getHighLightTask',\r\n        startProcess: ACTIVITI_SERVER + '/usertask/startProcess',\r\n        saveDataAsDraft: ACTIVITI_SERVER + '/usertask/saveDataAsDraft',\r\n        getDraftData: ACTIVITI_SERVER + '/usertask/getDraftData',\r\n        saveDraftInfo: ACTIVITI_SERVER + '/tdzz/saveDraftInfo',\r\n        getDrafts: ACTIVITI_SERVER + '/tdzz/getDrafts',\r\n        getRegionTree: ACTIVITI_SERVER + '/work/getRegionTree',\r\n        getBizInfo: ACTIVITI_SERVER + '/usertask/getProcessInstance',\r\n        getHandOverTarget: ACTIVITI_SERVER + '/usertask/getNextTasks',\r\n        handOver: ACTIVITI_SERVER + '/usertask/handOver',\r\n        getUUID: ACTIVITI_SERVER + '/usertask/getUUID',\r\n        print: ACTIVITI_SERVER + '/bizconfig/print',\r\n        getRedisString: ACTIVITI_SERVER + '/userdraft/getRedisString',\r\n        removeRedisString: ACTIVITI_SERVER + '/userdraft/removeRedisString',\r\n        redisString: ACTIVITI_SERVER + '/userdraft/redisString',\r\n        getTaskTrackPage: ACTIVITI_SERVER + '/usertask/getTaskTrackPage',\r\n        getDataGridDataSourceNames: ACTIVITI_SERVER + '/form/getDataGridDataSourceNames',\r\n        getFormInfoById: ACTIVITI_SERVER + '/form/getFormInfoById',\r\n        getProcessInstanceByBizKey: ACTIVITI_SERVER + '/usertask/getProcessInstanceByBizKey',\r\n        getAnalyzedParam: ACTIVITI_SERVER + '/form/getAnalyzedParam',\r\n        printConfigUrl: ACTIVITI_SERVER + '/printcfg/getByappId',\r\n        getTaskConfig: ACTIVITI_SERVER + '/bizconfig/getTaskConfig'\r\n    }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/config.js","import 'fileService';\r\n\r\nangular.module('frameApp').controller('fileCtrl', ['$scope', '$location', '$fileService', '$captureService', 'ngDialog', '$validation',\r\n    function ($scope, $location, $fileService, $captureService, ngDialog, $validation) {\r\n        var urlParams = formBase.getUrlParamters($location.absUrl());\r\n        //业务号\r\n        var strYwh = urlParams.ywh;\r\n        //节点名称\r\n        var strStepName = urlParams.blbz;\r\n        //是否签收\r\n        var bCliam = true;\r\n\r\n        $scope.fileTreeConfig = {\r\n            activeNode: 'activeNode',\r\n            name: 'filename'\r\n        };\r\n\r\n        //点击节点\r\n        $scope.activeNode = function (pNode) {\r\n            if (pNode != null) {\r\n                if (pNode.processDefId != null) {\r\n                    //文件夹点击\r\n                    $scope.activeFolder = true;\r\n                } else {\r\n                    //文件点击\r\n                    $scope.activeFolder = false;\r\n                }\r\n            }\r\n            $scope.pActiveNode = pNode;\r\n        };\r\n\r\n        //上传材料\r\n        $scope.uploadFile = function () {\r\n            $('#file_upload').click();\r\n            $('#file_upload').unbind().change(function () {\r\n                var formData = new FormData();\r\n                formData.append('multipartFile', this.files[0]);\r\n                //formData.append(\"ywh\", strYwh);\r\n                formData.append('id', $scope.pActiveNode.id);\r\n                formData.append('dir', strYwh + '\\\\' + $scope.pActiveNode.filename);\r\n                formData.append('isDraft', (!!urlParams.duuid || !!urlParams.did) ? '1' : '0');\r\n                var response = GM.CommonOper.ajaxRequest(RESTURL.file.uploadFile, formData, {\r\n                    type: 'POST',\r\n                    cache: false,\r\n                    processData: false,\r\n                    contentType: false\r\n                });\r\n                if ($scope.pActiveNode.children == null) {\r\n                    $scope.pActiveNode.children = [];\r\n                }\r\n                if (response.data != null && response.data.children != null && response.data.children.length != 0) {\r\n                    var pData = response.data.children[0];\r\n                    pData.filename = pData.name;\r\n                    //pData.name = pData.fileName;\r\n                    $scope.pActiveNode.children.push(pData);\r\n                    $scope.$apply($scope.pActiveNode);\r\n                    GM.Infomation.show('上传成功！');\r\n                }\r\n                $('#file_upload').val('');\r\n                $scope.fileTree = $fileService.formatTreeData($scope.fileTree, strStepName, bCliam);\r\n            });\r\n        };\r\n\r\n        //编辑材料\r\n        $scope.editFolder = function () {\r\n            $scope.copyFocusItem = angular.copy($scope.pActiveNode);\r\n        };\r\n\r\n        //删除材料\r\n        $scope.deleteFolder = function () {\r\n            GM.Alert.show('提示？', '是否确认删除材料？', {\r\n                showCancelButton: true\r\n            }, function () {\r\n                $fileService.removeFolder($scope.pActiveNode.id).then(function (response) {\r\n                    GM.CommonOper.removeItemFromArray($scope.fileTree, $scope.pActiveNode, 'id');\r\n                    GM.Infomation.show('删除成功！');\r\n                }, function (error) {\r\n                    GM.Infomation.show('删除失败！');\r\n                    $log.error(error);\r\n                });\r\n            });\r\n        };\r\n\r\n        //删除文件\r\n        $scope.deleteFile = function () {\r\n            GM.Alert.show('提示？', '是否确认删除文件？', {\r\n                showCancelButton: true\r\n            }, function () {\r\n                $fileService.removeFile($scope.pActiveNode.id, $scope.pActiveNode.fileId).then(function (response) {\r\n                    GM.TreeOper.removeNode($scope.fileTree, $scope.pActiveNode);\r\n                    GM.Infomation.show('删除成功！');\r\n                }, function (error) {\r\n                    GM.Infomation.show('删除失败！');\r\n                    $log.error(error);\r\n                });\r\n            });\r\n        };\r\n\r\n        //编辑文件\r\n        $scope.editFile = function () {\r\n            $scope.copyFocusItem = angular.copy($scope.pActiveNode);\r\n        };\r\n\r\n        //查看文件\r\n        $scope.viewFile = function () {\r\n            //查看文件\r\n            var strUrl = $scope.pActiveNode.url;\r\n            var strFileType = GM.FilePath.getFileType(strUrl);\r\n            if (strFileType === 'img') {\r\n                $scope.imgUrl = strUrl;\r\n            } else {\r\n                window.open(strUrl);\r\n            }\r\n        };\r\n\r\n        //保存文件\r\n        $scope.saveFile = function () {\r\n            angular.copy($scope.pActiveNode, $scope.copyFocusItem);\r\n            $fileService.saveFile($scope.copyFocusItem).then(function (response) {\r\n                angular.copy($scope.copyFocusItem, $scope.pActiveNode);\r\n                GM.Infomation.show('修改成功！');\r\n                $('#fileModal').modal('hide');\r\n            }, function (error) {\r\n                GM.Infomation.show('修改失败！');\r\n                $log.error(error);\r\n            });\r\n        };\r\n        //新建材料\r\n        $scope.addFolder = function () {\r\n            GM.Form.Dialog = ngDialog.open({\r\n                template: 'folderModal.html',\r\n                scope: $scope\r\n            });\r\n        };\r\n        //关闭弹窗\r\n        $scope.closeDialog = function () {\r\n            if (ngDialog) {\r\n                ngDialog.close();\r\n            }\r\n        };\r\n\r\n        //保存材料\r\n        $scope.saveFolder = function (dislogScope) {\r\n            GM.LayoutOper.validateForm($validation, dislogScope.folderForm, function () {\r\n                $fileService.saveFolder($scope.copyFocusItem).then(function (response) {\r\n                    if ($scope.copyFocusItem.id == null) {\r\n                        //添加\r\n                        $scope.fileTree.push(response.data);\r\n                        GM.Infomation.show('添加成功！');\r\n                    } else {\r\n                        //修改\r\n                        angular.copy($scope.copyFocusItem, $scope.pActiveNode);\r\n                        GM.Infomation.show('修改成功！');\r\n                    }\r\n                    ngDialog.close();\r\n                }, function (error) {\r\n                    if ($scope.focusItem == null) {\r\n                        GM.Infomation.show('添加失败！');\r\n                    } else {\r\n                        GM.Infomation.show('修改失败！');\r\n                    }\r\n                    $log.error(error);\r\n                });\r\n            }, function () {});\r\n        };\r\n\r\n        //扫描文件\r\n        $scope.captureImg = function () {\r\n            $captureService.showCapture($scope);\r\n        };\r\n    }\r\n]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/controllers/file-controller.js","import 'formCoreService';\r\nimport 'formCommonApi';\r\nimport '../directives/tab-components';\r\nimport '../filters/workflow-filter';\r\n\r\nangular.module('frameApp').controller('indexCtrl', ['$scope', '$http', '$gmRestful', function ($scope, $http, $gmRestful) {\r\n    GM.token = top.GM.token;\r\n    var pRestful = new $gmRestful();\r\n    GM.FrameManager.prepareData($scope, pRestful);\r\n    //获取所有的数据列表数据源，用于初始化数据列表控件\r\n    var bizKey = GM.LayoutOper.getParamsValue(window.location.href, 'ywh');\r\n    var taskKey = GM.LayoutOper.getParamsValue(window.location.href, 'taskKey');\r\n    var processKey = GM.LayoutOper.getParamsValue(window.location.href, 'processKey');\r\n    var processDefId = GM.LayoutOper.getParamsValue(window.location.href, 'processDefId');\r\n\r\n    var setUrl = function () {\r\n        var view = GM.LayoutOper.getParamsValue(window.location.href, 'view');\r\n\r\n        if (view) {\r\n            $scope.subUrl = 'views/' + view + '.html?' + window.location.href.split('?')[1];\r\n        } else {\r\n            $scope.subUrl = STATIC_RESOURCES_PATH + 'dist/core-views/layout/formIndex.html';\r\n        }\r\n    };\r\n\r\n    var loadPage = function (res) {\r\n        var formIds = '';\r\n\r\n        if (res.forms && res.forms.length > 0) {\r\n            var formIdList = [];\r\n            for (var i = 0; i < res.forms.length; i++) {\r\n                formIdList.push(res.forms[i].formid);\r\n            }\r\n\r\n            formIds = formIdList.join(',');\r\n        }\r\n        //存储起草时需要用到的formid\r\n        $scope.formIds = formIds;\r\n        if (formIds) {\r\n            $http.get(window.FORM_REST_URL.workflow.getDataGridDataSourceNames + '?formids=' + formIds).then(function (res) {\r\n                if (res.data.success === true) {\r\n                    GM.Form.parameters.formDataSourceNames = res.data.data;\r\n                }\r\n\r\n                setUrl();\r\n            }, function (res) {\r\n                console.log(res);\r\n            });\r\n        } else {\r\n            GM.LayoutOper.getParamsValue(window.location.href, 'view');\r\n            setUrl();\r\n        }\r\n    };\r\n    //只查看业务详情\r\n    if (!!bizKey && !processKey) {\r\n        var getInfoUrl = window.FORM_REST_URL.workflow.getProcessInstanceByBizKey + '?bizKey=' + encodeURIComponent(bizKey);\r\n        var box = GM.LayoutOper.getParamsValue(window.location.href, 'box');\r\n\r\n        if (!taskKey) {\r\n            taskKey = '查看';\r\n        }\r\n\r\n        GM.Form.CommonOper.syncAjaxGet(getInfoUrl, function (r) {\r\n            if (r && r.success === true && r.data) {\r\n                var res = r.data;\r\n                if (res.processDef && res.processDef.processDefinitionId) {\r\n                    processKey = res.processDef.processDefinitionId.split(':')[0];\r\n                    getInfoUrl = 'index.html?appId=' + GM.AppInfo.id + '&serviceAppKey=' + res.processDef.serviceAppKey +\r\n\t\t\t\t\t\t'&box=' + box + '&ywh=' + bizKey + '&processKey=' + processKey +\r\n\t\t\t\t\t\t'&processDefId=' + res.processDefId + '&taskKey=' + encodeURIComponent(taskKey) +\r\n\t\t\t\t\t\t'&processName=' + encodeURIComponent(res.processDef.processName) + '&caseTitle=' + encodeURIComponent(res.caseTitle);\r\n\r\n                    if (taskKey === '查看') {\r\n                        getInfoUrl += '&forbid=1';\r\n                    }\r\n\r\n                    window.location = getInfoUrl;\r\n                }\r\n            }\r\n        }, function (res) {\r\n            document.write('无法获取业务详情。');\r\n        });\r\n    } else {\r\n        //获取案卷信息\r\n        let url = window.FORM_REST_URL.workflow.getTaskConfig + '?processDefId=' + processDefId + '&taskKey=';\r\n        url += encodeURIComponent(taskKey || '起草');\r\n\r\n        GM.Form.CommonOper.syncAjaxGet(url, function (res) {\r\n            if (res.success === true && res.data) {\r\n                loadPage(res.data);\r\n            } else {\r\n                document.write('请求数据失败。');\r\n            }\r\n        }, function (res) {\r\n            document.write('请求数据失败。');\r\n        });\r\n    }\r\n    $scope.closeDlg = function () {\r\n        $('button.close[data-dismiss]', window.parent.document).click();\r\n    };\r\n}]);\r\nangular.module('frameApp').controller('formCtrl', ['$scope', '$timeout', '$formCoreService', '$filter', 'ngDialog', '$validation', '$gmTable',\r\n    function ($scope, $timeout, $formCoreService, $filter, ngDialog, $validation, $gmTable) {\r\n        //处理加载的子页面的状态\r\n        $scope.$on('$includeContentLoaded', function (angularEvent, src) {\r\n            var pParams = GM.LayoutOper.getURLParams(src);\r\n            angularEvent.targetScope.readonly = pParams.readonly === 'true';\r\n        });\r\n\r\n        $formCoreService.loadPage($scope, $validation, $filter, ngDialog, $gmTable, $timeout);\r\n    }\r\n]);\r\nangular.module('frameApp').controller('initCtrl', ['$scope', function ($scope) {\r\n    console.log('initCtrl');\r\n}]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/controllers/form-controller.js","import 'handOverService';\r\n\r\nangular.module('frameApp').controller('handOverCtrl', ['$scope', '$handOverService',\r\n    function ($scope, $handOverService) {\r\n        $handOverService.loadPage($scope);\r\n    }\r\n]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/controllers/handover-controller.js","angular.module('frameApp').directive('tabTop', function () {\r\n    return {\r\n        restrict: 'EAC',\r\n        template: '<div class=\"form-top-div clearfix\"><div class=\"form-top-left pull-left\"><div ng-if=\"!taskInfo.forbid\"><h3>项目类型：{{taskInfo.processName}}&nbsp;&nbsp;&nbsp;当前节点：{{taskInfo.taskKey}}</h3>流程状态：<span class=\"label\"ng-if=\"!taskInfo.isClaimed\">未签收</span><span class=\"label label-success\"ng-if=\"taskInfo.isClaimed\">已签收</span></div><div ng-if=\"taskInfo.forbid\"><h3>项目类型：{{taskInfo.processName}}</div></div><div class=\"form-top-right pull-right\"ng-init=\"operatList = true\"ng-init=\"print = true\"><div class=\"dropdown\"><i class=\"icon icon-list-ul more\"data-toggle=\"dropdown\"title=\"菜单\"></i><ul class=\"dropdown-menu pull-right\"><li class=\"dropdown\"ng-if=\"!taskInfo.forbid && !taskInfo.isClaimed\"ng-click=\"claim(true);\"><a href=\"javascript:;\">签收</a></li><li class=\"dropdown\"ng-if=\"!taskInfo.forbid && taskInfo.isClaimed\"ng-click=\"claim(false)\"><a href=\"javascript:;\">放弃</a></li><li class=\"divider\"></li><li class=\"dropdown-submenu\"ng-click=\"showWfGraph()\"><a href=\"javascript:;\">流程图</a></li><li class=\"divider\"></li><li class=\"dropdown\"><a href=\"javascript:;\">打印</a><ul class=\"dropdown-menu pull-left\"><li ng-repeat=\"item in printItems\"><a href=\"javascript:;\"ng-click=\"print(item.code)\">{{item.name}}</a></li></ul></li><li class=\"divider\"></li><li class=\"dropdown\"ng-click=\"viewMap()\"><a href=\"javascript:;\">定位</a></li></ul></div></div></div><hr style=\"margin-top: 0\">',\r\n        link: function (scope, element, attr, transclution) {\r\n\r\n        }\r\n    };\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/directives/tab-components.js","/**\r\n * @description 收件材料服务\r\n */\r\n//收件材料服务\r\nangular.module('frameApp').factory('$fileService', ['$gmRestful', function ($gmRestful) {\r\n    var result = {\r\n        /**\r\n         * 获取作为草稿的附件材料树\r\n         *\r\n         * @param {String} draftBizKey\r\n         * @param {String} processKey\r\n         * @param {String} subType\r\n         */\r\n        getDraftAttaches: function (draftBizKey, processKey, taskKey, subType) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.get(RESTURL.file.getDraftAttaches, {\r\n                draftBizKey: draftBizKey,\r\n                processKey: processKey,\r\n                taskKey: taskKey,\r\n                subType: subType\r\n            });\r\n            return pPromise;\r\n        },\r\n        getAttachesFromRedis: function (draftBizKey, processKey, taskKey, subType) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.get(RESTURL.file.getAttachesFromRedis, {\r\n                draftBizKey: draftBizKey,\r\n                processKey: processKey,\r\n                taskKey: taskKey,\r\n                subType: subType\r\n            });\r\n            return pPromise;\r\n        },\r\n        /**\r\n         * @description 查询文件目录树\r\n         * @param strYwh\r\n         * @returns {*}\r\n         */\r\n        queryTree: function (strYwh, subType, seqNo) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.get(RESTURL.file.queryTree, {\r\n                ywh: strYwh,\r\n                zlx: subType,\r\n                sxh: seqNo\r\n            });\r\n            return pPromise;\r\n        },\r\n        /**\r\n         * @description 保存材料信息\r\n         * @param folderData\r\n         * @returns {*}\r\n         */\r\n        saveFolder: function (folderData) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.post(RESTURL.file.saveFolder, {}, folderData);\r\n            return pPromise;\r\n        },\r\n        /**\r\n         * @description 删除材料\r\n         * @param strId {String} 材料ID\r\n         */\r\n        removeFolder: function (strId) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.post(RESTURL.file.deleteFolder, {}, {\r\n                id: strId\r\n            });\r\n            return pPromise;\r\n        },\r\n        /**\r\n         * @description 删除文件\r\n         * @param strId\r\n         */\r\n        removeFile: function (strId, strFileId) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.post(RESTURL.file.deleteFile, {}, {\r\n                id: strId,\r\n                fileId: strFileId,\r\n                status: 1\r\n            });\r\n            return pPromise;\r\n        },\r\n        /**\r\n         * @description 保存文件\r\n         * @param fileData\r\n         */\r\n        saveFile: function (fileData) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.post(RESTURL.file.saveFile, {}, fileData);\r\n            return pPromise;\r\n        },\r\n        /**\r\n         * @description 修证树节点数据\r\n         * @param treeNodes {Array} 树节点数据\r\n         * @param strStepName {String} 节点名称\r\n         * @param bCliam {是否签收}\r\n         */\r\n        formatTreeData: function (treeNodes, strStepName, bCliam) {\r\n            if (treeNodes == null) {\r\n                return;\r\n            }\r\n            var arrayNodes = GM.TreeOper.getAllNodes(treeNodes);\r\n            for (var ii = 0; ii < arrayNodes.length; ii++) {\r\n                var pNode = arrayNodes[ii];\r\n                if (pNode.processDefId) {\r\n                    //文件夹节点\r\n                    pNode.parent = true;\r\n                    var bEnable = this._isFileEnable(pNode, strStepName, bCliam);\r\n                    if (bEnable === false) {\r\n                        pNode.nodeType = 'disabled';\r\n                        if (pNode.children != null && pNode.children.length > 0) {\r\n                            for (var jj = 0; jj < pNode.children.length; jj++) {\r\n                                var pItemNode = pNode.children[jj];\r\n                                pItemNode.nodeType = pNode.nodeType;\r\n                            }\r\n                        }\r\n                    } else {\r\n                        //材料是否必须\r\n                        var bNessary = this._isFileNecessary(pNode);\r\n                        if (bNessary === true && (pNode.children == null || pNode.children.length === 0)) {\r\n                            pNode.nodeType = 'error';\r\n                        } else {\r\n                            pNode.nodeType = 'default';\r\n                        }\r\n                    }\r\n                } else {\r\n                    pNode.filename = pNode.name;\r\n                }\r\n            }\r\n            return treeNodes;\r\n        },\r\n        initTree: function (treeScope, bizKey, taskKey, subType, seqNo, urlParams) {\r\n            var _this = this;\r\n            var sSubType = subType || '';\r\n            var sSeqNo = seqNo || '';\r\n\r\n            if (urlParams.duuid) {\r\n                _this.getDraftAttaches(bizKey, urlParams.processid, taskKey, sSubType).then(function (response) {\r\n                    var pTreeNode = _this.formatTreeData(response.data, urlParams.blbz, true);\r\n                    treeScope.fileTree = pTreeNode;\r\n                });\r\n            } else if (urlParams.did) {\r\n                _this.getAttachesFromRedis(bizKey, urlParams.processid, taskKey, sSubType).then(function (response) {\r\n                    var pTreeNode = _this.formatTreeData(response.data, urlParams.blbz, true);\r\n                    treeScope.fileTree = pTreeNode;\r\n                });\r\n            } else {\r\n                //查询文件树数据\r\n                _this.queryTree(bizKey, sSubType, sSeqNo).then(function (response) {\r\n                    var pTreeNode = _this.formatTreeData(response.data, urlParams.blbz, true);\r\n                    treeScope.fileTree = pTreeNode;\r\n                });\r\n            }\r\n        },\r\n        /**\r\n         * @description 材料是否可以编辑\r\n         * @param pNode\r\n         * @param strStepName\r\n         * @param bCliam\r\n         * @returns {boolean}\r\n         * @private\r\n         */\r\n        _isFileEnable: function (pNode, strStepName, bCliam) {\r\n            if (bCliam == false) {\r\n                //未签收\r\n                return false;\r\n            }\r\n            //配置节点比对\r\n\r\n            return true;\r\n        },\r\n        /**\r\n         * @description 材料是否必要\r\n         * @param pNode\r\n         * @private\r\n         */\r\n        _isFileNecessary: function (pNode) {\r\n            return true;\r\n        }\r\n    };\r\n    return result;\r\n}]);\r\n\r\n//拍摄服务\r\nangular.module('frameApp').factory('$captureService', ['$gmRestful', function ($gmRestful) {\r\n    var pRestful = new $gmRestful();\r\n    //基础操作\r\n    var BaseCapture = {\r\n        /**\r\n         * @description 展示对话框\r\n         */\r\n        showDialog: function () {\r\n            var nWindowHeight = $(window).height();\r\n            var nHeight = 650;\r\n            if (nHeight > nWindowHeight) {\r\n                nHeight = nWindowHeight;\r\n            }\r\n            var nWidth = (nHeight - 115) / 0.75 + 35 + 300;\r\n            $('.oa-capture-dialog').dialog({\r\n                title: '材料扫描',\r\n                modal: true,\r\n                width: nWidth,\r\n                height: nHeight\r\n            });\r\n        }\r\n    };\r\n\r\n    //通用摄像头控件\r\n    GM.DotNetCapture = {\r\n        showDialog: function ($scope) {\r\n            this.$scope = $scope;\r\n            this.$scope.tableData = [];\r\n            this.options = {\r\n                camera: 0,\r\n                resolution: 0\r\n            };\r\n            this._innitLayout();\r\n            this._initEvent();\r\n            BaseCapture.showDialog();\r\n        },\r\n        /**\r\n         * @description 初始化页面\r\n         */\r\n        _innitLayout: function () {\r\n            //修改页面对应的设备\r\n            this._modifyLayout();\r\n\r\n            if (this.device_camera == null) {\r\n                this.device_camera = $('#CaptureView')[0];\r\n            }\r\n            this.device_camera.CameraStop();\r\n            this.device_camera.Init();\r\n            var strCameras = this.device_camera.getDeviceNames();\r\n\r\n            if (strCameras) {\r\n                //设置默认显示摄像头的参数\r\n                var arrayCameras = strCameras.split(';');\r\n                //清除为空的数组元素\r\n                for (var ii = 0; ii < arrayCameras.length; ii++) {\r\n                    if (GM.CommonOper.isStrNullOrEmpty(arrayCameras[ii])) {\r\n                        GM.CommonOper.removeItemFromArray(arrayCameras, arrayCameras[ii]);\r\n                        ii--;\r\n                    }\r\n                }\r\n                this.$scope.arrayCameras = arrayCameras;\r\n            }\r\n            this.device_camera.CameraConn(this.options.camera, this.options.resolution);\r\n            this.$scope.selectCamera = String(this.options.camera);\r\n            this.$scope.arrayResolutions = this._getResolutions();\r\n            this.$scope.selectResolution = String(this.options.resolution);\r\n        },\r\n        _modifyLayout: function () {\r\n            $('#CaptureView').remove();\r\n            $('.oa-capture-view').append('<OBJECT ID=\"CaptureView\" CLASSID=\"CLSID:A14B31B4-C560-4DF7-A30C-59A3AE8C598D\" ' +\r\n                'style=\"height:100%;width:100%\"></OBJECT>');\r\n            var strClassID = $('#CaptureView').attr('CLASSID');\r\n            if (strClassID !== 'CLSID:A14B31B4-C560-4DF7-A30C-59A3AE8C598D') {\r\n                $('#CaptureView').remove();\r\n                $('.oa-capture-view').append('<OBJECT ID=\"CaptureView\" CLASSID=\"CLSID:A14B31B4-C560-4DF7-A30C-59A3AE8C598D\" ' +\r\n                    'style=\"height:100%;width:100%\"></OBJECT>');\r\n            }\r\n        },\r\n        _initEvent: function () {\r\n            var _this = this;\r\n            this.$scope.chooseCamera = function (nIndex) {\r\n                var nSelectIndex = Number(_this.$scope.selectCamera);\r\n                var nResolutionIndex = Number(_this.$scope.selectResolution);\r\n                _this.device_camera.CameraConn(nSelectIndex, 0);\r\n                _this.$scope.arrayResolutions = _this._getResolutions();\r\n                _this.$scope.selectResolution = '0';\r\n            };\r\n            this.$scope.chooseResolution = function (nIndex) {\r\n                var nSelectIndex = Number(_this.$scope.selectCamera);\r\n                var nResolutionIndex = Number(_this.$scope.selectResolution);\r\n                _this.device_camera.CameraConn(nSelectIndex, nResolutionIndex);\r\n            };\r\n\r\n            //刷新设备\r\n            this.$scope.updateCamera = function () {\r\n                _this.updateDevice();\r\n            };\r\n\r\n            //拍摄\r\n            this.$scope.shoot = function () {\r\n                var strBase64 = _this.device_camera.MakeCapture();\r\n                if (strBase64) {\r\n                    _this.$scope.tableData.push({\r\n                        name: _this.$scope.tableData.length + 1,\r\n                        strBase64: strBase64,\r\n                        uploadStatus: '待上传'\r\n                    });\r\n                }\r\n                //刷新摄像头\r\n                _this.updateDevice();\r\n            };\r\n\r\n            //重新拍摄\r\n            this.$scope.reshoot = function () {\r\n                _this.$scope.view = 'camera';\r\n            };\r\n\r\n            //查看图片\r\n            this.$scope.viewImg = function (pItem) {\r\n                _this.$scope.view = 'img';\r\n                _this.$scope.imgBase64 = pItem.strBase64;\r\n            };\r\n\r\n            //删除拍摄图片\r\n            this.$scope.deleteItem = function (pItem) {\r\n                GM.CommonOper.removeItemFromArray(_this.$scope.tableData, pItem);\r\n            };\r\n\r\n            //上传材料\r\n            this.$scope.uploadFile = function () {\r\n                for (var ii = 0; ii < _this.$scope.tableData.length; ii++) {\r\n                    var pUploadItem = _this.$scope.tableData[ii];\r\n                    if (pUploadItem.uploadStatus === '待上传') {\r\n                        var pResult = pRestful.ajax(RESTURL.file.uploadBase64, pUploadItem);\r\n                        if (pResult && pResult.success === true) {\r\n                            pUploadItem.uploadStatus === '上传成功';\r\n\r\n                            //添加节点\r\n                            if (_this.$scope.pActiveNode.children == null) {\r\n                                _this.$scope.pActiveNode.children = [];\r\n                            }\r\n                            var pData = pResult.data;\r\n                            _this.$scope.pActiveNode.children.push(pData);\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n\r\n            //注册对话框关闭事件\r\n            $('.oa-capture-dialog').on('dialogbeforeclose', function () {\r\n                _this.destory();\r\n            });\r\n\r\n            //页面离开事件\r\n            $(window).unbind('beforeunload', GM.DotNetCapture.destory).bind('beforeunload', GM.DotNetCapture.destory);\r\n        },\r\n        _getResolutions: function () {\r\n            var strResolutions = this.device_camera.getVideoResolutions();\r\n            if (strResolutions) {\r\n                var arrayResolutions = strResolutions.split(';');\r\n                return arrayResolutions;\r\n            }\r\n            return null;\r\n        },\r\n        /**\r\n         * @description 刷新设备\r\n         */\r\n        updateDevice: function () {\r\n            this.destory();\r\n            if (this.device_camera == null) {\r\n                this.device_camera = $('#CaptureView')[0];\r\n            }\r\n            this.device_camera.CameraStop();\r\n            this.device_camera.Init();\r\n            var nSelectIndex = Number(this.$scope.selectCamera);\r\n            var nResolutionIndex = Number(this.$scope.selectResolution);\r\n            this.device_camera.CameraConn(nSelectIndex, nResolutionIndex);\r\n        },\r\n        /**\r\n         * @description 回收对象\r\n         */\r\n        destory: function () {\r\n            if (GM.DotNetCapture.device_camera) {\r\n                GM.DotNetCapture.device_camera.CameraStop();\r\n                GM.DotNetCapture.device_camera = null;\r\n            }\r\n        }\r\n    };\r\n\r\n    var result = {\r\n        /**\r\n         * @description 展示高拍仪对话框\r\n         */\r\n        showCapture: function ($scope) {\r\n            $scope.capture = {};\r\n            var strVal = this.getVertion();\r\n            switch (strVal) {\r\n            case 'LiangTian':\r\n                //GM.OA.DotNetCapture.showDialog();\r\n                break;\r\n            case 'FangZheng':\r\n                //GM.OA.FangZhengCapture.showDialog();\r\n                break;\r\n            case 'JieYuA16D':\r\n                //GM.OA.JieYuA16DCapture.showDialog();\r\n                break;\r\n            case 'JieYuJYP6008T':\r\n                //GM.OA.JieYuJYP6008TCapture.showDialog();\r\n                break;\r\n            default:\r\n                GM.DotNetCapture.showDialog($scope);\r\n                break;\r\n            }\r\n        },\r\n        /**\r\n         * @description 获取高拍仪的版本\r\n         */\r\n        getVertion: function () {\r\n            return '';\r\n        }\r\n    };\r\n    return result;\r\n}]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/services/file-service.js","angular.module('frameApp').factory('$formCoreService', ['$gmRestful', function ($gmRestful) {\r\n    var service = {\r\n        loadPage: function (scope, validation, filter, dlg, gmTable, timeout) {\r\n            GM.Form.FormEngine.init(scope, new $gmRestful(), validation, filter, dlg, gmTable, timeout);\r\n            GM.Form.FormData.init(scope.formIds);\r\n            scope.getData();\r\n        }\r\n    };\r\n\r\n    return service;\r\n}]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/services/form-core-service.js","angular.module('frameApp').factory('$handOverService', ['$gmRestful', function ($gmRestful) {\r\n    var service = {\r\n        loadPage: function (scope) {\r\n            var _this = this;\r\n\r\n            if (!scope.taskInfo || !scope.taskInfo.hasOwnProperty('taskKey') || !scope.taskInfo.taskKey) {\r\n                GM.Form.CommonOper.showFailureMsg('无法获取移交相关参数！');\r\n                return;\r\n            }\r\n\r\n            scope.result = {};\r\n            scope.nextNodes = [];\r\n            scope.handOverConfig = {\r\n                name: 'name',\r\n                children: 'childrens',\r\n                checkNode: 'checkItem'\r\n            };\r\n\r\n            _this._bindEvents(scope);\r\n\r\n            //先获取移交参数\r\n            _this._getHandOverChecks(scope.taskInfo.processDefId, scope.taskInfo.taskKey, scope.taskInfo.bizKey).then(function (r) {\r\n                if (r.success === true) {\r\n                    scope.handOverVar = r.data;\r\n\r\n                    _this._getHandOverTarget(scope.taskInfo.processDefId, scope.taskInfo.taskKey, r.data).then(function (res) {\r\n                        if (res.success === true && res.data && res.data != null) {\r\n                            scope.nextNodes = res.data;\r\n                            scope.isOnlyLastNode = res.data.length === 1 && res.data[0].node == '__结束__';\r\n                            var userArray = [];\r\n                            var subArray = angular.copy(res.data);\r\n\r\n                            for (var i = 0; i < subArray.length; i++) {\r\n                                userArray[i] = {\r\n                                    name: subArray[i].node,\r\n                                    childrens: subArray[i].groups\r\n                                };\r\n\r\n                                if (!subArray[i].groups) {\r\n                                    continue;\r\n                                }\r\n\r\n                                for (var j = 0; j < subArray[i].groups.length; j++) {\r\n                                    userArray[i].childrens[j] = {\r\n                                        name: subArray[i].groups[j].name,\r\n                                        id: subArray[i].groups[j].id,\r\n                                        childrens: subArray[i].groups[j].users\r\n                                    };\r\n                                }\r\n                            }\r\n\r\n                            scope.chooseRole = userArray;\r\n                        } else if (res.message) {\r\n                            GM.Form.CommonOper.showFailureMsg(res.message);\r\n                        }\r\n                    }, function (res) {\r\n                        GM.Form.CommonOper.showFailureMsg(res.message);\r\n                    });\r\n                }\r\n            }, function (r) {\r\n                GM.Form.CommonOper.showFailureMsg(r.message);\r\n            });\r\n        },\r\n        _bindEvents: function (scope) {\r\n            var _this = this;\r\n\r\n            scope.checkItem = function (item) {\r\n                _this._checkItem(scope, item);\r\n            };\r\n\r\n            scope.modelHandOver = function () {\r\n                _this._doHandOver(scope);\r\n            };\r\n\r\n            scope.unselectUser = function (node, id, name) {\r\n                _this._unselect(scope, node, id, name);\r\n            };\r\n        },\r\n        _checkItem: function (scope, item) {\r\n            var _this = this;\r\n            scope.selectedUsers = [];\r\n\r\n            if (item instanceof Array) {\r\n                for (var i = 0; i < item.length; i++) {\r\n                    if (item[i].flag == '3') {\r\n                        _this._selectUser(scope, item[i].node, item[i].id, item[i].name);\r\n                    }\r\n                }\r\n            } else {\r\n                if (item && item.flag == '3') {\r\n                    _this._selectUser(scope, item.node, item.id, item.name);\r\n                }\r\n            }\r\n        },\r\n        _selectUser: function (scope, node, id, name) {\r\n            var user = {\r\n                id: id,\r\n                name: name\r\n            };\r\n\r\n            var bFlag = false;\r\n\r\n            for (var i = 0; i < scope.selectedUsers.length; i++) {\r\n                if (scope.selectedUsers[i]['node'] && scope.selectedUsers[i]['node'] == node) {\r\n                    if (!GM.CommonOper.isArrayContainsEle(scope.selectedUsers[i]['users'], user)) {\r\n                        var users = scope.selectedUsers[i]['users'] || [];\r\n                        users.push(user);\r\n                        scope.selectedUsers[i]['users'] = users;\r\n                    }\r\n\r\n                    bFlag = true;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (!bFlag) {\r\n                scope.selectedUsers.push({\r\n                    node: node,\r\n                    users: [user]\r\n                });\r\n            }\r\n        },\r\n        _unselect: function (scope, node, id, name) {\r\n            var _this = this;\r\n            _this._uncheckTreeUser(scope, node, id, name);\r\n\r\n            for (var i = 0; i < scope.selectedUsers.length; i++) {\r\n                if (scope.selectedUsers[i]['node'] && scope.selectedUsers[i]['node'] == node) {\r\n                    var users = scope.selectedUsers[i]['users'];\r\n                    var deleteItem = {\r\n                        id: id,\r\n                        name: name\r\n                    };\r\n                    GM.CommonOper.removeItemFromArray(users, deleteItem, 'id');\r\n\r\n                    if (users.length === 0) {\r\n                        scope.selectedUsers.splice(i, 1);\r\n                    } else {\r\n                        scope.selectedUsers[i]['users'] = users;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        _uncheckUserOnTree: function (cur, nodeName, id, name) {\r\n            var _this = this;\r\n            if (cur.childrens && cur.childrens.length > 0) {\r\n                for (var i = 0; i < cur.childrens.length; i++) {\r\n                    _this._uncheckUserOnTree(cur.childrens[i], nodeName, id, name);\r\n                }\r\n            } else if (cur.flag == '3' && cur.id == id && cur.node == nodeName) {\r\n                cur.check = false;\r\n            }\r\n        },\r\n        _uncheckTreeUser: function (scope, nodeName, id, name) {\r\n            for (var i = 0; i < scope.chooseRole.length; i++) {\r\n                this._uncheckUserOnTree(scope.chooseRole[i], nodeName, id, name);\r\n            }\r\n        },\r\n        _doHandOver: function (scope) {\r\n            if ((!scope.isOnlyLastNode || scope.isOnlyLastNode !== true) && (!scope.selectedUsers || scope.selectedUsers.length === 0)) {\r\n                GM.Form.CommonOper.showFailureMsg('请先选择移交对象！');\r\n                return;\r\n            }\r\n\r\n            var _this = this;\r\n            var param = {\r\n                userId: top.GM.userInfo.loginName,\r\n                bizKey: scope.taskInfo.bizKey,\r\n                taskKey: scope.taskInfo.taskKey,\r\n                variables: scope.handOverVar\r\n            };\r\n\r\n            if (scope.isOnlyLastNode !== true) {\r\n                var target = {\r\n                    target: []\r\n                };\r\n                var arrayIds = null;\r\n\r\n                for (var u = 0; u < scope.selectedUsers.length; u++) {\r\n                    arrayIds = GM.Form.CommonOper.mapFieldArray(scope.selectedUsers[u].users, 'id');\r\n                    target.target.push({\r\n                        node: scope.selectedUsers[u].node,\r\n                        users: arrayIds\r\n                    });\r\n                }\r\n\r\n                param.targets = JSON.stringify(target);\r\n            }\r\n\r\n            this._handOver(param).then(function (response) {\r\n                if (response.success === true) {\r\n                    if (response.data) {\r\n                        _this._saveBizFlowInfo(response.data, scope.taskInfo.bizKey);\r\n                    }\r\n\r\n                    var sMsg = scope.isOnlyLastNode === true ? '流程已结束！' : '移交成功！';\r\n                    GM.Form.CommonOper.showSuccessMsg(sMsg);\r\n                    GM.Form.formScope.closeDialog();\r\n                    var strBoxName = scope.handOverParam && scope.handOverParam.boxName;\r\n                    top.goPendingPage(strBoxName);\r\n                } else {\r\n                    GM.Form.CommonOper.showFailureMsg(response.message);\r\n                }\r\n            }, function (response) {\r\n                GM.Form.CommonOper.showFailureMsg(response.message);\r\n            });\r\n        },\r\n        _getBizInfo: function (userId, bizKey, taskKey) {\r\n            return $gmRestful().get(FORM_REST_URL.workflow.getBizInfo, {\r\n                userId: userId,\r\n                bizKey: bizKey,\r\n                taskKey: taskKey\r\n            });\r\n        },\r\n        _getHandOverChecks: function (processDefId, taskKey, bizKey) {\r\n            return $gmRestful().get(GM.Form.parameters.servers.getHandOverVarServer, {\r\n                processDefId: processDefId,\r\n                taskKey: taskKey,\r\n                bizKey: bizKey\r\n            });\r\n        },\r\n        _getHandOverTarget: function (processDefId, taskKey, v) {\r\n            return $gmRestful().get(FORM_REST_URL.workflow.getHandOverTarget, {\r\n                processDefId: processDefId,\r\n                taskKey: taskKey,\r\n                'var': JSON.stringify(v)\r\n            });\r\n        },\r\n        _handOver: function (param) {\r\n            return $gmRestful().post(FORM_REST_URL.workflow.handOver, param);\r\n        },\r\n        _saveBizFlowInfo: function (id, bizKey) {\r\n            GM.Form.CommonOper.syncAjaxGet(GM.Form.parameters.servers.updateBizFlowInfoServer + '?bizKey=' + bizKey, function (res) {\r\n\r\n            }, function (res) {});\r\n        }\r\n    };\r\n\r\n    return service;\r\n}]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/core/services/handover-service.js","module.exports = \"<header class=dialog-header> <h4 class=modal-title>{{dialogParameter.title}}</h4> </header> <div class=dialog-content> <div class=dialog-query-content> <form class=\\\"form-simple form-horizontal\\\"> <div ng-include=dialogParameter.url></div> </form> </div> </div> <div class=dialog-buttons> <button ng-repeat=\\\"button in dialogParameter.buttons\\\" class=\\\"btn btn-default\\\" ng-click=dialogButtonClick(button.click)>{{button.name}}</button> <button type=button class=\\\"btn btn-default\\\" ng-click=closeDialog()>关闭</button> </div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/form/core/views/model/dialog.html\n// module id = ./src/form/core/views/model/dialog.html\n// module chunks = form","import 'formApp';\r\nimport 'formConfig';\r\nimport 'formCore';\r\nimport 'fileCtrl';\r\nimport 'formCtrl';\r\nimport 'handOverCtrl';\r\nimport 'agencyCtrl';\r\nimport 'completeCtrl';\r\nimport 'draftCtrl';\r\nimport 'protocolCtrl';\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/form.js","import 'agencyService';\r\n\r\nangular.module('frameApp').controller('agencyCtrl', ['$scope', '$rootScope', '$agencyService', '$filter', function ($scope, $rootScope, $agencyService, $filter) {\r\n    var userId = GM.userInfo.loginName;\r\n    var appId = GM.AppInfo.id;\r\n    $scope.pendingPage = {};\r\n    $scope.agencyForm = {\r\n        userId: userId,\r\n        appId: appId,\r\n        orderField: 'startTime'\r\n    };\r\n\r\n    //使用自定义分页控件\r\n    $scope.$watch('pendingPage.currentPage', function () {\r\n        if ($scope.pendingPage.currentPage > 0) {\r\n            $scope.agencyForm.current = $scope.pendingPage.currentPage;\r\n            queryData();\r\n        }\r\n    });\r\n    $scope.pendingPage.currentPage = 1;\r\n\r\n    //查询数据\r\n    function queryData () {\r\n        $agencyService.queryPendingData($scope.agencyForm).then(function (response) {\r\n            var dbData = response.data.records;\r\n            angular.forEach(dbData, function (item, index) {\r\n                item.index = index + 1;\r\n                item.startTime = $filter('date')(item.startTime, 'yyyy-MM-dd HH:mm:ss');\r\n            });\r\n            $scope.userData.data.page.records = dbData;\r\n            $scope.pendingPage.totalItems = response.data.total;\r\n        }, function (erron) {\r\n            GM.Infomation.show(erron.message, {\r\n                type: 'warning'\r\n            });\r\n        });\r\n    }\r\n\r\n    /***标签查询*****/\r\n    $scope.tagData = {\r\n        tags: [{\r\n            name: '计划待办',\r\n            value: '计划待办'\r\n        }, {\r\n            name: '实施待办',\r\n            value: '实施待办'\r\n        }, {\r\n            name: '验收待办',\r\n            value: '验收待办'\r\n        }],\r\n        checkTag: 'checkTag'\r\n    };\r\n\r\n    $scope.checkTag = function (tags) {\r\n        $scope.agencyForm.xmjd = [];\r\n        for (var i = 0; i < tags.length; i++) {\r\n            $scope.agencyForm.xmjd.push(tags[i].value);\r\n        }\r\n        queryData();\r\n    };\r\n\r\n    //表格控件数据\r\n    $scope.userData = {\r\n        config: {\r\n            'taskKey': {\r\n                'type': 'a',\r\n                'click': 'goProcess'\r\n            }\r\n        },\r\n        data: {\r\n            page: {},\r\n            head: {\r\n                'index': '序号',\r\n                'bizKey': '案卷编号',\r\n                'bizName': '案卷名称',\r\n                'processName': '项目类型',\r\n                'startTime': '提交时间',\r\n                'submitterName': '提交人',\r\n                'taskKey': '当前环节'\r\n            }\r\n        },\r\n        headList: ['index', 'bizKey', 'bizName', 'processName', 'startTime', 'submitterName', 'taskKey']\r\n    };\r\n\r\n    var getExtraBizFields = function () {\r\n        return $agencyService.queryExtraBizFields(appId).then(function (res) {\r\n            if (res.success === true && res.data && res.data.length > 0) {\r\n                for (var i = 0; i < res.data.length; i++) {\r\n                    $scope.userData.headList.splice(4, 0, res.data[i].field);\r\n                    $scope.userData.data.head[res.data[i].field] = res.data[i].label;\r\n                }\r\n            }\r\n        }, function (res) {});\r\n    };\r\n\r\n    //查询\r\n    $scope.refer = function () {\r\n        queryData();\r\n    };\r\n\r\n    //清除\r\n    $scope.delet = function () {\r\n        $scope.agencyForm = {\r\n            userId: userId\r\n        };\r\n        queryData();\r\n    };\r\n\r\n    // 节点\r\n    $scope.goProcess = function (item) {\r\n        console.log(item);\r\n        $rootScope.processUrl = $agencyService.getHtmlPath() + '?appId=' + appId + '&serviceAppKey=' + item.serviceAppKey + '&box=agency&ywh=' + item.bizKey + '&processKey=' + item.processKey + '&processDefId=' + item.processDefId + '&taskKey=' + encodeURIComponent(item.taskKey ? item.taskKey : '起草') + '&processName=' + encodeURIComponent(item.processName) + '&caseTitle=' + encodeURIComponent(item.bizName);\r\n        $(\"[ng-controller='agencyCtrl'] *\").hide();\r\n        $(\"[ng-controller='agencyCtrl']\").append('<iframe frameborder=\"0\" height=\"100%\" width=\"100%\" name =\"agencyCtrl\"></iframe>');\r\n        window['agencyCtrl'].location.href = $rootScope.processUrl;\r\n    };\r\n\r\n    //跳转到待办页面\r\n    $scope.goPending = function () {\r\n        $scope.activeNaviFromPath('/agency', true);\r\n    };\r\n}]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/office/controllers/agency-ctrl.js","import 'agencyService';\r\n\r\nangular.module('frameApp').controller('completeCtrl', ['$scope', '$rootScope', '$agencyService', '$filter', function ($scope, $rootScope, $agencyService, $filter) {\r\n    var userId = GM.userInfo.loginName;\r\n    var appId = GM.AppInfo.id;\r\n\r\n    $scope.completeForm = {\r\n        userId: userId,\r\n        appId: appId,\r\n        orderField: 'completeTime'\r\n    };\r\n\r\n    //使用自定义分页控件\r\n    $scope.pendingPage = {\r\n        currentPage: 1\r\n    };\r\n    $scope.$watch('pendingPage.currentPage', function () {\r\n        if ($scope.pendingPage.currentPage > 0) {\r\n            $scope.completeForm.current = $scope.pendingPage.currentPage;\r\n            queryData();\r\n        }\r\n    });\r\n    $scope.pendingPage.currentPage = 1;\r\n\r\n    //查询数据\r\n    function queryData () {\r\n        $agencyService.queryCompleteData($scope.completeForm).then(function (response) {\r\n            var dbData = response.data.records;\r\n            angular.forEach(dbData, function (item, index) {\r\n                item.index = index + 1;\r\n                item.completeTime = $filter('date')(item.completeTime, 'yyyy-MM-dd');\r\n            });\r\n            $scope.userData.data.page.records = dbData;\r\n            $scope.pendingPage.totalItems = response.data.total;\r\n        }, function (erron) {\r\n            GM.Infomation.show(erron.message, {\r\n                type: 'warning'\r\n            });\r\n        });\r\n    }\r\n\r\n    /***标签查询*****/\r\n    $scope.tagData = {\r\n        tags: [{\r\n            name: '计划阶段',\r\n            value: 0\r\n        }, {\r\n            name: '实施阶段',\r\n            value: 1\r\n        }, {\r\n            name: '验收阶段',\r\n            value: 2\r\n        }],\r\n        checkTag: 'checkTag'\r\n    };\r\n\r\n    $scope.checkTag = function (tags) {\r\n        $scope.completeForm.xmjd = [];\r\n        for (var i = 0; i < tags.length; i++) {\r\n            $scope.completeForm.xmjd.push(tags[i].name);\r\n        }\r\n        queryData();\r\n    };\r\n\r\n    //表格控件数据\r\n    $scope.userData = {\r\n        config: {\r\n            operate: [{\r\n                name: '查看',\r\n                icon: 'icon-edit',\r\n                click: 'goProcess'\r\n            }]\r\n        },\r\n        data: {\r\n            page: {},\r\n            head: {\r\n                'index': '序号',\r\n                'bizKey': '案卷编号',\r\n                'bizName': '案卷名称',\r\n                'processName': '项目类型',\r\n                'taskKey': '已办环节',\r\n                'completeTime': '提交时间',\r\n                'targetTaskKey': '接收环节',\r\n                'receiverName': '接收人'\r\n            }\r\n        },\r\n        headList: ['index', 'bizKey', 'bizName', 'processName', 'taskKey', 'completeTime', 'targetTaskKey', 'receiverName']\r\n    };\r\n\r\n    $scope.refer = function () {\r\n        queryData();\r\n    };\r\n\r\n    //清除\r\n    $scope.delet = function () {\r\n        $scope.completeForm = {\r\n            userId: userId\r\n        };\r\n        queryData();\r\n    };\r\n\r\n    // 节点\r\n    $scope.goProcess = function (item) {\r\n        console.log(item);\r\n        $rootScope.processUrl = 'forms/index.html?appId=' + appId + '&serviceAppKey=' + item.serviceAppKey + '&box=complete&ywh=' + item.bizKey + '&processKey=' + item.processKey + '&processDefId=' + item.processDefId + '&taskKey=' + encodeURIComponent('查看') + '&processName=' + encodeURIComponent(item.processName) + '&caseTitle=' + encodeURIComponent(item.bizName);\r\n        $(\"[ng-controller='completeCtrl'] *\").hide();\r\n        $(\"[ng-controller='completeCtrl']\").append('<iframe frameborder=\"0\" height=\"100%\" width=\"100%\" name =\"completeCtrl\"></iframe>');\r\n        window['completeCtrl'].location.href = $rootScope.processUrl;\r\n    };\r\n\r\n    //跳转到待办页面\r\n    $scope.goPending = function () {\r\n        $scope.activeNaviFromPath('/complete', true);\r\n    };\r\n}]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/office/controllers/complete-ctrl.js","import 'draftService';\r\n\r\nangular.module('frameApp').controller('draftCtrl', ['$scope', '$location', '$rootScope', '$draftService', '$agencyService', '$log', function ($scope, $location, $rootScope, $draftService, $agencyService, $log) {\r\n    var userId = GM.userInfo.loginName;\r\n    $scope.draftForm = {\r\n        userId: userId\r\n    };\r\n\r\n    //获取项目所在地数据字典\r\n    $scope.regions = GM.userInfo.areas;\r\n    $scope.treearea = {\r\n        name: 'title',\r\n        children: 'childrens',\r\n        attvalue: 'code'\r\n    };\r\n\r\n    //使用自定义分页控件\r\n    $scope.pendingPage = {\r\n        currentPage: 1\r\n    };\r\n\r\n    $scope.$watch('pendingPage.currentPage', function () {\r\n        if ($scope.pendingPage.currentPage > 0) {\r\n            $scope.draftForm.current = $scope.pendingPage.currentPage;\r\n            queryData();\r\n        }\r\n    });\r\n    $scope.pendingPage.currentPage = 1;\r\n\r\n    //查询数据\r\n    function queryData () {\r\n        $agencyService.queryDraftData($scope.draftForm).then(function (response) {\r\n            var cgData = response.data.page.records;\r\n            angular.forEach(cgData, function (item, index) {\r\n                item.index = index + 1;\r\n            });\r\n            $scope.userData.data.page.records = cgData;\r\n            $scope.pendingPage.totalItems = response.data.page.total;\r\n        }, function (erron) {\r\n            GM.Infomation.show(erron.message, {\r\n                type: 'warning'\r\n            });\r\n        });\r\n    }\r\n\r\n    /***标签查询*****/\r\n    $scope.tagData = {\r\n        tags: [{\r\n            name: '一般开发项目',\r\n            value: '一般开发项目'\r\n        }, {\r\n            name: '专项基金开发项目',\r\n            value: '专项基金开发项目'\r\n        }, {\r\n            name: '一般整理项目',\r\n            value: '一般整理项目'\r\n        }, {\r\n            name: '国土部门高标准项目',\r\n            value: '国土部门高标准项目'\r\n        }, {\r\n            name: '其它部门高标准项目',\r\n            value: '其它部门高标准项目'\r\n        }, {\r\n            name: '一般复垦项目',\r\n            value: '一般复垦项目'\r\n        }, {\r\n            name: '采空区复垦',\r\n            value: '采空区复垦'\r\n        }, {\r\n            name: '矿业用地存量复垦',\r\n            value: '矿业用地存量复垦'\r\n        }],\r\n        checkTag: 'checkTag'\r\n    };\r\n\r\n    $scope.checkTag = function (tags) {\r\n        $scope.draftForm.xmjd = [];\r\n        for (var i = 0; i < tags.length; i++) {\r\n            $scope.draftForm.xmjd.push(tags[i].value);\r\n        }\r\n        queryData();\r\n    };\r\n\r\n    //表格控件数据\r\n    $scope.userData = {\r\n        config: {\r\n            operate: [{\r\n                name: '编辑',\r\n                icon: 'icon-edit',\r\n                click: 'goProcess'\r\n            }]\r\n        },\r\n        data: {\r\n            page: {},\r\n            head: {\r\n                'index': '序号',\r\n                'xmysubh': '预算编号',\r\n                'xmmc': '项目名称',\r\n                'xzqmc': '项目位置',\r\n                'zgm': '总规模',\r\n                'ztz': '总投资',\r\n                'xmjd': '项目阶段',\r\n                'xmlx': '项目类型'\r\n            }\r\n        },\r\n        headList: ['index', 'xmysubh', 'xmmc', 'xzqmc', 'zgm', 'ztz', 'xmjd', 'xmlx']\r\n    };\r\n\r\n    //查询\r\n    $scope.refer = function () {\r\n        queryData();\r\n    };\r\n\r\n    //清除\r\n    $scope.delet = function () {\r\n        $scope.draftForm = {\r\n            userId: userId\r\n        };\r\n        queryData();\r\n    };\r\n\r\n    //跳转回本页面\r\n    $scope.goPending = function () {\r\n        $scope.activeNaviFromPath('/draft', true);\r\n    };\r\n\r\n    // 节点\r\n    $scope.goProcess = function (item) {\r\n        $rootScope.processUrl = $agencyService.getHtmlPath() + '?did=' + item.id + '&box=draft&processid=' + encodeURIComponent(item.processKey);\r\n        $(\"[ng-controller='draftCtrl'] *\").hide();\r\n        $(\"[ng-controller='draftCtrl']\").append('<iframe frameborder=\"0\" height=\"100%\" width=\"100%\" name =\"draftCtrl\"></iframe>');\r\n        window['draftCtrl'].location.href = $rootScope.processUrl;\r\n    };\r\n}]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/office/controllers/draft-ctrl.js","import 'protocolService';\r\n\r\nangular.module('frameApp').controller('protocolCtrl', ['$scope', '$rootScope', '$protocolService', '$agencyService', '$log', function ($scope, $rootScope, $protocolService, $agencyService, $log) {\r\n    //起草箱\r\n    //top.GM.AppInfo.id = \"aa836f906aa545f6ba32a065a32c4e8a\";\r\n    //top.GM.AppInfo.name = \"自然资源统一确权登记\";\r\n\r\n    //用户权限\r\n    if (!top.GM.userInfo || top.GM.userInfo.permissions.length === 0) {\r\n        GM.Infomation.show('无法获取当前用户权限！', {\r\n            type: 'danger',\r\n            placement: 'center'\r\n        });\r\n\r\n        return;\r\n    }\r\n\r\n    $protocolService.queryDraft(top.GM.AppInfo.id, top.GM.userInfo.permissions.join(',')).then(function (response) {\r\n        $scope.draftData = response.data;\r\n    }, function (error) {\r\n        $log.error(error);\r\n    });\r\n\r\n    //起草按钮\r\n    $scope.draftProcess = function (processData) {\r\n        $protocolService.getUUID(null).then(function (res) {\r\n            if (res && res.success === true) {\r\n                goToDraft(processData, res.data);\r\n            } else {\r\n                goToDraft(processData, 'unknown');\r\n            }\r\n        }, function (res) {\r\n            goToDraft(processData, 'unknown');\r\n        });\r\n    };\r\n\r\n    //跳转到待办页面\r\n    $scope.goPending = function () {\r\n        $scope.activeNaviFromPath('/protocol', true);\r\n    };\r\n\r\n    var goToDraft = function (processData, uuid) {\r\n        var processKey = processData.processDefinitionId.split(':')[0];\r\n        $rootScope.processUrl = $agencyService.getHtmlPath() + '?startFlag=1&duuid=' + uuid + '&box=protocol&appId=' + top.GM.AppInfo.id + '&serviceAppKey=' + processData.serviceAppKey + '&processKey=' + processKey + '&processDefId=' + processData.id + '&processName=' + encodeURIComponent(processData.processName);\r\n        $(\"[ng-controller='protocolCtrl'] *\").hide();\r\n        $(\"[ng-controller='protocolCtrl']\").append('<iframe frameborder=\"0\" height=\"100%\" width=\"100%\" name =\"protocolCtrl\"></iframe>');\r\n        window['protocolCtrl'].location.href = $rootScope.processUrl;\r\n    };\r\n}]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/office/controllers/protocol-ctrl.js","angular.module('frameApp').factory('$agencyService', ['$gmRestful', function ($gmRestful) {\r\n    var result = {\r\n        queryExtraBizFields: function (appId) {\r\n            return new $gmRestful().get(ACTIVITI_SERVER + 'usertask/getExtraBizFields?appId=' + appId);\r\n        },\r\n        //查询拟件数据\r\n        queryStartData: function (params) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.get(RESTURL.process.start, params);\r\n            return pPromise;\r\n        },\r\n        //查询待办数据\r\n        queryPendingData: function (params) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.get(ACTIVITI_SERVER + 'usertask/list/handling', params);\r\n            return pPromise;\r\n        },\r\n        //查询项目查询\r\n        getQuery: function (params) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.get(RESTURL.process.query, params);\r\n            return pPromise;\r\n        },\r\n        //格式化时间\r\n        processDate: function (timeStamp) {\r\n            var date = new Date(timeStamp);\r\n            return [date.getFullYear(), date.getMonth() + 1, date.getDate()].join('-');\r\n        },\r\n        //查询经办数据\r\n        queryCompleteData: function (params) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.get(ACTIVITI_SERVER + 'usertask/list/handled', params);\r\n            return pPromise;\r\n        },\r\n        //查询草稿数据\r\n        queryDraftData: function (params) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.get(ACTIVITI_SERVER + 'userdraft/getDraftInfo', params);\r\n            return pPromise;\r\n        },\r\n        /**\r\n         * @description 获取页面路径\r\n         * @param processId\r\n         * @param nodeId\r\n         * @returns {*}\r\n         */\r\n        getHtmlPath: function () {\r\n            var strResult = null;\r\n            strResult = 'forms/index.html';\r\n            return strResult;\r\n        },\r\n        //流程分类管理\r\n        getProcessCatalogs: function (params, id) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.get(RESTURL.wf.getProcessCatalogs + (id ? ('?id=' + id) : ''), params);\r\n            return pPromise;\r\n        },\r\n        //编辑\r\n        edit: function (params) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.post(RESTURL.wf.editProcessCatalog, params);\r\n            return pPromise;\r\n        },\r\n        //删除\r\n        delete: function (params, id) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.get(RESTURL.wf.deleteProcessCatalog + '?id=' + id, params);\r\n            return pPromise;\r\n        }\r\n    };\r\n    return result;\r\n}]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/office/services/agency-services.js","angular.module('frameApp').factory('$draftService', ['$gmRestful', function ($gmRestful) {\r\n    var result = {\r\n        //查询草稿箱数据\r\n        queryPendingData: function (params) {\r\n            var pRestful = new $gmRestful();\r\n            var pPromise = pRestful.get(ACTIVITI_SERVER + 'userdraft/getDraftInfo', params);\r\n            return pPromise;\r\n        }\r\n    };\r\n    return result;\r\n}]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/office/services/draft-services.js","angular.module('frameApp').factory('$protocolService', ['$gmRestful', function ($gmRestful) {\r\n    var result = {\r\n        queryDraft: function (appId, roles) {\r\n            var pRestful = new $gmRestful();\r\n            return pRestful.get(ACTIVITI_SERVER + '/bizconfig/getProcessCatalogs?appId=' + appId + '&permissions=' + encodeURIComponent(roles));\r\n        },\r\n        getUUID: function () {\r\n            return new $gmRestful().get(ACTIVITI_SERVER + '/usertask/getUUID');\r\n        }\r\n    };\r\n\r\n    return result;\r\n}]);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/form/office/services/protocol-services.js"],"sourceRoot":""}